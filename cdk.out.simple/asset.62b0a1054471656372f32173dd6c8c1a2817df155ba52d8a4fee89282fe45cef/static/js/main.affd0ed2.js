/*! For license information please see main.affd0ed2.js.LICENSE.txt */
(()=>{"use strict";var e={9:(e,t,n)=>{n.d(t,{AU:()=>s,Ay:()=>p,O3:()=>u,ie:()=>l,loginSuccess:()=>o,ri:()=>c});var r=n(774);const a={isAuthenticated:!1,user:null,tokens:null,loading:!1,error:null},i=(0,r.Z0)({name:"auth",initialState:a,reducers:{loginStart:e=>{e.loading=!0,e.error=null},loginSuccess:(e,t)=>{try{const{user:n,tokens:r}=t.payload;if(!n||!n.userId||!n.email)throw new Error("Invalid user data in login success");if(!r||!r.accessToken||!r.refreshToken)throw new Error("Invalid token data in login success");e.isAuthenticated=!0,e.user=n,e.tokens=r,e.loading=!1,e.error=null}catch(n){e.isAuthenticated=!1,e.user=null,e.tokens=null,e.loading=!1,e.error=n instanceof Error?n.message:"Login validation failed"}},loginFailure:(e,t)=>{e.isAuthenticated=!1,e.user=null,e.tokens=null,e.loading=!1,e.error=t.payload||"Login failed"},logout:e=>{Object.assign(e,a)},refreshTokens:(e,t)=>{try{const n=t.payload;if(!n||!n.accessToken||!n.refreshToken)throw new Error("Invalid tokens for refresh");e.tokens=n,e.error=null}catch(n){Object.assign(e,a),e.error=n instanceof Error?n.message:"Token refresh failed"}},clearError:e=>{e.error=null},recoverState:(e,t)=>{try{const n=t.payload;n.user&&n.user.userId&&n.user.email&&(e.user=n.user),n.tokens&&n.tokens.accessToken&&(e.tokens=n.tokens,e.isAuthenticated=!0),e.loading=!1,e.error=null}catch(n){Object.assign(e,a),e.error="State recovery failed"}}}}),{loginStart:s,loginSuccess:o,loginFailure:l,logout:c,refreshTokens:u,clearError:d,recoverState:h}=i.actions,p=i.reducer},44:(e,t,n)=>{e.exports=n(940)},49:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function v(){}function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var b=x.prototype=new v;b.constructor=x,f(b,y.prototype),b.isPureReactComponent=!0;var E=Array.isArray,S=Object.prototype.hasOwnProperty,w={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,r){var a,i={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,a)&&!N.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===i[a]&&(i[a]=l[a]);return{$$typeof:n,type:e,key:s,ref:o,props:i,_owner:w.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===i?"."+A(l,0):i,E(s)?(a="",null!=e&&(a=e.replace(I,"$&/")+"/"),T(s,t,a,"",function(e){return e})):null!=s&&(C(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(I,"$&/")+"/")+e)),t.push(s)),1;if(l=0,i=""===i?".":i+":",E(e))for(var c=0;c<e.length;c++){var u=i+A(o=e[c],c);l+=T(o,t,a,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=T(o=o.value,t,a,u=i+A(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",function(e){return t.call(n,e,a++)}),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var _={current:null},P={transition:null},O={ReactCurrentDispatcher:_,ReactCurrentBatchConfig:P,ReactCurrentOwner:w};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:R,forEach:function(e,t,n){R(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return R(e,function(){t++}),t},toArray:function(e){return R(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=a,t.Profiler=s,t.PureComponent=x,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=f({},e.props),i=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=w.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!N.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:n,type:e.type,key:i,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return _.current.useCallback(e,t)},t.useContext=function(e){return _.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return _.current.useDeferredValue(e)},t.useEffect=function(e,t){return _.current.useEffect(e,t)},t.useId=function(){return _.current.useId()},t.useImperativeHandle=function(e,t,n){return _.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return _.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return _.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return _.current.useMemo(e,t)},t.useReducer=function(e,t,n){return _.current.useReducer(e,t,n)},t.useRef=function(e){return _.current.useRef(e)},t.useState=function(e){return _.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return _.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return _.current.useTransition()},t.version="18.3.1"},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(345)},138:(e,t)=>{var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,o=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,m=n?Symbol.for("react.suspense_list"):60120,f=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,x=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function E(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case i:case o:case s:case p:return e;default:switch(e=e&&e.$$typeof){case c:case h:case g:case f:case l:return e;default:return t}}case a:return t}}}function S(e){return E(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=h,t.Fragment=i,t.Lazy=g,t.Memo=f,t.Portal=a,t.Profiler=o,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||E(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return E(e)===c},t.isContextProvider=function(e){return E(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return E(e)===h},t.isFragment=function(e){return E(e)===i},t.isLazy=function(e){return E(e)===g},t.isMemo=function(e){return E(e)===f},t.isPortal=function(e){return E(e)===a},t.isProfiler=function(e){return E(e)===o},t.isStrictMode=function(e){return E(e)===s},t.isSuspense=function(e){return E(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===d||e===o||e===s||e===p||e===m||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===f||e.$$typeof===l||e.$$typeof===c||e.$$typeof===h||e.$$typeof===v||e.$$typeof===x||e.$$typeof===b||e.$$typeof===y)},t.typeOf=E},142:(e,t,n)=>{n.d(t,{CharacterService:()=>l});const r={strength:.3,vitality:.4,combatSkills:.2,craftingSkills:.1},a={intelligence:.3,vitality:.2,craftingSkills:.3,harvestingSkills:.2},i={strength:.25,dexterity:.35,combatSkills:.3,craftingSkills:.1};class s{static calculateSpecializationProgress(e){const t=e.strength*r.strength+e.vitality*r.vitality+e.combatSkills.level*r.combatSkills+e.craftingSkills.level*r.craftingSkills,n=e.intelligence*a.intelligence+e.vitality*a.vitality+e.craftingSkills.level*a.craftingSkills+e.harvestingSkills.level*a.harvestingSkills,s=e.strength*i.strength+e.dexterity*i.dexterity+e.combatSkills.level*i.combatSkills+e.craftingSkills.level*i.craftingSkills,o=e.strength+e.dexterity+e.intelligence+e.vitality,l=e.craftingSkills.level+e.harvestingSkills.level+e.combatSkills.level,c=Math.max(0,(o+l-6)/2),u=Math.floor(t*c),d=Math.floor(n*c),h=Math.floor(s*c);return{tankProgress:Math.max(0,u),healerProgress:Math.max(0,d),dpsProgress:Math.max(0,h)}}static determinePrimaryRole(e,t,n){const r=e+t+n;if(r<50)return null;return e/r>=.4?"tank":t/r>=.4?"healer":n/r>=.4?"dps":null}static calculateSpecializationBonuses(e,t,n,r){const a=[];if(e>=100&&a.push({type:"stat",name:"Fortification",value:Math.floor(e/50),description:`+${Math.floor(e/50)} Vitality from tank specialization`}),t>=100&&a.push({type:"stat",name:"Wisdom",value:Math.floor(t/50),description:`+${Math.floor(t/50)} Intelligence from healer specialization`}),n>=100&&a.push({type:"stat",name:"Precision",value:Math.floor(n/50),description:`+${Math.floor(n/50)} Dexterity from DPS specialization`}),r)switch(r){case"tank":a.push({type:"ability",name:"Steampunk Aegis",value:1,description:"Craft enhanced defensive gear with steam-powered protection"});break;case"healer":a.push({type:"ability",name:"Alchemical Restoration",value:1,description:"Brew powerful healing elixirs and steam-powered medical devices"});break;case"dps":a.push({type:"ability",name:"Clockwork Precision",value:1,description:"Craft precision weapons and explosive steam-powered devices"})}return a}static updateCharacterSpecialization(e){const t=this.calculateSpecializationProgress(e.stats),n=this.determinePrimaryRole(t.tankProgress,t.healerProgress,t.dpsProgress),r=this.calculateSpecializationBonuses(t.tankProgress,t.healerProgress,t.dpsProgress,n||void 0);return{tankProgress:t.tankProgress,healerProgress:t.healerProgress,dpsProgress:t.dpsProgress,primaryRole:n,secondaryRole:null,bonuses:r}}static getSpecializationDisplay(e){const t=e.tankProgress+e.healerProgress+e.dpsProgress,n={tank:"Steam Guardian",healer:"Gear Medic",dps:"Clockwork Striker"};return{totalProgress:t,percentages:{tank:t>0?Math.round(e.tankProgress/t*100):0,healer:t>0?Math.round(e.healerProgress/t*100):0,dps:t>0?Math.round(e.dpsProgress/t*100):0},roleNames:n,primaryRoleDisplay:e.primaryRole?n[e.primaryRole]:void 0}}static applySpecializationBonuses(e,t){const n={...e};return t.forEach(e=>{if("stat"===e.type)switch(e.name){case"Fortification":n.vitality+=e.value;break;case"Wisdom":n.intelligence+=e.value;break;case"Precision":n.dexterity+=e.value}}),n}static getNextMilestone(e){let t="tank",n=e.tankProgress;e.healerProgress>n&&(t="healer",n=e.healerProgress),e.dpsProgress>n&&(t="dps",n=e.dpsProgress);const r=[100,200,300,500,750,1e3].find(e=>e>n);return r?{role:t,currentProgress:n,nextMilestone:r,progressToNext:r-n}:null}}var o=n(609);class l{static calculateLevel(e){return Math.floor(Math.sqrt(e/100))+1}static calculateExperienceForLevel(e){return 100*Math.pow(e-1,2)}static calculateSkillLevel(e){return Math.floor(Math.sqrt(e/50))+1}static updateSkillSet(e,t,n){const r={...e};return r[t]+=n,r.experience+=n,r.level=this.calculateSkillLevel(r.experience),r}static calculateCharacterPower(e){return 10*(e.strength+e.dexterity+e.intelligence+e.vitality)+5*(e.craftingSkills.level+e.harvestingSkills.level+e.combatSkills.level)}static calculateStatBonuses(e,t){const n={strength:Math.floor(e/5),dexterity:Math.floor(e/5),intelligence:Math.floor(e/5),vitality:Math.floor(e/5)};if(t.primaryRole)switch(t.primaryRole){case"tank":n.strength=(n.strength||0)+Math.floor(e/3),n.vitality=(n.vitality||0)+Math.floor(e/3);break;case"healer":n.intelligence=(n.intelligence||0)+Math.floor(e/3),n.vitality=(n.vitality||0)+Math.floor(e/4);break;case"dps":n.strength=(n.strength||0)+Math.floor(e/4),n.dexterity=(n.dexterity||0)+Math.floor(e/3)}return n}static async validateCharacterName(e){try{return(await o._b.post("/character/validate-name",{name:e})).data}catch(t){if(t instanceof o.P)throw t;throw console.error("Error validating character name:",t),new Error(t.message||"Failed to validate character name")}}static async createCharacter(e){try{return(await o._b.post("/character",e)).data.character}catch(t){if(t instanceof o.P)throw t;if(409===t.statusCode)throw new Error("Character name is already taken. Please choose a different name.");throw new Error(t.message||"Failed to create character")}}static async getCharacter(e){try{return(await o._b.get(`/character?userId=${e}`)).data.character}catch(t){if(404===t.statusCode)return null;if(t instanceof o.P)throw t;throw console.error("Error getting character:",t),new Error(t.message||"Failed to get character")}}static async hasCharacter(e){try{return null!==await this.getCharacter(e)}catch(t){return console.error("Error checking character existence:",t),!1}}static async updateCharacter(e,t){try{return(await o._b.put(`/character/${e}`,t)).data.character}catch(n){if(n instanceof o.P)throw n;throw new Error(n.message||"Failed to update character")}}static async deleteCharacter(e){try{await o._b.delete(`/character/${e}`)}catch(t){if(t instanceof o.P)throw t;throw new Error(t.message||"Failed to delete character")}}static async addExperience(e,t){const n=await this.getCharacter(e);if(!n)throw new Error("Character not found");const r=n.experience+t,a=this.calculateLevel(r);let i={};if(a>n.level){const e=this.calculateStatBonuses(a,n.specialization);i={strength:n.stats.strength+(e.strength||0),dexterity:n.stats.dexterity+(e.dexterity||0),intelligence:n.stats.intelligence+(e.intelligence||0),vitality:n.stats.vitality+(e.vitality||0),craftingSkills:n.stats.craftingSkills,harvestingSkills:n.stats.harvestingSkills,combatSkills:n.stats.combatSkills}}const s={characterId:n.characterId,experience:r,level:a,...Object.keys(i).length>0&&{stats:i}};return this.updateCharacter(e,s)}static async addSkillExperience(e,t,n,r){const a=await this.getCharacter(e);if(!a)throw new Error("Character not found");let i,o;if("crafting"===t){const e=a.stats.craftingSkills;if(!(n in e)||"level"===n||"experience"===n)throw new Error(`Invalid skill name: ${n}`);i=this.updateSkillSet(e,n,r),o={...a.stats,craftingSkills:i}}else if("harvesting"===t){const e=a.stats.harvestingSkills;if(!(n in e)||"level"===n||"experience"===n)throw new Error(`Invalid skill name: ${n}`);i=this.updateSkillSet(e,n,r),o={...a.stats,harvestingSkills:i}}else{const e=a.stats.combatSkills;if(!(n in e)||"level"===n||"experience"===n)throw new Error(`Invalid skill name: ${n}`);i=this.updateSkillSet(e,n,r),o={...a.stats,combatSkills:i}}const l=s.updateCharacterSpecialization({...a,stats:o}),c={characterId:a.characterId,stats:o,specialization:l};return this.updateCharacter(e,c)}static async updateSpecialization(e){const t=await this.getCharacter(e);if(!t)throw new Error("Character not found");const n=s.updateCharacterSpecialization(t),r={characterId:t.characterId,specialization:n};return this.updateCharacter(e,r)}static getSpecializationDisplay(e){return s.getSpecializationDisplay(e.specialization)}static getNextSpecializationMilestone(e){return s.getNextMilestone(e.specialization)}static async addStatPoints(e,t){const n=await this.getCharacter(e);if(!n)throw new Error("Character not found");const r={...n.stats,strength:n.stats.strength+(t.strength||0),dexterity:n.stats.dexterity+(t.dexterity||0),intelligence:n.stats.intelligence+(t.intelligence||0),vitality:n.stats.vitality+(t.vitality||0)},a=s.updateCharacterSpecialization({...n,stats:r}),i={characterId:n.characterId,stats:r,specialization:a};return this.updateCharacter(e,i)}}},146:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TaskValidationService=void 0;const r=n(315);t.TaskValidationService=class{static validateTask(e,t,n,a){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=[],o=[];if(this.shouldBypassValidation(i))return this.logValidationBypass(e,i),{isValid:!0,errors:[],warnings:[{code:"VALIDATION_BYPASSED",message:`Validation bypassed: ${i.bypassReason||"Unknown reason"}`,suggestion:"This task was allowed to proceed despite potential validation issues"}]};switch(this.validateBasicTask(e,s),e.type){case r.TaskType.HARVESTING:this.validateHarvestingTask(e,t,n,s,o,i);break;case r.TaskType.CRAFTING:this.validateCraftingTask(e,t,n,a,s,o,i);break;case r.TaskType.COMBAT:this.validateCombatTask(e,t,n,s,o,i)}i.skipPrerequisiteCheck||this.validatePrerequisites(e.prerequisites,t,n,a,s),i.skipResourceCheck||this.validateResourceRequirements(e.resourceRequirements,a,s),i.skipEquipmentCheck||this.validateEquipmentRequirements(e,t,s,o);return{isValid:!!i.allowInvalidTasks||0===s.length,errors:s,warnings:o}}static validateBasicTask(e,t){e.id&&""!==e.id.trim()||t.push({code:"INVALID_TASK_ID",message:"Task ID is required and cannot be empty",field:"id",severity:"error"}),e.playerId&&""!==e.playerId.trim()||t.push({code:"INVALID_PLAYER_ID",message:"Player ID is required and cannot be empty",field:"playerId",severity:"error"}),e.duration<=0&&t.push({code:"INVALID_DURATION",message:"Task duration must be greater than 0",field:"duration",severity:"error"}),e.maxRetries<0&&t.push({code:"INVALID_MAX_RETRIES",message:"Max retries cannot be negative",field:"maxRetries",severity:"error"}),(e.priority<0||e.priority>10)&&t.push({code:"INVALID_PRIORITY",message:"Task priority must be between 0 and 10",field:"priority",severity:"error"})}static shouldBypassValidation(e){return!!(e.bypassValidation||e.adminOverride||e.testMode)}static logValidationBypass(e,t){const n=t.bypassReason||r.ValidationBypassReason.TESTING;console.log(`[VALIDATION BYPASS] Task ${e.id} validation bypassed. Reason: ${n}`),"undefined"!==typeof window&&window.gameAuditLog&&window.gameAuditLog.push({type:"validation_bypass",taskId:e.id,playerId:e.playerId,reason:n,timestamp:Date.now(),adminOverride:t.adminOverride,testMode:t.testMode})}static validateEquipmentRequirements(e,t,n,a){switch(e.type){case r.TaskType.HARVESTING:this.validateHarvestingEquipment(e,n,a);break;case r.TaskType.CRAFTING:this.validateCraftingEquipment(e,n,a);break;case r.TaskType.COMBAT:this.validateCombatEquipment(e,n,a)}}static validateHarvestingEquipment(e,t,n){const r=e.activityData;if(r.tools&&r.tools.length>0)for(const a of r.tools)a.durability<=0?t.push({code:"BROKEN_HARVESTING_TOOL",message:`Harvesting tool ${a.name} is broken and cannot be used`,field:"equipment.tools",severity:"error"}):a.durability<.1*a.maxDurability&&n.push({code:"LOW_TOOL_DURABILITY",message:`Tool ${a.name} has very low durability (${a.durability}/${a.maxDurability})`,suggestion:"Repair the tool before starting the task for better efficiency"}),"harvesting"!==a.type&&n.push({code:"INAPPROPRIATE_TOOL",message:`Tool ${a.name} is not designed for harvesting`,suggestion:"Use appropriate harvesting tools for better results"});else n.push({code:"NO_HARVESTING_TOOLS",message:"No harvesting tools equipped",suggestion:"Equip appropriate tools to improve harvesting efficiency"})}static validateCraftingEquipment(e,t,n){const r=e.activityData;if(r.craftingStation){const e=r.craftingStation;for(const n of e.requirements)n.isMet||t.push({code:"CRAFTING_STATION_UNAVAILABLE",message:`Crafting station requirement not met: ${n.description}`,field:"equipment.craftingStation",severity:"error"})}else{r.recipe.requiredLevel>5&&n.push({code:"NO_CRAFTING_STATION",message:"Advanced recipes work better with a crafting station",suggestion:"Use a crafting station to improve quality and reduce crafting time"})}}static validateCombatEquipment(e,t,n){const r=e.activityData;if(r.equipment&&r.equipment.length>0){let e=!1,a=!1;for(const i of r.equipment){i.durability<=0?t.push({code:"BROKEN_EQUIPMENT",message:`Equipment ${i.name} is broken and cannot be used in combat`,field:"equipment.combat",severity:"error"}):i.durability<.2*i.maxDurability&&n.push({code:"LOW_EQUIPMENT_DURABILITY",message:`Equipment ${i.name} has low durability (${i.durability}/${i.maxDurability})`,suggestion:"Repair equipment before combat to avoid breaking during battle"});for(const e of i.requirements)e.isMet||t.push({code:"EQUIPMENT_REQUIREMENT_NOT_MET",message:`Cannot use ${i.name}: ${e.description}`,field:"equipment.requirements",severity:"error"});"weapon"===i.type&&(e=!0),"armor"===i.type&&(a=!0)}e||n.push({code:"NO_WEAPON_EQUIPPED",message:"No weapon equipped for combat",suggestion:"Equip a weapon to improve combat effectiveness"}),a||n.push({code:"NO_ARMOR_EQUIPPED",message:"No armor equipped for combat",suggestion:"Equip armor to reduce damage taken in combat"})}else n.push({code:"NO_COMBAT_EQUIPMENT",message:"No combat equipment equipped",suggestion:"Equip weapons and armor before engaging in combat"})}static validateHarvestingTask(e,t,n,r,a){const i=e.activityData;if(!i.activity)return void r.push({code:"MISSING_HARVESTING_ACTIVITY",message:"Harvesting activity data is required",field:"activityData.activity",severity:"error"});const s=i.activity;if(n<s.requiredLevel&&r.push({code:"INSUFFICIENT_LEVEL",message:`Player level ${n} is below required level ${s.requiredLevel}`,field:"level",severity:"error"}),s.requiredStats)for(const[o,l]of Object.entries(s.requiredStats)){const e=this.getPlayerStat(t,o);e<l&&r.push({code:"INSUFFICIENT_STAT",message:`${o} ${e} is below required ${l}`,field:`stats.${o}`,severity:"error"})}if(s.energyCost>100&&a.push({code:"HIGH_ENERGY_COST",message:`This activity requires ${s.energyCost} energy`,suggestion:"Consider resting before starting this task"}),i.tools&&i.tools.length>0)for(const o of i.tools)o.durability<=0&&a.push({code:"BROKEN_TOOL",message:`Tool ${o.name} is broken and needs repair`,suggestion:"Repair or replace the tool for better efficiency"})}static validateCraftingTask(e,t,n,r,a,i){const s=e.activityData;if(!s.recipe)return void a.push({code:"MISSING_CRAFTING_RECIPE",message:"Crafting recipe data is required",field:"activityData.recipe",severity:"error"});const o=s.recipe;n<o.requiredLevel&&a.push({code:"INSUFFICIENT_LEVEL",message:`Player level ${n} is below required level ${o.requiredLevel}`,field:"level",severity:"error"});const l=this.getCraftingSkillLevel(t,o.requiredSkill);l<o.requiredLevel&&a.push({code:"INSUFFICIENT_SKILL",message:`${o.requiredSkill} skill level ${l} is below required ${o.requiredLevel}`,field:`craftingSkills.${o.requiredSkill}`,severity:"error"});for(const c of o.materials){const e=r[c.materialId]||0;e<c.quantity&&a.push({code:"INSUFFICIENT_MATERIALS",message:`Need ${c.quantity} ${c.name}, have ${e}`,field:"materials",severity:"error"})}if(s.craftingStation){const e=s.craftingStation;for(const i of e.requirements)this.checkPrerequisite(i,t,n,r)||a.push({code:"CRAFTING_STATION_REQUIREMENT",message:`Crafting station requires: ${i.description}`,field:"craftingStation",severity:"error"})}o.craftingTime>3600&&i.push({code:"LONG_CRAFTING_TIME",message:`This recipe takes ${Math.round(o.craftingTime/60)} minutes to complete`,suggestion:"Consider queuing shorter tasks first"})}static validateCombatTask(e,t,n,r,a){const i=e.activityData;if(!i.enemy)return void r.push({code:"MISSING_ENEMY_DATA",message:"Enemy data is required for combat tasks",field:"activityData.enemy",severity:"error"});const s=i.enemy,o=s.level-n;if(o>10?r.push({code:"ENEMY_TOO_STRONG",message:`Enemy level ${s.level} is much higher than player level ${n}`,field:"enemy.level",severity:"error"}):o>5&&a.push({code:"CHALLENGING_ENEMY",message:`Enemy level ${s.level} is significantly higher than player level ${n}`,suggestion:"Consider improving equipment or gaining more levels"}),i.equipment&&i.equipment.length>0)for(const l of i.equipment)l.durability<=0?r.push({code:"BROKEN_EQUIPMENT",message:`Equipment ${l.name} is broken`,field:"equipment",severity:"error"}):l.durability<.2*l.maxDurability&&a.push({code:"LOW_DURABILITY_EQUIPMENT",message:`Equipment ${l.name} has low durability`,suggestion:"Consider repairing equipment before combat"});if(i.estimatedOutcome){const e=i.estimatedOutcome;e.winProbability<.3&&a.push({code:"LOW_WIN_CHANCE",message:`Low chance of victory (${Math.round(100*e.winProbability)}%)`,suggestion:"Consider improving stats or equipment before attempting"}),"extreme"===e.riskLevel&&a.push({code:"EXTREME_RISK",message:"This combat has extreme risk level",suggestion:"Ensure you are well-prepared for potential failure"})}}static validatePrerequisites(e,t,n,r,a){for(const i of e)this.checkPrerequisite(i,t,n,r)||a.push({code:"PREREQUISITE_NOT_MET",message:`Prerequisite not met: ${i.description}`,field:"prerequisites",severity:"error"})}static validateResourceRequirements(e,t,n){for(const r of e){const e=t[r.resourceId]||0;e<r.quantityRequired&&n.push({code:"INSUFFICIENT_RESOURCES",message:`Need ${r.quantityRequired} ${r.resourceName}, have ${e}`,field:"resources",severity:"error"})}}static checkPrerequisite(e,t,n,r){switch(e.type){case"level":return n>=e.requirement;case"stat":return this.getPlayerStat(t,e.requirement)>=e.value;case"skill":return this.getSkillLevel(t,e.requirement)>=e.value;case"item":return(r[e.requirement]||0)>=e.value;case"equipment":case"activity":return!0;default:return!1}}static getPlayerStat(e,t){switch(t.toLowerCase()){case"strength":return e.strength;case"dexterity":return e.dexterity;case"intelligence":return e.intelligence;case"vitality":return e.vitality;default:return 0}}static getCraftingSkillLevel(e,t){switch(t){case"clockmaking":return e.craftingSkills.clockmaking;case"engineering":return e.craftingSkills.engineering;case"alchemy":return e.craftingSkills.alchemy;case"steamcraft":return e.craftingSkills.steamcraft;default:return 0}}static getSkillLevel(e,t){const n=this.getCraftingSkillLevel(e,t);if(n>0)return n;switch(t){case"mining":return e.harvestingSkills.mining;case"foraging":return e.harvestingSkills.foraging;case"salvaging":return e.harvestingSkills.salvaging;case"crystal_extraction":return e.harvestingSkills.crystal_extraction}switch(t){case"melee":return e.combatSkills.melee;case"ranged":return e.combatSkills.ranged;case"defense":return e.combatSkills.defense;case"tactics":return e.combatSkills.tactics}return 0}static validateResourceAvailability(e,t){const n=[],r=[];if((arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipResourceCheck)return{isValid:!0,errors:[],warnings:[]};for(const a of e){const e=t[a.resourceId]||0,i=a.quantityRequired;if(e<i){const t=i-e;n.push({code:"INSUFFICIENT_RESOURCES",message:`Need ${i} ${a.resourceName}, have ${e} (short by ${t})`,field:`resources.${a.resourceId}`,severity:"error"})}else e===i?r.push({code:"EXACT_RESOURCE_MATCH",message:`Using all available ${a.resourceName} (${e})`,suggestion:"Consider gathering more resources before starting this task"}):e<1.5*i&&r.push({code:"LOW_RESOURCE_BUFFER",message:`Low buffer for ${a.resourceName} (${e} available, ${i} needed)`,suggestion:"Consider gathering more resources to maintain a safety buffer"})}return{isValid:0===n.length,errors:n,warnings:r}}static validatePrerequisiteRequirements(e,t,n,r){const a=[],i=[];if((arguments.length>4&&void 0!==arguments[4]?arguments[4]:{}).skipPrerequisiteCheck)return{isValid:!0,errors:[],warnings:[]};for(const s of e){const e=this.checkPrerequisiteDetailed(s,t,n,r);e.isMet?e.warning&&i.push({code:"PREREQUISITE_WARNING",message:e.warning,suggestion:e.suggestion}):a.push({code:"PREREQUISITE_NOT_MET",message:e.message,field:`prerequisites.${s.type}`,severity:"error"})}return{isValid:0===a.length,errors:a,warnings:i}}static checkPrerequisiteDetailed(e,t,n,r){switch(e.type){case"level":const a=e.requirement,i=n>=a,s=a-n;return{isMet:i,message:i?`Level requirement met (${n}/${a})`:`Level too low: need ${a}, have ${n} (${s} levels short)`,warning:i&&n===a?`Minimum level requirement (${a})`:void 0,suggestion:i?void 0:`Gain ${s} more levels before attempting this task`};case"stat":const o=e.requirement,l=e.value,c=this.getPlayerStat(t,o),u=c>=l,d=l-c;return{isMet:u,message:u?`${o} requirement met (${c}/${l})`:`${o} too low: need ${l}, have ${c} (${d} points short)`,warning:u&&c===l?`Minimum ${o} requirement (${l})`:void 0,suggestion:u?void 0:`Increase ${o} by ${d} points through training or equipment`};case"skill":const h=e.requirement,p=e.value,m=this.getSkillLevel(t,h),f=m>=p,g=p-m;return{isMet:f,message:f?`${h} skill requirement met (${m}/${p})`:`${h} skill too low: need ${p}, have ${m} (${g} levels short)`,warning:f&&m===p?`Minimum ${h} skill requirement (${p})`:void 0,suggestion:f?void 0:`Practice ${h} to gain ${g} more levels`};case"item":const y=e.requirement,v=e.value,x=r[y]||0,b=x>=v,E=v-x;return{isMet:b,message:b?`Item requirement met: have ${x}/${v} ${y}`:`Missing items: need ${v} ${y}, have ${x} (${E} short)`,suggestion:b?void 0:`Obtain ${E} more ${y} before starting this task`};default:return{isMet:!0,message:`Unknown prerequisite type: ${e.type}`}}}static createAdminValidationOptions(){return{bypassValidation:!0,bypassReason:r.ValidationBypassReason.ADMIN_OVERRIDE,adminOverride:!0,skipResourceCheck:!0,skipPrerequisiteCheck:!0,skipEquipmentCheck:!0,allowInvalidTasks:!0}}static createTestValidationOptions(){return{bypassValidation:!0,bypassReason:r.ValidationBypassReason.TESTING,testMode:!0,allowInvalidTasks:!0}}static createDebugValidationOptions(){return{bypassValidation:!1,bypassReason:r.ValidationBypassReason.DEBUG,testMode:!0,allowInvalidTasks:!0,skipResourceCheck:!1,skipPrerequisiteCheck:!1,skipEquipmentCheck:!1}}static validateTaskWithAudit(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5?arguments[5]:void 0;const s=this.validateTask(e,t,n,r,a);if(i){const t={timestamp:Date.now(),taskId:e.id,playerId:e.playerId,userId:i.userId,sessionId:i.sessionId,validationResult:s.isValid,errorCount:s.errors.length,warningCount:s.warnings.length,bypassUsed:this.shouldBypassValidation(a),bypassReason:a.bypassReason,adminOverride:a.adminOverride,testMode:a.testMode,reason:i.reason};console.log("[TASK VALIDATION AUDIT]",t)}return s}static validateTaskComprehensive(e,t,n,a){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=[],o=[];try{if(this.shouldBypassValidation(i))return this.logValidationBypass(e,i),{isValid:!0,errors:[],warnings:[{code:"VALIDATION_BYPASSED",message:`Validation bypassed: ${i.bypassReason||"Unknown reason"}`,suggestion:"This task was allowed to proceed despite potential validation issues"}]};switch(this.validateBasicTaskComprehensive(e,s,o),e.type){case r.TaskType.HARVESTING:this.validateHarvestingTaskComprehensive(e,t,n,s,o,i);break;case r.TaskType.CRAFTING:this.validateCraftingTaskComprehensive(e,t,n,a,s,o,i);break;case r.TaskType.COMBAT:this.validateCombatTaskComprehensive(e,t,n,s,o,i);break;default:s.push({code:"UNKNOWN_TASK_TYPE",message:`Unknown task type: ${e.type}`,field:"type",severity:"error"})}i.skipPrerequisiteCheck||this.validatePrerequisitesComprehensive(e.prerequisites,t,n,a,s,o),i.skipResourceCheck||this.validateResourceRequirementsComprehensive(e.resourceRequirements,a,s,o),i.skipEquipmentCheck||this.validateEquipmentRequirementsComprehensive(e,t,s,o),this.validateTaskComplexity(e,s,o),this.performCrossValidation(e,t,n,a,s,o)}catch(l){s.push({code:"VALIDATION_ERROR",message:`Validation failed with error: ${l instanceof Error?l.message:"Unknown error"}`,severity:"error"})}return{isValid:!!i.allowInvalidTasks||0===s.length,errors:s,warnings:o}}static validateBasicTaskComprehensive(e,t,n){e.id&&""!==e.id.trim()?e.id.length>100&&n.push({code:"LONG_TASK_ID",message:`Task ID is unusually long (${e.id.length} characters)`,suggestion:"Consider using shorter, more manageable task IDs"}):t.push({code:"INVALID_TASK_ID",message:"Task ID is required and cannot be empty",field:"id",severity:"error"}),e.playerId&&""!==e.playerId.trim()||t.push({code:"INVALID_PLAYER_ID",message:"Player ID is required and cannot be empty",field:"playerId",severity:"error"}),e.duration<=0?t.push({code:"INVALID_DURATION",message:"Task duration must be greater than 0",field:"duration",severity:"error"}):e.duration>864e5?t.push({code:"EXCESSIVE_DURATION",message:`Task duration ${Math.round(e.duration/1e3/60)} minutes exceeds maximum allowed (24 hours)`,field:"duration",severity:"error"}):e.duration>144e5&&n.push({code:"LONG_DURATION",message:`Task duration ${Math.round(e.duration/1e3/60)} minutes is quite long`,suggestion:"Consider breaking long tasks into smaller segments"}),(e.priority<0||e.priority>10)&&t.push({code:"INVALID_PRIORITY",message:"Task priority must be between 0 and 10",field:"priority",severity:"error"}),e.maxRetries<0?t.push({code:"INVALID_MAX_RETRIES",message:"Max retries cannot be negative",field:"maxRetries",severity:"error"}):e.maxRetries>10&&n.push({code:"HIGH_MAX_RETRIES",message:`Max retries (${e.maxRetries}) is unusually high`,suggestion:"Consider investigating why tasks might need so many retries"}),(e.progress<0||e.progress>1)&&t.push({code:"INVALID_PROGRESS",message:`Task progress ${e.progress} must be between 0 and 1`,field:"progress",severity:"error"}),e.name&&""!==e.name.trim()||n.push({code:"MISSING_TASK_NAME",message:"Task name is empty",suggestion:"Provide a descriptive name for better user experience"}),e.description&&""!==e.description.trim()||n.push({code:"MISSING_TASK_DESCRIPTION",message:"Task description is empty",suggestion:"Provide a description to help players understand the task"})}static validateHarvestingTaskComprehensive(e,t,n,r,a){const i=e.activityData;if(!i||!i.activity)return void r.push({code:"MISSING_HARVESTING_DATA",message:"Harvesting activity data is required",field:"activityData.activity",severity:"error"});const s=i.activity;if(n<s.requiredLevel){const e=s.requiredLevel-n;r.push({code:"INSUFFICIENT_LEVEL",message:`Player level ${n} is ${e} levels below required level ${s.requiredLevel}`,field:"level",severity:"error"})}else n===s.requiredLevel&&a.push({code:"MINIMUM_LEVEL_REQUIREMENT",message:`Player is at minimum required level (${s.requiredLevel})`,suggestion:"Consider gaining more levels for better efficiency"});if(s.requiredStats)for(const[o,l]of Object.entries(s.requiredStats)){const e=this.getPlayerStat(t,o),n=l-e;e<l?r.push({code:"INSUFFICIENT_STAT",message:`${o} ${e} is ${n} points below required ${l}`,field:`stats.${o}`,severity:"error"}):e===l&&a.push({code:"MINIMUM_STAT_REQUIREMENT",message:`${o} is at minimum requirement (${l})`,suggestion:`Increase ${o} for better harvesting results`})}if(s.energyCost>0&&s.energyCost>100&&a.push({code:"HIGH_ENERGY_COST",message:`This activity requires ${s.energyCost} energy`,suggestion:"Ensure you have sufficient energy before starting"}),i.tools&&i.tools.length>0){let e=!1,t=!1;for(const n of i.tools)n.durability<=0?(e=!0,r.push({code:"BROKEN_HARVESTING_TOOL",message:`Tool ${n.name} is broken and cannot be used`,field:"equipment.tools",severity:"error"})):n.durability<.2*n.maxDurability&&(t=!0,a.push({code:"LOW_TOOL_DURABILITY",message:`Tool ${n.name} has low durability (${n.durability}/${n.maxDurability})`,suggestion:"Repair tools before starting for better efficiency"}));e&&a.push({code:"HARVESTING_EFFICIENCY_REDUCED",message:"Broken tools will reduce harvesting efficiency",suggestion:"Repair or replace broken tools"})}else a.push({code:"NO_HARVESTING_TOOLS",message:"No harvesting tools equipped",suggestion:"Equip appropriate tools to improve efficiency and yield"});if(i.location){const e=i.location;if(e.requirements&&e.requirements.length>0)for(const t of e.requirements)t.isMet||r.push({code:"LOCATION_REQUIREMENT_NOT_MET",message:`Cannot access location: ${t.description}`,field:"location.requirements",severity:"error"})}}static validateCraftingTaskComprehensive(e,t,n,r,a,i){const s=e.activityData;if(!s||!s.recipe)return void a.push({code:"MISSING_CRAFTING_DATA",message:"Crafting recipe data is required",field:"activityData.recipe",severity:"error"});const o=s.recipe;if(n<o.requiredLevel){const e=o.requiredLevel-n;a.push({code:"INSUFFICIENT_LEVEL",message:`Player level ${n} is ${e} levels below required level ${o.requiredLevel}`,field:"level",severity:"error"})}const l=this.getCraftingSkillLevel(t,o.requiredSkill);if(l<o.requiredLevel){const e=o.requiredLevel-l;a.push({code:"INSUFFICIENT_SKILL",message:`${o.requiredSkill} skill level ${l} is ${e} levels below required ${o.requiredLevel}`,field:`craftingSkills.${o.requiredSkill}`,severity:"error"})}else l===o.requiredLevel&&i.push({code:"MINIMUM_SKILL_REQUIREMENT",message:`${o.requiredSkill} skill is at minimum requirement (${o.requiredLevel})`,suggestion:"Higher skill levels improve crafting quality and success rate"});let c=0,u=0;for(const d of o.materials){const e=r[d.materialId]||0,t=d.quantity-e;e<d.quantity?(c+=t,u++,a.push({code:"INSUFFICIENT_MATERIALS",message:`Need ${d.quantity} ${d.name}, have ${e} (short by ${t})`,field:"materials",severity:"error"})):e===d.quantity&&i.push({code:"EXACT_MATERIAL_MATCH",message:`Using all available ${d.name} (${e})`,suggestion:"Consider gathering more materials to maintain a buffer"})}if(u>0&&i.push({code:"MULTIPLE_MATERIAL_SHORTAGES",message:`Missing ${u} different materials`,suggestion:"Gather all required materials before starting crafting"}),s.craftingStation){const e=s.craftingStation;for(const t of e.requirements)t.isMet||a.push({code:"CRAFTING_STATION_REQUIREMENT",message:`Crafting station requires: ${t.description}`,field:"craftingStation",severity:"error"})}else o.requiredLevel>5&&i.push({code:"NO_CRAFTING_STATION",message:"Advanced recipes benefit from crafting stations",suggestion:"Use a crafting station to improve quality and reduce time"});o.craftingTime>3600&&i.push({code:"LONG_CRAFTING_TIME",message:`This recipe takes ${Math.round(o.craftingTime/60)} minutes to complete`,suggestion:"Consider queuing shorter tasks first or using time-reduction bonuses"}),s.qualityModifier<1&&i.push({code:"REDUCED_QUALITY_EXPECTED",message:`Expected quality modifier: ${Math.round(100*s.qualityModifier)}%`,suggestion:"Improve crafting skill or use better equipment for higher quality"})}static validateCombatTaskComprehensive(e,t,n,r,a){const i=e.activityData;if(!i||!i.enemy)return void r.push({code:"MISSING_COMBAT_DATA",message:"Enemy data is required for combat tasks",field:"activityData.enemy",severity:"error"});const s=i.enemy,o=s.level-n;if(o>10?r.push({code:"ENEMY_TOO_STRONG",message:`Enemy level ${s.level} is ${o} levels higher than player level ${n}`,field:"enemy.level",severity:"error"}):o>5?a.push({code:"CHALLENGING_ENEMY",message:`Enemy level ${s.level} is ${o} levels higher than player level ${n}`,suggestion:"Consider improving equipment or gaining more levels before attempting"}):o<-10&&a.push({code:"ENEMY_TOO_WEAK",message:`Enemy level ${s.level} is much lower than player level ${n}`,suggestion:"This combat may provide minimal experience and rewards"}),i.equipment&&i.equipment.length>0){let e=!1,t=!1,n=0,s=0;for(const o of i.equipment){"weapon"===o.type&&(e=!0),"armor"===o.type&&(t=!0),o.durability<=0?(n++,r.push({code:"BROKEN_EQUIPMENT",message:`Equipment ${o.name} is broken and cannot be used in combat`,field:"equipment.combat",severity:"error"})):o.durability<.2*o.maxDurability&&(s++,a.push({code:"LOW_EQUIPMENT_DURABILITY",message:`Equipment ${o.name} has low durability (${o.durability}/${o.maxDurability})`,suggestion:"Repair equipment before combat to avoid breaking during battle"}));for(const e of o.requirements)e.isMet||r.push({code:"EQUIPMENT_REQUIREMENT_NOT_MET",message:`Cannot use ${o.name}: ${e.description}`,field:"equipment.requirements",severity:"error"})}e||a.push({code:"NO_WEAPON_EQUIPPED",message:"No weapon equipped for combat",suggestion:"Equip a weapon to improve combat effectiveness and damage output"}),t||a.push({code:"NO_ARMOR_EQUIPPED",message:"No armor equipped for combat",suggestion:"Equip armor to reduce damage taken and improve survivability"}),n>0&&a.push({code:"COMBAT_EFFECTIVENESS_REDUCED",message:`${n} pieces of equipment are broken`,suggestion:"Repair equipment before combat for optimal performance"})}else a.push({code:"NO_COMBAT_EQUIPMENT",message:"No combat equipment equipped",suggestion:"Equip weapons and armor before engaging in combat for better survival chances"});if(i.estimatedOutcome){const e=i.estimatedOutcome;e.winProbability<.1?r.push({code:"EXTREMELY_LOW_WIN_CHANCE",message:`Extremely low chance of victory (${Math.round(100*e.winProbability)}%)`,field:"combat.winProbability",severity:"error"}):e.winProbability<.3?a.push({code:"LOW_WIN_CHANCE",message:`Low chance of victory (${Math.round(100*e.winProbability)}%)`,suggestion:"Consider improving stats, equipment, or choosing a weaker enemy"}):e.winProbability>.95&&a.push({code:"GUARANTEED_VICTORY",message:`Very high chance of victory (${Math.round(100*e.winProbability)}%)`,suggestion:"Consider challenging stronger enemies for better rewards"}),"extreme"===e.riskLevel?a.push({code:"EXTREME_RISK",message:"This combat has extreme risk level",suggestion:"Ensure you are well-prepared and consider the consequences of failure"}):"high"===e.riskLevel&&a.push({code:"HIGH_RISK",message:"This combat has high risk level",suggestion:"Prepare carefully and consider backup plans"}),e.estimatedDuration>300&&a.push({code:"LONG_COMBAT_DURATION",message:`Estimated combat duration: ${Math.round(e.estimatedDuration/60)} minutes`,suggestion:"Long combats may be risky - ensure adequate preparation"})}i.playerStats&&i.playerStats.health<.5*i.playerStats.maxHealth&&a.push({code:"LOW_PLAYER_HEALTH",message:`Player health is at ${Math.round(i.playerStats.health/i.playerStats.maxHealth*100)}%`,suggestion:"Consider healing before engaging in combat"})}static validatePrerequisitesComprehensive(e,t,n,r,a,i){if(!e||0===e.length)return;let s=0,o=0;for(const l of e){const e=this.checkPrerequisiteDetailed(l,t,n,r);e.isMet?e.warning&&(o++,i.push({code:"PREREQUISITE_WARNING",message:e.warning,suggestion:e.suggestion})):(s++,a.push({code:"PREREQUISITE_NOT_MET",message:e.message,field:`prerequisites.${l.type}`,severity:"error"}))}s>1&&i.push({code:"MULTIPLE_UNMET_PREREQUISITES",message:`${s} prerequisites are not met`,suggestion:"Address all prerequisite requirements before attempting this task"}),o>0&&i.push({code:"MARGINAL_PREREQUISITES",message:`${o} prerequisites are at minimum requirements`,suggestion:"Consider improving stats/skills for better task performance"})}static validateResourceRequirementsComprehensive(e,t,n,r){if(!e||0===e.length)return;let a=0,i=0,s=0;for(const o of e){const e=t[o.resourceId]||0,l=o.quantityRequired;if(e<l){const t=l-e;a++,n.push({code:"INSUFFICIENT_RESOURCES",message:`Need ${l} ${o.resourceName}, have ${e} (short by ${t})`,field:`resources.${o.resourceId}`,severity:"error"})}else e===l?(i++,r.push({code:"EXACT_RESOURCE_MATCH",message:`Using all available ${o.resourceName} (${e})`,suggestion:"Consider gathering more resources to maintain a safety buffer"})):e<1.2*l&&r.push({code:"LOW_RESOURCE_BUFFER",message:`Low buffer for ${o.resourceName} (${e} available, ${l} needed)`,suggestion:"Gather additional resources to maintain a comfortable buffer"});s+=l}a>1&&r.push({code:"MULTIPLE_RESOURCE_SHORTAGES",message:`${a} different resources are insufficient`,suggestion:"Gather all required resources before starting the task"}),i>0&&r.push({code:"RESOURCES_AT_LIMIT",message:`${i} resources will be completely consumed`,suggestion:"Consider the impact on future tasks that may need these resources"})}static validateEquipmentRequirementsComprehensive(e,t,n,a){switch(e.type){case r.TaskType.HARVESTING:this.validateHarvestingEquipmentComprehensive(e,n,a);break;case r.TaskType.CRAFTING:this.validateCraftingEquipmentComprehensive(e,n,a);break;case r.TaskType.COMBAT:this.validateCombatEquipmentComprehensive(e,n,a)}}static validateHarvestingEquipmentComprehensive(e,t,n){const r=e.activityData;if(!r.tools||0===r.tools.length)return void n.push({code:"NO_HARVESTING_TOOLS",message:"No harvesting tools equipped",suggestion:"Equip appropriate tools to improve efficiency, yield, and speed"});let a=0,i=0,s=0;for(const o of r.tools)if(o.durability<=0?(a++,t.push({code:"BROKEN_HARVESTING_TOOL",message:`Tool ${o.name} is broken and cannot be used`,field:"equipment.tools",severity:"error"})):o.durability<.1*o.maxDurability?n.push({code:"CRITICAL_TOOL_DURABILITY",message:`Tool ${o.name} has critical durability (${o.durability}/${o.maxDurability})`,suggestion:"Repair immediately to avoid breaking during harvesting"}):o.durability<.3*o.maxDurability&&n.push({code:"LOW_TOOL_DURABILITY",message:`Tool ${o.name} has low durability (${o.durability}/${o.maxDurability})`,suggestion:"Consider repairing before starting long harvesting sessions"}),"harvesting"!==o.type&&(i++,n.push({code:"INAPPROPRIATE_TOOL",message:`Tool ${o.name} is not designed for harvesting`,suggestion:"Use specialized harvesting tools for optimal results"})),o.bonuses)for(const e of o.bonuses)"efficiency"!==e.type&&"speed"!==e.type||(s+=e.value);a>0&&n.push({code:"HARVESTING_EFFICIENCY_SEVERELY_REDUCED",message:`${a} broken tools will severely impact harvesting`,suggestion:"Repair all tools before starting for optimal performance"}),i>0&&n.push({code:"SUBOPTIMAL_TOOL_SELECTION",message:`${i} tools are not optimal for harvesting`,suggestion:"Use specialized harvesting tools for better results"}),s<0&&n.push({code:"NEGATIVE_EFFICIENCY_BONUS",message:"Current tools provide negative efficiency bonus",suggestion:"Consider upgrading or repairing tools"})}static validateCraftingEquipmentComprehensive(e,t,n){const r=e.activityData;if(r.craftingStation){const e=r.craftingStation;let a=0;for(const n of e.requirements)n.isMet||(a++,t.push({code:"CRAFTING_STATION_UNAVAILABLE",message:`Crafting station requirement not met: ${n.description}`,field:"equipment.craftingStation",severity:"error"}));if(a>1&&n.push({code:"MULTIPLE_STATION_REQUIREMENTS_UNMET",message:`${a} crafting station requirements are not met`,suggestion:"Address all station requirements before attempting to craft"}),e.bonuses&&e.bonuses.length>0){let t=0,r=0;for(const n of e.bonuses)"quality"===n.type&&(t+=n.value),"speed"===n.type&&(r+=n.value);(t>0||r>0)&&n.push({code:"CRAFTING_STATION_BENEFITS",message:`Station provides ${t>0?`+${t}% quality`:""} ${r>0?`+${r}% speed`:""}`,suggestion:"Crafting station will improve your results"})}}else{r.recipe.requiredLevel>3&&n.push({code:"NO_CRAFTING_STATION",message:"Advanced recipes benefit significantly from crafting stations",suggestion:"Consider using a crafting station to improve quality, speed, and material efficiency"})}}static validateCombatEquipmentComprehensive(e,t,n){const r=e.activityData;if(!r.equipment||0===r.equipment.length)return void n.push({code:"NO_COMBAT_EQUIPMENT",message:"No combat equipment equipped",suggestion:"Equip weapons and armor for significantly better combat performance and survival"});let a=!1,i=!1,s=!1,o=0,l=0,c=0,u=0,d=0;for(const h of r.equipment){"weapon"===h.type&&(a=!0,c+=h.stats.attack||0),"armor"===h.type&&(i=!0,u+=h.stats.defense||0),"accessory"===h.type&&(s=!0),h.durability<=0?(o++,t.push({code:"BROKEN_EQUIPMENT",message:`Equipment ${h.name} is broken and provides no benefits`,field:"equipment.combat",severity:"error"})):h.durability<.1*h.maxDurability?(l++,n.push({code:"CRITICAL_EQUIPMENT_DURABILITY",message:`Equipment ${h.name} has critical durability (${h.durability}/${h.maxDurability})`,suggestion:"Repair immediately to avoid breaking during combat"})):h.durability<.25*h.maxDurability&&n.push({code:"LOW_EQUIPMENT_DURABILITY",message:`Equipment ${h.name} has low durability (${h.durability}/${h.maxDurability})`,suggestion:"Repair before combat to ensure it lasts through the battle"});for(const e of h.requirements)e.isMet||(d++,t.push({code:"EQUIPMENT_REQUIREMENT_NOT_MET",message:`Cannot use ${h.name}: ${e.description}`,field:"equipment.requirements",severity:"error"}))}a||n.push({code:"NO_WEAPON_EQUIPPED",message:"No weapon equipped for combat",suggestion:"Equip a weapon to significantly improve damage output and combat effectiveness"}),i||n.push({code:"NO_ARMOR_EQUIPPED",message:"No armor equipped for combat",suggestion:"Equip armor to reduce incoming damage and improve survivability"}),s||n.push({code:"NO_ACCESSORIES_EQUIPPED",message:"No accessories equipped",suggestion:"Accessories can provide valuable stat bonuses and special effects"}),o>0&&n.push({code:"COMBAT_EFFECTIVENESS_SEVERELY_REDUCED",message:`${o} pieces of equipment are broken`,suggestion:"Repair all equipment before combat for maximum effectiveness"}),l>0&&n.push({code:"EQUIPMENT_LIKELY_TO_BREAK",message:`${l} pieces of equipment may break during combat`,suggestion:"Repair equipment to avoid losing bonuses mid-combat"}),d>0&&n.push({code:"EQUIPMENT_REQUIREMENTS_UNMET",message:`${d} equipment requirements are not met`,suggestion:"Meet equipment requirements to gain their full benefits"}),0===c&&a&&n.push({code:"LOW_ATTACK_BONUS",message:"Equipped weapons provide minimal attack bonus",suggestion:"Consider upgrading weapons for better combat performance"}),0===u&&i&&n.push({code:"LOW_DEFENSE_BONUS",message:"Equipped armor provides minimal defense bonus",suggestion:"Consider upgrading armor for better protection"})}static validateTaskComplexity(e,t,n){const a=(e.prerequisites&&e.prerequisites.length>0?1:0)+(e.resourceRequirements&&e.resourceRequirements.length>0?1:0)+(e.priority>7?1:0);e.duration<5e3&&a>2&&n.push({code:"COMPLEX_TASK_SHORT_DURATION",message:"Complex task has very short duration",suggestion:"Consider if task duration is appropriate for its complexity"}),e.duration>36e5&&0===a&&n.push({code:"SIMPLE_TASK_LONG_DURATION",message:"Simple task has very long duration",suggestion:"Consider breaking long simple tasks into smaller segments"}),e.maxRetries>0&&e.type===r.TaskType.COMBAT&&n.push({code:"COMBAT_TASK_WITH_RETRIES",message:"Combat tasks with automatic retries may be risky",suggestion:"Consider manual retry for combat to assess situation between attempts"}),e.priority>8&&e.duration>18e5&&n.push({code:"HIGH_PRIORITY_LONG_TASK",message:"High priority task has long duration",suggestion:"Consider if this task should block other activities for so long"})}static performCrossValidation(e,t,n,a,i,s){const o=e.prerequisites.filter(e=>"level"===e.type),l=e.prerequisites.filter(e=>"item"===e.type);o.length>0&&0===e.resourceRequirements.length&&e.type!==r.TaskType.COMBAT&&s.push({code:"LEVEL_REQUIREMENT_WITHOUT_RESOURCES",message:"Task has level requirements but no resource requirements",suggestion:"Verify if this task should consume resources"});for(const r of l){e.resourceRequirements.find(e=>e.resourceId===r.requirement)||s.push({code:"ITEM_PREREQUISITE_NOT_CONSUMED",message:`Item prerequisite ${r.requirement} is not consumed by task`,suggestion:"Verify if prerequisite items should be consumed or just required"})}const c={[r.TaskType.HARVESTING]:{min:1e4,max:3e5},[r.TaskType.CRAFTING]:{min:3e4,max:18e5},[r.TaskType.COMBAT]:{min:5e3,max:6e5}}[e.type];c&&(e.duration<c.min?s.push({code:"UNUSUALLY_SHORT_DURATION",message:`${e.type} task duration (${Math.round(e.duration/1e3)}s) is unusually short`,suggestion:"Verify if duration is appropriate for this task type"}):e.duration>c.max&&s.push({code:"UNUSUALLY_LONG_DURATION",message:`${e.type} task duration (${Math.round(e.duration/1e3/60)}m) is unusually long`,suggestion:"Consider breaking long tasks into smaller segments"}));const u=e.prerequisites.length+e.resourceRequirements.length;n<5&&u>3&&s.push({code:"COMPLEX_TASK_FOR_LOW_LEVEL",message:"Complex task for low-level player",suggestion:"Consider if this task is appropriate for player level"}),n>50&&0===u&&s.push({code:"SIMPLE_TASK_FOR_HIGH_LEVEL",message:"Very simple task for high-level player",suggestion:"Consider if this task provides appropriate challenge and rewards"})}static validateTaskQueue(e,t,n){const r=[],a=[];e.length>t&&r.push({code:"QUEUE_SIZE_EXCEEDED",message:`Queue size ${e.length} exceeds maximum ${t}`,severity:"error"});const i=e.reduce((e,t)=>e+t.duration,0);i>n&&a.push({code:"LONG_QUEUE_DURATION",message:`Total queue duration ${Math.round(i/1e3/60)} minutes exceeds recommended maximum`,suggestion:"Consider breaking up long task sequences"});const s=new Set;for(const o of e)s.has(o.id)&&r.push({code:"DUPLICATE_TASK_ID",message:`Duplicate task ID found: ${o.id}`,severity:"error"}),s.add(o.id);return{isValid:0===r.length,errors:r,warnings:a}}static validateTaskBatch(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i={};t.strength,t.dexterity,t.intelligence,t.vitality,t.craftingSkills.clockmaking,t.craftingSkills.engineering,t.craftingSkills.alchemy,t.craftingSkills.steamcraft,t.harvestingSkills.mining,t.harvestingSkills.foraging,t.harvestingSkills.salvaging,t.harvestingSkills.crystal_extraction;for(const o of e)try{i[o.id]=this.validateTaskComprehensive(o,t,n,r,a)}catch(s){i[o.id]={isValid:!1,errors:[{code:"VALIDATION_EXCEPTION",message:`Validation failed: ${s instanceof Error?s.message:"Unknown error"}`,severity:"error"}],warnings:[]}}return i}static validateTaskWithContext(e,t,n,a,i){const s={...arguments.length>5&&void 0!==arguments[5]?arguments[5]:{}};"creative"===i.gameMode&&(s.bypassValidation=!0,s.bypassReason=r.ValidationBypassReason.DEBUG),"easy"===i.difficulty&&(s.skipResourceCheck=!0);const o=this.validateTaskComprehensive(e,t,n,a,s);return i.playerName&&(o.errors=o.errors.map(e=>({...e,message:`[${i.playerName}] ${e.message}`})),o.warnings=o.warnings.map(e=>({...e,message:`[${i.playerName}] ${e.message}`}))),o}static createValidationSummary(e){const t=Object.keys(e),n=t.length;let r=0,a=0,i=0,s=0;const o={},l=[];for(const c of t){const t=e[c];t.isValid?r++:a++,i+=t.errors.length,s+=t.warnings.length;for(const e of t.errors)o[e.code]=(o[e.code]||0)+1;for(const e of t.warnings)o[e.code]=(o[e.code]||0)+1}return o.INSUFFICIENT_LEVEL>0&&l.push("Consider gaining more levels before attempting these tasks"),o.INSUFFICIENT_MATERIALS>0&&l.push("Gather required materials before starting crafting tasks"),o.BROKEN_EQUIPMENT>0&&l.push("Repair broken equipment before starting tasks"),o.NO_COMBAT_EQUIPMENT>0&&l.push("Equip weapons and armor before engaging in combat"),a>r&&l.push("Address validation issues before proceeding with task queue"),{totalTasks:n,validTasks:r,invalidTasks:a,totalErrors:i,totalWarnings:s,commonIssues:o,recommendations:l}}static createEmergencyBypassOptions(e){return{bypassValidation:!0,bypassReason:r.ValidationBypassReason.EMERGENCY,adminOverride:!0,skipResourceCheck:!0,skipPrerequisiteCheck:!0,skipEquipmentCheck:!0,allowInvalidTasks:!0}}static createMaintenanceBypassOptions(){return{bypassValidation:!0,bypassReason:r.ValidationBypassReason.MAINTENANCE,adminOverride:!0,skipResourceCheck:!0,skipPrerequisiteCheck:!0,skipEquipmentCheck:!0,allowInvalidTasks:!0}}static validateTaskProgressive(e,t,n,r){const a={};switch(arguments.length>4&&void 0!==arguments[4]?arguments[4]:"normal"){case"lenient":a.skipResourceCheck=!1,a.skipPrerequisiteCheck=!1,a.skipEquipmentCheck=!0,a.allowInvalidTasks=!1;break;case"normal":break;case"strict":a.skipResourceCheck=!1,a.skipPrerequisiteCheck=!1,a.skipEquipmentCheck=!1,a.allowInvalidTasks=!1}return this.validateTaskComprehensive(e,t,n,r,a)}static validateTaskWithPerformanceMonitoring(e,t,n,r){var a,i;let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const o=performance.now(),l=null===(a=performance.memory)||void 0===a?void 0:a.usedJSHeapSize,c=this.validateTaskComprehensive(e,t,n,r,s),u=performance.now(),d=null===(i=performance.memory)||void 0===i?void 0:i.usedJSHeapSize;return{...c,performanceMetrics:{duration:u-o,memoryUsed:l&&d?d-l:void 0}}}static exportValidationConfig(){return{supportedTaskTypes:[r.TaskType.HARVESTING,r.TaskType.CRAFTING,r.TaskType.COMBAT],validationRules:{maxTaskDuration:864e5,maxQueueSize:50,maxRetries:10,priorityRange:[0,10],progressRange:[0,1]},bypassReasons:Object.values(r.ValidationBypassReason),errorCodes:["INVALID_TASK_ID","INVALID_PLAYER_ID","INVALID_DURATION","EXCESSIVE_DURATION","INVALID_PRIORITY","INVALID_MAX_RETRIES","INVALID_PROGRESS","MISSING_HARVESTING_DATA","MISSING_CRAFTING_DATA","MISSING_COMBAT_DATA","INSUFFICIENT_LEVEL","INSUFFICIENT_STAT","INSUFFICIENT_SKILL","INSUFFICIENT_MATERIALS","INSUFFICIENT_RESOURCES","BROKEN_HARVESTING_TOOL","BROKEN_EQUIPMENT","BROKEN_CRAFTING_STATION","ENEMY_TOO_STRONG","EXTREMELY_LOW_WIN_CHANCE","PREREQUISITE_NOT_MET","EQUIPMENT_REQUIREMENT_NOT_MET","QUEUE_SIZE_EXCEEDED","DUPLICATE_TASK_ID","VALIDATION_ERROR","VALIDATION_EXCEPTION"],warningCodes:["LONG_TASK_ID","HIGH_MAX_RETRIES","MISSING_TASK_NAME","MISSING_TASK_DESCRIPTION","MINIMUM_LEVEL_REQUIREMENT","MINIMUM_STAT_REQUIREMENT","MINIMUM_SKILL_REQUIREMENT","HIGH_ENERGY_COST","LOW_TOOL_DURABILITY","NO_HARVESTING_TOOLS","CHALLENGING_ENEMY","ENEMY_TOO_WEAK","LOW_WIN_CHANCE","HIGH_RISK","EXTREME_RISK","NO_WEAPON_EQUIPPED","NO_ARMOR_EQUIPPED","NO_COMBAT_EQUIPMENT","LONG_CRAFTING_TIME","NO_CRAFTING_STATION","REDUCED_QUALITY_EXPECTED","EXACT_RESOURCE_MATCH","LOW_RESOURCE_BUFFER","EXACT_MATERIAL_MATCH","PREREQUISITE_WARNING","VALIDATION_BYPASSED","LONG_QUEUE_DURATION","COMPLEX_TASK_SHORT_DURATION","SIMPLE_TASK_LONG_DURATION"]}}}},280:(e,t)=>{t._P=void 0;class n{static async fetchJson(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n={method:"GET",headers:{"Content-Type":"application/json",...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}}};return this.makeRequest(e,n,t)}static async postJson(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={method:"POST",headers:{"Content-Type":"application/json",...n.headers},body:JSON.stringify(t)};return this.makeRequest(e,r,n)}static async putJson(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={method:"PUT",headers:{"Content-Type":"application/json",...n.headers},body:JSON.stringify(t)};return this.makeRequest(e,r,n)}static async deleteJson(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={method:"DELETE",headers:{"Content-Type":"application/json",...t.headers}};return this.makeRequest(e,n,t)}static async delete(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.makeRequest(e,t,n)}static async makeRequest(e,t,n){const{timeout:a=this.DEFAULT_TIMEOUT,retries:i=this.DEFAULT_RETRIES,exponentialBackoff:s=!0}=n;let o;for(let u=0;u<=i;u++)try{const n=new AbortController,i=setTimeout(()=>n.abort(),a),s=await fetch(e,{...t,signal:n.signal});if(clearTimeout(i),!s.ok)throw new r(`HTTP ${s.status}: ${s.statusText}`,s.status,s.statusText,e);try{return await s.json()}catch(l){return await s.text()}}catch(c){o=c;const t=!navigator.onLine;if("AbortError"===c.name)throw new r(`Request timeout after ${a}ms`,408,"Request Timeout",e,{isTimeout:!0,isOffline:t});if("TypeError"===c.name&&c.message.includes("fetch"))throw new r(t?"You appear to be offline":"Network request failed",0,"Network Error",e,{isOffline:t});if(c instanceof r&&c.status>=400&&c.status<500)throw c;if(u===i)throw c;const n=s?this.BASE_DELAY*Math.pow(2,u):this.BASE_DELAY;console.warn(`NetworkUtils: Request failed (attempt ${u+1}/${i+1}), retrying in ${n}ms:`,c.message),await this.sleep(n)}throw o}static sleep(e){return new Promise(t=>setTimeout(t,e))}static async isReachable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;try{const n=new AbortController,r=setTimeout(()=>n.abort(),t),a=await fetch(e,{method:"HEAD",signal:n.signal});return clearTimeout(r),a.ok}catch{return!1}}static getNetworkStatus(){var e,t,n;const r=window.navigator;return{online:r.onLine,effectiveType:null===(e=r.connection)||void 0===e?void 0:e.effectiveType,downlink:null===(t=r.connection)||void 0===t?void 0:t.downlink,rtt:null===(n=r.connection)||void 0===n?void 0:n.rtt}}static isOnline(){return"undefined"===typeof navigator||navigator.onLine}static waitForOnline(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4;return new Promise((t,n)=>{if(this.isOnline())return void t();const r=setTimeout(()=>{window.removeEventListener("online",a),n(new Error("Timeout waiting for online connection"))},e),a=()=>{clearTimeout(r),window.removeEventListener("online",a),t()};window.addEventListener("online",a)})}static onNetworkStatusChange(e){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t),window.addEventListener("offline",n),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}static calculateRetryDelay(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]))return t;const n=t*Math.pow(2,e-1),r=.1*Math.random()*n;return Math.min(3e4,n+r)}static withAuth(e){var t=this;const n={Authorization:`Bearer ${e}`};return{fetchJson:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.fetchJson(e,n,r)},postJson:function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.postJson(e,r,{...a,headers:{...n,...a.headers}})},putJson:function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.putJson(e,r,{...a,headers:{...n,...a.headers}})},deleteJson:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.deleteJson(e,{...r,headers:{...n,...r.headers}})}}}static createNetworkError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new r(e,t.status||0,t.statusText||"Network Error",t.url||"",{isTimeout:t.isTimeout||!1,isOffline:t.isOffline||!1})}static async fetchWithRetry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.fetchJson(e,t,n)}}t._P=n,n.DEFAULT_TIMEOUT=1e4,n.DEFAULT_RETRIES=3,n.BASE_DELAY=1e3;class r extends Error{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};super(e),this.status=t,this.statusText=n,this.url=r,this.isNetworkError=!0,this.isTimeout=!1,this.isOffline=!1,this.name="NetworkError",this.isTimeout=a.isTimeout||!1,this.isOffline=a.isOffline||!1}get statusCode(){return this.status}}},315:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TaskEventType=t.ValidationBypassReason=t.TaskType=void 0,function(e){e.HARVESTING="harvesting",e.COMBAT="combat",e.CRAFTING="crafting"}(t.TaskType||(t.TaskType={})),function(e){e.ADMIN_OVERRIDE="admin_override",e.TESTING="testing",e.DEBUG="debug",e.EMERGENCY="emergency",e.MAINTENANCE="maintenance"}(t.ValidationBypassReason||(t.ValidationBypassReason={})),function(e){e.TASK_ADDED="task_added",e.TASK_STARTED="task_started",e.TASK_PROGRESS="task_progress",e.TASK_COMPLETED="task_completed",e.TASK_FAILED="task_failed",e.TASK_CANCELLED="task_cancelled",e.QUEUE_PAUSED="queue_paused",e.QUEUE_RESUMED="queue_resumed",e.QUEUE_CLEARED="queue_cleared"}(t.TaskEventType||(t.TaskEventType={}))},340:(e,t,n)=>{e.exports=n(761)},345:(e,t,n)=>{var r=n(950),a=n(340);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,r,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function x(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(m,e)||!d.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),S=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),I=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var L,U=Object.assign;function D(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var q=!1;function F(e,t){if(!e||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?D(e):""}function $(e){switch(e.tag){case 5:return D(e.type);case 16:return D("Lazy");case 13:return D("Suspense");case 19:return D("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case w:return"Fragment";case S:return"Portal";case k:return"Profiler";case N:return"StrictMode";case T:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function X(e,t){J(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function ie(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ye=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function Ee(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,we=null,Ne=null;function ke(e){if(e=xa(e)){if("function"!==typeof Se)throw Error(i(280));var t=e.stateNode;t&&(t=Ea(t),Se(e.stateNode,e.type,t))}}function Ce(e){we?Ne?Ne.push(e):Ne=[e]:we=e}function Ie(){if(we){var e=we,t=Ne;if(Ne=we=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ae(e,t){return e(t)}function Te(){}var Re=!1;function je(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ae(e,t,n)}finally{Re=!1,(null!==we||null!==Ne)&&(Te(),Ie())}}function _e(e,t){var n=e.stateNode;if(null===n)return null;var r=Ea(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Pe=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Pe=!1}function Me(e,t,n,r,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,Ue=null,De=!1,qe=null,Fe={onError:function(e){Le=!0,Ue=e}};function $e(e,t,n,r,a,i,s,o,l){Le=!1,Ue=null,Me.apply(Fe,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Be(e)!==e)throw Error(i(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return Ve(a),e;if(s===r)return Ve(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,r=s;break}if(l===r){o=!0,r=a,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=a;break}if(l===r){o=!0,r=s,n=a;break}l=l.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var We=a.unstable_scheduleCallback,Qe=a.unstable_cancelCallback,Ke=a.unstable_shouldYield,Ye=a.unstable_requestPaint,Je=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?r=dt(o):0!==(i&=s)&&(r=dt(i))}else 0!==(s=n&~a)?r=dt(s):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var xt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Et,St,wt,Nt,kt,Ct=!1,It=[],At=null,Tt=null,Rt=null,jt=new Map,_t=new Map,Pt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":jt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_t.delete(t.pointerId)}}function Lt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=xa(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ut(e){var t=va(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void kt(e.priority,function(){wt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Dt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xa(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function qt(e,t,n){Dt(e)&&n.delete(t)}function Ft(){Ct=!1,null!==At&&Dt(At)&&(At=null),null!==Tt&&Dt(Tt)&&(Tt=null),null!==Rt&&Dt(Rt)&&(Rt=null),jt.forEach(qt),_t.forEach(qt)}function $t(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ft)))}function Bt(e){function t(t){return $t(t,e)}if(0<It.length){$t(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==At&&$t(At,e),null!==Tt&&$t(Tt,e),null!==Rt&&$t(Rt,e),jt.forEach(t),_t.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Ut(n),null===n.blockedOn&&Pt.shift()}var zt=b.ReactCurrentBatchConfig,Vt=!0;function Ht(e,t,n,r){var a=xt,i=zt.transition;zt.transition=null;try{xt=1,Wt(e,t,n,r)}finally{xt=a,zt.transition=i}}function Gt(e,t,n,r){var a=xt,i=zt.transition;zt.transition=null;try{xt=4,Wt(e,t,n,r)}finally{xt=a,zt.transition=i}}function Wt(e,t,n,r){if(Vt){var a=Kt(e,t,n,r);if(null===a)Vr(e,t,r,Qt,n),Mt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return At=Lt(At,e,t,n,r,a),!0;case"dragenter":return Tt=Lt(Tt,e,t,n,r,a),!0;case"mouseover":return Rt=Lt(Rt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return jt.set(i,Lt(jt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,_t.set(i,Lt(_t.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==a;){var i=xa(a);if(null!==i&&Et(i),null===(i=Kt(e,t,n,r))&&Vr(e,t,r,Qt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Qt=null;function Kt(e,t,n,r){if(Qt=null,null!==(e=va(e=Ee(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,a="value"in Jt?Jt.value:Jt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),dn=U({},cn,{view:0,detail:0}),hn=an(dn),pn=U({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=an(pn),fn=an(U({},pn,{dataTransfer:0})),gn=an(U({},dn,{relatedTarget:0})),yn=an(U({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=U({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=an(vn),bn=an(U({},cn,{data:0})),En={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function kn(){return Nn}var Cn=U({},dn,{key:function(e){if(e.key){var t=En[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=an(Cn),An=an(U({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=an(U({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Rn=an(U({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=U({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),_n=an(jn),Pn=[9,13,27,32],On=u&&"CompositionEvent"in window,Mn=null;u&&"documentMode"in document&&(Mn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Mn,Un=u&&(!On||Mn&&8<Mn&&11>=Mn),Dn=String.fromCharCode(32),qn=!1;function Fn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $n(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ce(r),0<(t=Gr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Wn=null;function Qn(e){Dr(e,0)}function Kn(e){if(W(ba(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Wn=Gn=null)}function nr(e){if("value"===e.propertyName&&Kn(Wn)){var t=[];Hn(t,Wn,e,Ee(e)),je(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Wn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Wn)}function ir(e,t){if("click"===e)return Kn(t)}function sr(e,t){if("input"===e||"change"===e)return Kn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!or(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=ur(n,i);var s=ur(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,xr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xr||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Gr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function Er(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:Er("Animation","AnimationEnd"),animationiteration:Er("Animation","AnimationIteration"),animationstart:Er("Animation","AnimationStart"),transitionend:Er("Transition","TransitionEnd")},wr={},Nr={};function kr(e){if(wr[e])return wr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Nr)return wr[e]=n[t];return e}u&&(Nr=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Cr=kr("animationend"),Ir=kr("animationiteration"),Ar=kr("animationstart"),Tr=kr("transitionend"),Rr=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _r(e,t){Rr.set(e,t),l(t,[e])}for(var Pr=0;Pr<jr.length;Pr++){var Or=jr[Pr];_r(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}_r(Cr,"onAnimationEnd"),_r(Ir,"onAnimationIteration"),_r(Ar,"onAnimationStart"),_r("dblclick","onDoubleClick"),_r("focusin","onFocus"),_r("focusout","onBlur"),_r(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,o,l,c){if($e.apply(this,arguments),Le){if(!Le)throw Error(i(198));var u=Ue;Le=!1,Ue=null,De||(De=!0,qe=u)}}(r,t,void 0,e),e.currentTarget=null}function Dr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Ur(a,o,c),i=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Ur(a,o,c),i=l}}}if(De)throw e=qe,De=!1,qe=null,e}function qr(e,t){var n=t[fa];void 0===n&&(n=t[fa]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function Fr(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var $r="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[$r]){e[$r]=!0,s.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||Fr(t,!1,e),Fr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[$r]||(t[$r]=!0,Fr("selectionchange",!1,t))}}function zr(e,t,n,r){switch(Yt(t)){case 1:var a=Ht;break;case 4:a=Gt;break;default:a=Wt}n=a.bind(null,t,n,e),a=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=va(o)))return;if(5===(l=s.tag)||6===l){r=i=s;continue e}o=o.parentNode}}r=r.return}je(function(){var r=i,a=Ee(n),s=[];e:{var o=Rr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Cr:case Ir:case Ar:l=yn;break;case Tr:l=Rn;break;case"scroll":l=hn;break;case"wheel":l=_n;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var p,m=r;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=_e(m,h))&&u.push(Hr(m,f,p)))),d)break;m=m.return}0<u.length&&(o=new l(o,c,null,n,a),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!va(c)&&!c[ma])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?va(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,f="onPointerLeave",h="onPointerEnter",m="pointer"),d=null==l?o:ba(l),p=null==c?o:ba(c),(o=new u(f,m+"leave",l,n,a)).target=d,o.relatedTarget=p,f=null,va(a)===r&&((u=new u(h,m+"enter",c,n,a)).target=p,u.relatedTarget=d,f=u),d=f,l&&c)e:{for(h=c,m=0,p=u=l;p;p=Wr(p))m++;for(p=0,f=h;f;f=Wr(f))p++;for(;0<m-p;)u=Wr(u),m--;for(;0<p-m;)h=Wr(h),p--;for(;m--;){if(u===h||null!==h&&u===h.alternate)break e;u=Wr(u),h=Wr(h)}u=null}else u=null;null!==l&&Qr(s,o,l,u,!1),null!==c&&null!==d&&Qr(s,d,c,u,!0)}if("select"===(l=(o=r?ba(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Yn;else if(Vn(o))if(Jn)g=sr;else{g=ar;var y=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ir);switch(g&&(g=g(e,r))?Hn(s,g,n,a):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?ba(r):window,e){case"focusin":(Vn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":xr=!0;break;case"contextmenu":case"mouseup":case"dragend":xr=!1,br(s,n,a);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":br(s,n,a)}var v;if(On)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Bn?Fn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Un&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==x?"onCompositionEnd"===x&&Bn&&(v=en()):(Xt="value"in(Jt=a)?Jt.value:Jt.textContent,Bn=!0)),0<(y=Gr(r,x)).length&&(x=new bn(x,e,null,n,a),s.push({event:x,listeners:y}),v?x.data=v:null!==(v=$n(n))&&(x.data=v))),(v=Ln?function(e,t){switch(e){case"compositionend":return $n(t);case"keypress":return 32!==t.which?null:(qn=!0,Dn);case"textInput":return(e=t.data)===Dn&&qn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!On&&Fn(e,t)?(e=en(),Zt=Xt=Jt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(a=new bn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=v))}Dr(s,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=_e(e,n))&&r.unshift(Hr(e,i,a)),null!=(i=_e(e,t))&&r.push(Hr(e,i,a))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=_e(n,i))&&s.unshift(Hr(n,l,o)):a||null!=(l=_e(n,i))&&s.push(Hr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Kr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Kr,"\n").replace(Yr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(oa)}:ra;function oa(e){setTimeout(function(){throw e})}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Bt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),ha="__reactFiber$"+da,pa="__reactProps$"+da,ma="__reactContainer$"+da,fa="__reactEvents$"+da,ga="__reactListeners$"+da,ya="__reactHandles$"+da;function va(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ma]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[ha])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function xa(e){return!(e=e[ha]||e[ma])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ba(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function Ea(e){return e[pa]||null}var Sa=[],wa=-1;function Na(e){return{current:e}}function ka(e){0>wa||(e.current=Sa[wa],Sa[wa]=null,wa--)}function Ca(e,t){wa++,Sa[wa]=e.current,e.current=t}var Ia={},Aa=Na(Ia),Ta=Na(!1),Ra=Ia;function ja(e,t){var n=e.type.contextTypes;if(!n)return Ia;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function _a(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pa(){ka(Ta),ka(Aa)}function Oa(e,t,n){if(Aa.current!==Ia)throw Error(i(168));Ca(Aa,t),Ca(Ta,n)}function Ma(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,z(e)||"Unknown",a));return U({},n,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ia,Ra=Aa.current,Ca(Aa,e),Ca(Ta,Ta.current),!0}function Ua(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ma(e,t,Ra),r.__reactInternalMemoizedMergedChildContext=e,ka(Ta),ka(Aa),Ca(Aa,e)):ka(Ta),Ca(Ta,n)}var Da=null,qa=!1,Fa=!1;function $a(e){null===Da?Da=[e]:Da.push(e)}function Ba(){if(!Fa&&null!==Da){Fa=!0;var e=0,t=xt;try{var n=Da;for(xt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Da=null,qa=!1}catch(a){throw null!==Da&&(Da=Da.slice(e+1)),We(Ze,Ba),a}finally{xt=t,Fa=!1}}return null}var za=[],Va=0,Ha=null,Ga=0,Wa=[],Qa=0,Ka=null,Ya=1,Ja="";function Xa(e,t){za[Va++]=Ga,za[Va++]=Ha,Ha=e,Ga=t}function Za(e,t,n){Wa[Qa++]=Ya,Wa[Qa++]=Ja,Wa[Qa++]=Ka,Ka=e;var r=Ya;e=Ja;var a=32-st(r)-1;r&=~(1<<a),n+=1;var i=32-st(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Ya=1<<32-st(t)+a|n<<a|r,Ja=i+e}else Ya=1<<i|n<<a|r,Ja=e}function ei(e){null!==e.return&&(Xa(e,1),Za(e,1,0))}function ti(e){for(;e===Ha;)Ha=za[--Va],za[Va]=null,Ga=za[--Va],za[Va]=null;for(;e===Ka;)Ka=Wa[--Qa],Wa[Qa]=null,Ja=Wa[--Qa],Wa[Qa]=null,Ya=Wa[--Qa],Wa[Qa]=null}var ni=null,ri=null,ai=!1,ii=null;function si(e,t){var n=jc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ka?{id:Ya,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=jc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!oi(e,t)){if(li(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&oi(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!ai)return ui(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(li(e))throw hi(),Error(i(418));for(;t;)si(e,t),t=ca(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=ca(e.nextSibling)}function pi(){ri=ni=null,ai=!1}function mi(e){null===ii?ii=[e]:ii.push(e)}var fi=b.ReactCurrentBatchConfig;function gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function yi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vi(e){return(0,e._init)(e._payload)}function xi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Uc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===w?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===_&&vi(i)===t.type)?((r=a(t,n.props)).ref=gi(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=gi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Dc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case E:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=gi(e,null,t),n.return=e,n;case S:return(t=Dc(t,e.mode,n)).return=e,t;case _:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Mc(t,e.mode,n,null)).return=e,t;yi(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case E:return n.key===a?c(e,t,n,r):null;case S:return n.key===a?u(e,t,n,r):null;case _:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||M(n))return null!==a?null:d(e,t,n,r,null);yi(e,n)}return null}function m(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case E:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case S:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case _:return m(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||M(r))return d(t,e=e.get(n)||null,r,a,null);yi(t,r)}return null}function f(a,i,o,l){for(var c=null,u=null,d=i,f=i=0,g=null;null!==d&&f<o.length;f++){d.index>f?(g=d,d=null):g=d.sibling;var y=p(a,d,o[f],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(a,d),i=s(y,i,f),null===u?c=y:u.sibling=y,u=y,d=g}if(f===o.length)return n(a,d),ai&&Xa(a,f),c;if(null===d){for(;f<o.length;f++)null!==(d=h(a,o[f],l))&&(i=s(d,i,f),null===u?c=d:u.sibling=d,u=d);return ai&&Xa(a,f),c}for(d=r(a,d);f<o.length;f++)null!==(g=m(d,a,f,o[f],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?f:g.key),i=s(g,i,f),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(a,e)}),ai&&Xa(a,f),c}function g(a,o,l,c){var u=M(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,f=o,g=o=0,y=null,v=l.next();null!==f&&!v.done;g++,v=l.next()){f.index>g?(y=f,f=null):y=f.sibling;var x=p(a,f,v.value,c);if(null===x){null===f&&(f=y);break}e&&f&&null===x.alternate&&t(a,f),o=s(x,o,g),null===d?u=x:d.sibling=x,d=x,f=y}if(v.done)return n(a,f),ai&&Xa(a,g),u;if(null===f){for(;!v.done;g++,v=l.next())null!==(v=h(a,v.value,c))&&(o=s(v,o,g),null===d?u=v:d.sibling=v,d=v);return ai&&Xa(a,g),u}for(f=r(a,f);!v.done;g++,v=l.next())null!==(v=m(f,a,g,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?g:v.key),o=s(v,o,g),null===d?u=v:d.sibling=v,d=v);return e&&f.forEach(function(e){return t(a,e)}),ai&&Xa(a,g),u}return function e(r,i,s,l){if("object"===typeof s&&null!==s&&s.type===w&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case E:e:{for(var c=s.key,u=i;null!==u;){if(u.key===c){if((c=s.type)===w){if(7===u.tag){n(r,u.sibling),(i=a(u,s.props.children)).return=r,r=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===_&&vi(c)===u.type){n(r,u.sibling),(i=a(u,s.props)).ref=gi(r,u,s),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===w?((i=Mc(s.props.children,r.mode,l,s.key)).return=r,r=i):((l=Oc(s.type,s.key,s.props,null,r.mode,l)).ref=gi(r,i,s),l.return=r,r=l)}return o(r);case S:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=a(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Dc(s,r.mode,l)).return=r,r=i}return o(r);case _:return e(r,i,(u=s._init)(s._payload),l)}if(te(s))return f(r,i,s,l);if(M(s))return g(r,i,s,l);yi(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,s)).return=r,r=i):(n(r,i),(i=Uc(s,r.mode,l)).return=r,r=i),o(r)):n(r,i)}}var bi=xi(!0),Ei=xi(!1),Si=Na(null),wi=null,Ni=null,ki=null;function Ci(){ki=Ni=wi=null}function Ii(e){var t=Si.current;ka(Si),e._currentValue=t}function Ai(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ti(e,t){wi=e,ki=Ni=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xo=!0),e.firstContext=null)}function Ri(e){var t=e._currentValue;if(ki!==e)if(e={context:e,memoizedValue:t,next:null},null===Ni){if(null===wi)throw Error(i(308));Ni=e,wi.dependencies={lanes:0,firstContext:e}}else Ni=Ni.next=e;return t}var ji=null;function _i(e){null===ji?ji=[e]:ji.push(e)}function Pi(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,_i(t)):(n.next=a.next,a.next=n),t.interleaved=n,Oi(e,r)}function Oi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Mi=!1;function Li(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ui(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Al)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Oi(e,n)}return null===(a=r.interleaved)?(t.next=t,_i(r)):(t.next=a.next,a.next=t),r.interleaved=t,Oi(e,n)}function Fi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function $i(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bi(e,t,n,r){var a=e.updateQueue;Mi=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=a.baseState;for(s=0,u=c=l=null,o=i;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){d=m.call(p,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,d,h):m)||void 0===h)break e;d=U({},d,h);break e;case 2:Mi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,s|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Ll|=s,e.lanes=s,e.memoizedState=d}}function zi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Vi={},Hi=Na(Vi),Gi=Na(Vi),Wi=Na(Vi);function Qi(e){if(e===Vi)throw Error(i(174));return e}function Ki(e,t){switch(Ca(Wi,t),Ca(Gi,e),Ca(Hi,Vi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ka(Hi),Ca(Hi,t)}function Yi(){ka(Hi),ka(Gi),ka(Wi)}function Ji(e){Qi(Wi.current);var t=Qi(Hi.current),n=le(t,e.type);t!==n&&(Ca(Gi,e),Ca(Hi,n))}function Xi(e){Gi.current===e&&(ka(Hi),ka(Gi))}var Zi=Na(0);function es(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ts=[];function ns(){for(var e=0;e<ts.length;e++)ts[e]._workInProgressVersionPrimary=null;ts.length=0}var rs=b.ReactCurrentDispatcher,as=b.ReactCurrentBatchConfig,is=0,ss=null,os=null,ls=null,cs=!1,us=!1,ds=0,hs=0;function ps(){throw Error(i(321))}function ms(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function fs(e,t,n,r,a,s){if(is=s,ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Xs:Zs,e=n(r,a),us){s=0;do{if(us=!1,ds=0,25<=s)throw Error(i(301));s+=1,ls=os=null,t.updateQueue=null,rs.current=eo,e=n(r,a)}while(us)}if(rs.current=Js,t=null!==os&&null!==os.next,is=0,ls=os=ss=null,cs=!1,t)throw Error(i(300));return e}function gs(){var e=0!==ds;return ds=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ls?ss.memoizedState=ls=e:ls=ls.next=e,ls}function vs(){if(null===os){var e=ss.alternate;e=null!==e?e.memoizedState:null}else e=os.next;var t=null===ls?ss.memoizedState:ls.next;if(null!==t)ls=t,os=e;else{if(null===e)throw Error(i(310));e={memoizedState:(os=e).memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},null===ls?ss.memoizedState=ls=e:ls=ls.next=e}return ls}function xs(e,t){return"function"===typeof t?t(e):t}function bs(e){var t=vs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=os,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((is&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,ss.lanes|=d,Ll|=d}u=u.next}while(null!==u&&u!==s);null===c?o=r:c.next=l,or(r,t.memoizedState)||(xo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,ss.lanes|=s,Ll|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Es(e){var t=vs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);or(s,t.memoizedState)||(xo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ss(){}function ws(e,t){var n=ss,r=vs(),a=t(),s=!or(r.memoizedState,a);if(s&&(r.memoizedState=a,xo=!0),r=r.queue,Ms(Cs.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==ls&&1&ls.memoizedState.tag){if(n.flags|=2048,Rs(9,ks.bind(null,n,r,a,t),void 0,null),null===Tl)throw Error(i(349));0!==(30&is)||Ns(n,t,a)}return a}function Ns(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ks(e,t,n,r){t.value=n,t.getSnapshot=r,Is(t)&&As(e)}function Cs(e,t,n){return n(function(){Is(t)&&As(e)})}function Is(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function As(e){var t=Oi(e,1);null!==t&&nc(t,e,1,-1)}function Ts(e){var t=ys();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:e},t.queue=e,e=e.dispatch=Ws.bind(null,ss,e),[t.memoizedState,e]}function Rs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function js(){return vs().memoizedState}function _s(e,t,n,r){var a=ys();ss.flags|=e,a.memoizedState=Rs(1|t,n,void 0,void 0===r?null:r)}function Ps(e,t,n,r){var a=vs();r=void 0===r?null:r;var i=void 0;if(null!==os){var s=os.memoizedState;if(i=s.destroy,null!==r&&ms(r,s.deps))return void(a.memoizedState=Rs(t,n,i,r))}ss.flags|=e,a.memoizedState=Rs(1|t,n,i,r)}function Os(e,t){return _s(8390656,8,e,t)}function Ms(e,t){return Ps(2048,8,e,t)}function Ls(e,t){return Ps(4,2,e,t)}function Us(e,t){return Ps(4,4,e,t)}function Ds(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ps(4,4,Ds.bind(null,t,e),n)}function Fs(){}function $s(e,t){var n=vs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Bs(e,t){var n=vs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function zs(e,t,n){return 0===(21&is)?(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=n):(or(n,t)||(n=ft(),ss.lanes|=n,Ll|=n,e.baseState=!0),t)}function Vs(e,t){var n=xt;xt=0!==n&&4>n?n:4,e(!0);var r=as.transition;as.transition={};try{e(!1),t()}finally{xt=n,as.transition=r}}function Hs(){return vs().memoizedState}function Gs(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Ks(t,n);else if(null!==(n=Pi(e,t,n,r))){nc(n,e,r,ec()),Ys(n,t,r)}}function Ws(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Ks(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,or(o,s)){var l=t.interleaved;return null===l?(a.next=a,_i(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Pi(e,t,a,r))&&(nc(n,e,r,a=ec()),Ys(n,t,r))}}function Qs(e){var t=e.alternate;return e===ss||null!==t&&t===ss}function Ks(e,t){us=cs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ys(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Js={readContext:Ri,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},Xs={readContext:Ri,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Ri,useEffect:Os,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,_s(4194308,4,Ds.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _s(4194308,4,e,t)},useInsertionEffect:function(e,t){return _s(4,2,e,t)},useMemo:function(e,t){var n=ys();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ys();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Gs.bind(null,ss,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:Ts,useDebugValue:Fs,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=Ts(!1),t=e[0];return e=Vs.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ss,a=ys();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Tl)throw Error(i(349));0!==(30&is)||Ns(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Os(Cs.bind(null,r,s,e),[e]),r.flags|=2048,Rs(9,ks.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ys(),t=Tl.identifierPrefix;if(ai){var n=Ja;t=":"+t+"R"+(n=(Ya&~(1<<32-st(Ya)-1)).toString(32)+n),0<(n=ds++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zs={readContext:Ri,useCallback:$s,useContext:Ri,useEffect:Ms,useImperativeHandle:qs,useInsertionEffect:Ls,useLayoutEffect:Us,useMemo:Bs,useReducer:bs,useRef:js,useState:function(){return bs(xs)},useDebugValue:Fs,useDeferredValue:function(e){return zs(vs(),os.memoizedState,e)},useTransition:function(){return[bs(xs)[0],vs().memoizedState]},useMutableSource:Ss,useSyncExternalStore:ws,useId:Hs,unstable_isNewReconciler:!1},eo={readContext:Ri,useCallback:$s,useContext:Ri,useEffect:Ms,useImperativeHandle:qs,useInsertionEffect:Ls,useLayoutEffect:Us,useMemo:Bs,useReducer:Es,useRef:js,useState:function(){return Es(xs)},useDebugValue:Fs,useDeferredValue:function(e){var t=vs();return null===os?t.memoizedState=e:zs(t,os.memoizedState,e)},useTransition:function(){return[Es(xs)[0],vs().memoizedState]},useMutableSource:Ss,useSyncExternalStore:ws,useId:Hs,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Di(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=qi(e,i,a))&&(nc(t,e,a,r),Fi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Di(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=qi(e,i,a))&&(nc(t,e,a,r),Fi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Di(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=qi(e,a,r))&&(nc(t,e,r,n),Fi(t,e,r))}};function ao(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,i))}function io(e,t,n){var r=!1,a=Ia,i=t.contextType;return"object"===typeof i&&null!==i?i=Ri(i):(a=_a(t)?Ra:Aa.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?ja(e,a):Ia),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function so(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Li(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ri(i):(i=_a(t)?Ra:Aa.current,a.context=ja(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(no(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ro.enqueueReplaceState(a,a.state,null),Bi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=$(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Di(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vl||(Vl=!0,Hl=r),uo(0,t)},n}function mo(e,t,n){(n=Di(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){uo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Di(-1,1)).tag=2,qi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var vo=b.ReactCurrentOwner,xo=!1;function bo(e,t,n,r){t.child=null===e?Ei(t,null,n,r):bi(t,e.child,n,r)}function Eo(e,t,n,r,a){n=n.render;var i=t.ref;return Ti(t,a),r=fs(e,t,n,r,i,a),n=gs(),null===e||xo?(ai&&n&&ei(t),t.flags|=1,bo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vo(e,t,a))}function So(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||_c(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,wo(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Vo(e,t,a)}return t.flags|=1,(e=Pc(i,r)).ref=t.ref,e.return=t,t.child=e}function wo(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(xo=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Vo(e,t,a);0!==(131072&e.flags)&&(xo=!0)}}return Co(e,t,n,r,a)}function No(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ca(Pl,_l),_l|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ca(Pl,_l),_l|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ca(Pl,_l),_l|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ca(Pl,_l),_l|=r;return bo(e,t,a,n),t.child}function ko(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,n,r,a){var i=_a(n)?Ra:Aa.current;return i=ja(t,i),Ti(t,a),n=fs(e,t,n,r,i,a),r=gs(),null===e||xo?(ai&&r&&ei(t),t.flags|=1,bo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vo(e,t,a))}function Io(e,t,n,r,a){if(_a(n)){var i=!0;La(t)}else i=!1;if(Ti(t,a),null===t.stateNode)zo(e,t),io(t,n,r),oo(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ri(c):c=ja(t,c=_a(n)?Ra:Aa.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||l!==c)&&so(t,s,r,c),Mi=!1;var h=t.memoizedState;s.state=h,Bi(t,r,s,a),l=t.memoizedState,o!==r||h!==l||Ta.current||Mi?("function"===typeof u&&(no(t,n,u,r),l=t.memoizedState),(o=Mi||ao(t,n,o,r,h,l,c))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Ui(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),s.props=c,d=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ri(l):l=ja(t,l=_a(n)?Ra:Aa.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||h!==l)&&so(t,s,r,l),Mi=!1,h=t.memoizedState,s.state=h,Bi(t,r,s,a);var m=t.memoizedState;o!==d||h!==m||Ta.current||Mi?("function"===typeof p&&(no(t,n,p,r),m=t.memoizedState),(c=Mi||ao(t,n,c,r,h,m,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,m,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),s.props=r,s.state=m,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ao(e,t,n,r,i,a)}function Ao(e,t,n,r,a,i){ko(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&Ua(t,n,!1),Vo(e,t,i);r=t.stateNode,vo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=bi(t,e.child,null,i),t.child=bi(t,null,o,i)):bo(e,t,o,i),t.memoizedState=r.state,a&&Ua(t,n,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Oa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oa(0,t.context,!1),Ki(e,t.containerInfo)}function Ro(e,t,n,r,a){return pi(),mi(a),t.flags|=256,bo(e,t,n,r),t.child}var jo,_o,Po,Oo,Mo={dehydrated:null,treeContext:null,retryLane:0};function Lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Uo(e,t,n){var r,a=t.pendingProps,s=Zi.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ca(Zi,1&s),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Lc(l,a,0,null),e=Mc(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Lo(n),t.memoizedState=Mo,e):Do(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,o){if(n)return 256&t.flags?(t.flags&=-257,qo(e,t,o,r=co(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=Lc({mode:"visible",children:r.children},a,0,null),(s=Mc(s,a,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&bi(t,e.child,null,o),t.child.memoizedState=Lo(o),t.memoizedState=Mo,s);if(0===(1&t.mode))return qo(e,t,o,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,qo(e,t,o,r=co(s=Error(i(419)),r,void 0))}if(l=0!==(o&e.childLanes),xo||l){if(null!==(r=Tl)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Oi(e,a),nc(r,e,a,-1))}return fc(),qo(e,t,o,r=co(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Wa[Qa++]=Ya,Wa[Qa++]=Ja,Wa[Qa++]=Ka,Ya=e.id,Ja=e.overflow,Ka=t),t=Do(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,s,n);if(o){o=a.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Pc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Pc(r,o):(o=Mc(o,l,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,l=null===(l=e.child.memoizedState)?Lo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Mo,a}return e=(o=e.child).sibling,a=Pc(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Do(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function qo(e,t,n,r){return null!==r&&mi(r),bi(t,e.child,null,n),(e=Do(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ai(e.return,t,n)}function $o(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Bo(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(bo(e,t,r.children,n),0!==(2&(r=Zi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fo(e,n,t);else if(19===e.tag)Fo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ca(Zi,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===es(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),$o(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===es(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}$o(t,!0,n,null,i);break;case"together":$o(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ho(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Go(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Wo(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(t),null;case 1:case 17:return _a(t.type)&&Pa(),Go(t),null;case 3:return r=t.stateNode,Yi(),ka(Ta),ka(Aa),ns(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sc(ii),ii=null))),_o(e,t),Go(t),null;case 5:Xi(t);var a=Qi(Wi.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Go(t),null}if(e=Qi(Hi.current),di(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ha]=t,r[pa]=s,e=0!==(1&t.mode),n){case"dialog":qr("cancel",r),qr("close",r);break;case"iframe":case"object":case"embed":qr("load",r);break;case"video":case"audio":for(a=0;a<Mr.length;a++)qr(Mr[a],r);break;case"source":qr("error",r);break;case"img":case"image":case"link":qr("error",r),qr("load",r);break;case"details":qr("toggle",r);break;case"input":Y(r,s),qr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},qr("invalid",r);break;case"textarea":ae(r,s),qr("invalid",r)}for(var l in ve(n,s),a=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&qr("scroll",r)}switch(n){case"input":G(r),Z(r,s,!0);break;case"textarea":G(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=r,jo(e,t,!1,!1),t.stateNode=e;e:{switch(l=xe(n,r),n){case"dialog":qr("cancel",e),qr("close",e),a=r;break;case"iframe":case"object":case"embed":qr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Mr.length;a++)qr(Mr[a],e);a=r;break;case"source":qr("error",e),a=r;break;case"img":case"image":case"link":qr("error",e),qr("load",e),a=r;break;case"details":qr("toggle",e),a=r;break;case"input":Y(e,r),a=K(e,r),qr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=U({},r,{value:void 0}),qr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),qr("invalid",e)}for(s in ve(n,a),c=a)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&qr("scroll",e):null!=u&&x(e,s,u,l))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Go(t),null;case 6:if(e&&null!=t.stateNode)Oo(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Qi(Wi.current),Qi(Hi.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(s=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return Go(t),null;case 13:if(ka(Zi),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),pi(),t.flags|=98560,s=!1;else if(s=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[ha]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Go(t),s=!1}else null!==ii&&(sc(ii),ii=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Ol&&(Ol=3):fc())),null!==t.updateQueue&&(t.flags|=4),Go(t),null);case 4:return Yi(),_o(e,t),null===e&&Br(t.stateNode.containerInfo),Go(t),null;case 10:return Ii(t.type._context),Go(t),null;case 19:if(ka(Zi),null===(s=t.memoizedState))return Go(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)Ho(s,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=es(e))){for(t.flags|=128,Ho(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ca(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>Bl&&(t.flags|=128,r=!0,Ho(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=es(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ho(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ai)return Go(t),null}else 2*Je()-s.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,Ho(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=Zi.current,Ca(Zi,r?1&n|2:1&n),t):(Go(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&_l)&&(Go(t),6&t.subtreeFlags&&(t.flags|=8192)):Go(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Qo(e,t){switch(ti(t),t.tag){case 1:return _a(t.type)&&Pa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yi(),ka(Ta),ka(Aa),ns(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xi(t),null;case 13:if(ka(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ka(Zi),null;case 4:return Yi(),null;case 10:return Ii(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}jo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},_o=function(){},Po=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Qi(Hi.current);var i,s=null;switch(n){case"input":a=K(e,a),r=K(e,r),s=[];break;case"select":a=U({},a,{value:void 0}),r=U({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&qr("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ko=!1,Yo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Xo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Nc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Nc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&el(t,n,i)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[fa],delete t[ga],delete t[ya])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:Yo||Zo(n,t);case 6:var r=ul,a=dl;ul=null,hl(e,t,n),dl=a,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Bt(e)):la(ul,n.stateNode));break;case 4:r=ul,a=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=a;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&el(n,t,s),a=a.next}while(a!==r)}hl(e,t,n);break;case 1:if(!Yo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Nc(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Yo=(r=Yo)||null!==n.memoizedState,hl(e,t,n),Yo=r):hl(e,t,n);break;default:hl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach(function(t){var r=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(i(160));pl(s,o,a),ul=null,dl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){Nc(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Nc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Nc(e,e.return,g)}}break;case 1:fl(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(fl(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Nc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&J(a,s),xe(l,o);var u=xe(l,s);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):x(a,d,h,u)}switch(l){case"input":X(a,s);break;case"textarea":ie(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?ne(a,!!s.multiple,m,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[pa]=s}catch(g){Nc(e,e.return,g)}}break;case 6:if(fl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){Nc(e,e.return,g)}}break;case 3:if(fl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Nc(e,e.return,g)}break;case 4:default:fl(t,e),yl(e);break;case 13:fl(t,e),yl(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||($l=Je())),4&r&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(u=Yo)||d,fl(t,e),Yo=u):fl(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xo=e,d=e.child;null!==d;){for(h=Xo=d;null!==Xo;){switch(m=(p=Xo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zo(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){Nc(r,n,g)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){El(h);continue}}null!==m?(m.return=p,Xo=m):El(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(g){Nc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Nc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),yl(e),4&r&&ml(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cl(e,ol(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;ll(e,ol(e),s);break;default:throw Error(i(161))}}catch(o){Nc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Xo=e,xl(e,t,n)}function xl(e,t,n){for(var r=0!==(1&e.mode);null!==Xo;){var a=Xo,i=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Ko;if(!s){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Ko;var c=Yo;if(Ko=s,(Yo=l)&&!c)for(Xo=a;null!==Xo;)l=(s=Xo).child,22===s.tag&&null!==s.memoizedState?Sl(a):null!==l?(l.return=s,Xo=l):Sl(a);for(;null!==i;)Xo=i,xl(i,t,n),i=i.sibling;Xo=a,Ko=o,Yo=c}bl(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Xo=i):bl(e)}}function bl(e){for(;null!==Xo;){var t=Xo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yo)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&zi(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zi(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(i(163))}Yo||512&t.flags&&al(t)}catch(p){Nc(t,t.return,p)}}if(t===e){Xo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xo=n;break}Xo=t.return}}function El(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xo=n;break}Xo=t.return}}function Sl(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Nc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){Nc(t,a,l)}}var i=t.return;try{al(t)}catch(l){Nc(t,i,l)}break;case 5:var s=t.return;try{al(t)}catch(l){Nc(t,s,l)}}}catch(l){Nc(t,t.return,l)}if(t===e){Xo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Xo=o;break}Xo=t.return}}var wl,Nl=Math.ceil,kl=b.ReactCurrentDispatcher,Cl=b.ReactCurrentOwner,Il=b.ReactCurrentBatchConfig,Al=0,Tl=null,Rl=null,jl=0,_l=0,Pl=Na(0),Ol=0,Ml=null,Ll=0,Ul=0,Dl=0,ql=null,Fl=null,$l=0,Bl=1/0,zl=null,Vl=!1,Hl=null,Gl=null,Wl=!1,Ql=null,Kl=0,Yl=0,Jl=null,Xl=-1,Zl=0;function ec(){return 0!==(6&Al)?Je():-1!==Xl?Xl:Xl=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==jl?jl&-jl:null!==fi.transition?(0===Zl&&(Zl=ft()),Zl):0!==(e=xt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nc(e,t,n,r){if(50<Yl)throw Yl=0,Jl=null,Error(i(185));yt(e,n,r),0!==(2&Al)&&e===Tl||(e===Tl&&(0===(2&Al)&&(Ul|=n),4===Ol&&oc(e,jl)),rc(e,r),1===n&&0===Al&&0===(1&t.mode)&&(Bl=Je()+500,qa&&Ba()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&r)||(a[s]=pt(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ht(e,e===Tl?jl:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){qa=!0,$a(e)}(lc.bind(null,e)):$a(lc.bind(null,e)),sa(function(){0===(6&Al)&&Ba()}),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Xl=-1,Zl=0,0!==(6&Al))throw Error(i(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=ht(e,e===Tl?jl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=Al;Al|=2;var s=mc();for(Tl===e&&jl===t||(zl=null,Bl=Je()+500,hc(e,t));;)try{vc();break}catch(l){pc(e,l)}Ci(),kl.current=s,Al=a,null!==Rl?t=0:(Tl=null,jl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(a=mt(e))&&(r=a,t=ic(e,a))),1===t)throw n=Ml,hc(e,0),oc(e,r),rc(e,Je()),n;if(6===t)oc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!or(i(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(s=mt(e))&&(r=s,t=ic(e,s))),1===t))throw n=Ml,hc(e,0),oc(e,r),rc(e,Je()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:Ec(e,Fl,zl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=$l+500-Je())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(Ec.bind(null,e,Fl,zl),t);break}Ec(e,Fl,zl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>a&&(a=o),r&=~s}if(r=a,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Nl(r/1960))-r)){e.timeoutHandle=ra(Ec.bind(null,e,Fl,zl),r);break}Ec(e,Fl,zl);break;default:throw Error(i(329))}}}return rc(e,Je()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=ql;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Fl,Fl=n,null!==t&&sc(t)),e}function sc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function oc(e,t){for(t&=~Dl,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Al))throw Error(i(327));Sc();var t=ht(e,0);if(0===(1&t))return rc(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=mt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Ml,hc(e,0),oc(e,t),rc(e,Je()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,Fl,zl),rc(e,Je()),null}function cc(e,t){var n=Al;Al|=1;try{return e(t)}finally{0===(Al=n)&&(Bl=Je()+500,qa&&Ba())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Al)&&Sc();var t=Al;Al|=1;var n=Il.transition,r=xt;try{if(Il.transition=null,xt=1,e)return e()}finally{xt=r,Il.transition=n,0===(6&(Al=t))&&Ba()}}function dc(){_l=Pl.current,ka(Pl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Pa();break;case 3:Yi(),ka(Ta),ka(Aa),ns();break;case 5:Xi(r);break;case 4:Yi();break;case 13:case 19:ka(Zi);break;case 10:Ii(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Tl=e,Rl=e=Pc(e.current,null),jl=_l=t,Ol=0,Ml=null,Dl=Ul=Ll=0,Fl=ql=null,null!==ji){for(t=0;t<ji.length;t++)if(null!==(r=(n=ji[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=a,r.next=s}n.pending=r}ji=null}return e}function pc(e,t){for(;;){var n=Rl;try{if(Ci(),rs.current=Js,cs){for(var r=ss.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}cs=!1}if(is=0,ls=os=ss=null,us=!1,ds=0,Cl.current=null,null===n||null===n.return){Ol=1,Ml=t,Rl=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=jl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,yo(m,o,l,0,t),1&m.mode&&fo(s,u,t),c=u;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fo(s,u,t),fc();break e}c=Error(i(426))}else if(ai&&1&l.mode){var y=go(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),yo(y,o,l,0,t),mi(lo(c,l));break e}}s=c=lo(c,l),4!==Ol&&(Ol=2),null===ql?ql=[s]:ql.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,$i(s,po(0,c,t));break e;case 1:l=c;var v=s.type,x=s.stateNode;if(0===(128&s.flags)&&("function"===typeof v.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Gl||!Gl.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t,$i(s,mo(s,l,t));break e}}s=s.return}while(null!==s)}bc(n)}catch(b){t=b,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function mc(){var e=kl.current;return kl.current=Js,null===e?Js:e}function fc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Tl||0===(268435455&Ll)&&0===(268435455&Ul)||oc(Tl,jl)}function gc(e,t){var n=Al;Al|=2;var r=mc();for(Tl===e&&jl===t||(zl=null,hc(e,t));;)try{yc();break}catch(a){pc(e,a)}if(Ci(),Al=n,kl.current=r,null!==Rl)throw Error(i(261));return Tl=null,jl=0,Ol}function yc(){for(;null!==Rl;)xc(Rl)}function vc(){for(;null!==Rl&&!Ke();)xc(Rl)}function xc(e){var t=wl(e.alternate,e,_l);e.memoizedProps=e.pendingProps,null===t?bc(e):Rl=t,Cl.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Wo(n,t,_l)))return void(Rl=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Ol=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Ol&&(Ol=5)}function Ec(e,t,n){var r=xt,a=Il.transition;try{Il.transition=null,xt=1,function(e,t,n,r){do{Sc()}while(null!==Ql);if(0!==(6&Al))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,s),e===Tl&&(Rl=Tl=null,jl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wl||(Wl=!0,Tc(tt,function(){return Sc(),null})),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Il.transition,Il.transition=null;var o=xt;xt=1;var l=Al;Al|=4,Cl.current=null,function(e,t){if(ea=Vt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(E){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==a&&3!==h.nodeType||(l=o+a),h!==s||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++u===a&&(l=o),p===s&&++d===r&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Vt=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,y=f.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(i(163))}}catch(E){Nc(t,t.return,E)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}f=tl,tl=!1}(e,n),gl(n,e),mr(ta),Vt=!!ea,ta=ea=null,e.current=n,vl(n,e,a),Ye(),Al=l,xt=o,Il.transition=s}else e.current=n;if(Wl&&(Wl=!1,Ql=e,Kl=a),s=e.pendingLanes,0===s&&(Gl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Vl)throw Vl=!1,e=Hl,Hl=null,e;0!==(1&Kl)&&0!==e.tag&&Sc(),s=e.pendingLanes,0!==(1&s)?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,Ba()}(e,t,n,r)}finally{Il.transition=a,xt=r}return null}function Sc(){if(null!==Ql){var e=bt(Kl),t=Il.transition,n=xt;try{if(Il.transition=null,xt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Kl=0,0!==(6&Al))throw Error(i(331));var a=Al;for(Al|=4,Xo=e.current;null!==Xo;){var s=Xo,o=s.child;if(0!==(16&Xo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xo=u;null!==Xo;){var d=Xo;switch(d.tag){case 0:case 11:case 15:nl(8,d,s)}var h=d.child;if(null!==h)h.return=d,Xo=h;else for(;null!==Xo;){var p=(d=Xo).sibling,m=d.return;if(il(d),d===u){Xo=null;break}if(null!==p){p.return=m,Xo=p;break}Xo=m}}}var f=s.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Xo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Xo=o;else e:for(;null!==Xo;){if(0!==(2048&(s=Xo).flags))switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Xo=v;break e}Xo=s.return}}var x=e.current;for(Xo=x;null!==Xo;){var b=(o=Xo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Xo=b;else e:for(o=x;null!==Xo;){if(0!==(2048&(l=Xo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(S){Nc(l,l.return,S)}if(l===o){Xo=null;break e}var E=l.sibling;if(null!==E){E.return=l.return,Xo=E;break e}Xo=l.return}}if(Al=a,Ba(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(S){}r=!0}return r}finally{xt=n,Il.transition=t}}return!1}function wc(e,t,n){e=qi(e,t=po(0,t=lo(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Nc(e,t,n){if(3===e.tag)wc(e,e,n);else for(;null!==t;){if(3===t.tag){wc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gl||!Gl.has(r))){t=qi(t,e=mo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function kc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(jl&n)===n&&(4===Ol||3===Ol&&(130023424&jl)===jl&&500>Je()-$l?hc(e,0):Dl|=n),rc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Oi(e,t))&&(yt(e,t,n),rc(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Cc(e,n)}function Tc(e,t){return We(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jc(e,t,n,r){return new Rc(e,t,n,r)}function _c(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=jc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,a,s){var o=2;if(r=e,"function"===typeof e)_c(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case w:return Mc(n.children,a,s,t);case N:o=8,a|=8;break;case k:return(e=jc(12,n,t,2|a)).elementType=k,e.lanes=s,e;case T:return(e=jc(13,n,t,a)).elementType=T,e.lanes=s,e;case R:return(e=jc(19,n,t,a)).elementType=R,e.lanes=s,e;case P:return Lc(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case I:o=9;break e;case A:o=11;break e;case j:o=14;break e;case _:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=jc(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Mc(e,t,n,r){return(e=jc(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=jc(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=jc(6,e,null,t)).lanes=n,e}function Dc(e,t,n){return(t=jc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Fc(e,t,n,r,a,i,s,o,l){return e=new qc(e,t,n,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=jc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Li(i),e}function $c(e){if(!e)return Ia;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(_a(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(_a(n))return Ma(e,n,t)}return t}function Bc(e,t,n,r,a,i,s,o,l){return(e=Fc(n,r,!0,e,0,i,0,o,l)).context=$c(null),n=e.current,(i=Di(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,qi(n,i,a),e.current.lanes=a,yt(e,a,r),rc(e,r),e}function zc(e,t,n,r){var a=t.current,i=ec(),s=tc(a);return n=$c(n),null===t.context?t.context=n:t.pendingContext=n,(t=Di(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=qi(a,t,s))&&(nc(e,a,s,i),Fi(e,a,s)),s}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}wl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)xo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xo=!1,function(e,t,n){switch(t.tag){case 3:To(t),pi();break;case 5:Ji(t);break;case 1:_a(t.type)&&La(t);break;case 4:Ki(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ca(Si,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ca(Zi,1&Zi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Uo(e,t,n):(Ca(Zi,1&Zi.current),null!==(e=Vo(e,t,n))?e.sibling:null);Ca(Zi,1&Zi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ca(Zi,Zi.current),r)break;return null;case 22:case 23:return t.lanes=0,No(e,t,n)}return Vo(e,t,n)}(e,t,n);xo=0!==(131072&e.flags)}else xo=!1,ai&&0!==(1048576&t.flags)&&Za(t,Ga,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zo(e,t),e=t.pendingProps;var a=ja(t,Aa.current);Ti(t,n),a=fs(null,t,r,e,a,n);var s=gs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,_a(r)?(s=!0,La(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Li(t),a.updater=ro,t.stateNode=a,a._reactInternals=t,oo(t,r,e,n),t=Ao(null,t,r,!0,s,n)):(t.tag=0,ai&&s&&ei(t),bo(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zo(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return _c(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===j)return 14}return 2}(r),e=to(r,e),a){case 0:t=Co(null,t,r,e,n);break e;case 1:t=Io(null,t,r,e,n);break e;case 11:t=Eo(null,t,r,e,n);break e;case 14:t=So(null,t,r,to(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Co(e,t,r,a=t.elementType===r?a:to(r,a),n);case 1:return r=t.type,a=t.pendingProps,Io(e,t,r,a=t.elementType===r?a:to(r,a),n);case 3:e:{if(To(t),null===e)throw Error(i(387));r=t.pendingProps,a=(s=t.memoizedState).element,Ui(e,t),Bi(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ro(e,t,r,n,a=lo(Error(i(423)),t));break e}if(r!==a){t=Ro(e,t,r,n,a=lo(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Ei(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===a){t=Vo(e,t,n);break e}bo(e,t,r,n)}t=t.child}return t;case 5:return Ji(t),null===e&&ci(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,na(r,a)?o=null:null!==s&&na(r,s)&&(t.flags|=32),ko(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Uo(e,t,n);case 4:return Ki(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=bi(t,null,r,n):bo(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,Eo(e,t,r,a=t.elementType===r?a:to(r,a),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Ca(Si,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===a.children&&!Ta.current){t=Vo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=Di(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ai(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ai(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}bo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ti(t,n),r=r(a=Ri(a)),t.flags|=1,bo(e,t,r,n),t.child;case 14:return a=to(r=t.type,t.pendingProps),So(e,t,r,a=to(r.type,a),n);case 15:return wo(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:to(r,a),zo(e,t),t.tag=1,_a(r)?(e=!0,La(t)):e=!1,Ti(t,n),io(t,r,a),oo(t,r,a,n),Ao(null,t,r,!0,e,n);case 19:return Bo(e,t,n);case 22:return No(e,t,n)}throw Error(i(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof a){var o=a;a=function(){var e=Vc(s);o.call(e)}}zc(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Vc(s);i.call(e)}}var s=Bc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[ma]=s.current,Br(8===e.nodeType?e.parentNode:e),uc(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var o=r;r=function(){var e=Vc(l);o.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[ma]=l.current,Br(8===e.nodeType?e.parentNode:e),uc(function(){zc(t,l,n,r)}),l}(n,t,e,a,r);return Vc(s)}Kc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));zc(e,t,null,null)},Kc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){zc(null,e,null,null)}),t[ma]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Ut(e)}},Et=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Je()),0===(6&Al)&&(Bl=Je()+500,Ba()))}break;case 13:uc(function(){var t=Oi(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Gc(e,1)}},St=function(e){if(13===e.tag){var t=Oi(e,134217728);if(null!==t)nc(t,e,134217728,ec());Gc(e,134217728)}},wt=function(e){if(13===e.tag){var t=tc(e),n=Oi(e,t);if(null!==n)nc(n,e,t,ec());Gc(e,t)}},Nt=function(){return xt},kt=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}},Se=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Ea(r);if(!a)throw Error(i(90));W(r),X(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=cc,Te=uc;var eu={usingClientEntryPoint:!1,Events:[xa,ba,Ea,Ce,Ie,cc]},tu={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{at=ru.inject(nu),it=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(i(299));var n=!1,r="",a=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Fc(e,1,!1,null,0,n,0,r,a),e[ma]=t.current,Br(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",o=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,a,0,s,o),e[ma]=t.current,Br(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Kc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[ma]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},352:(e,t,n)=>{var r=n(119);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},355:(e,t)=>{var n,r=Symbol.for("react.element"),a=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function y(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case i:case o:case s:case h:case p:return e;default:switch(e=e&&e.$$typeof){case u:case c:case d:case f:case m:case l:return e;default:return t}}case a:return t}}}n=Symbol.for("react.module.reference")},360:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceRarity=t.ResourceCategory=t.HarvestingCategory=void 0,function(e){e.LITERARY="literary",e.MECHANICAL="mechanical",e.ALCHEMICAL="alchemical",e.ARCHAEOLOGICAL="archaeological",e.BOTANICAL="botanical",e.METALLURGICAL="metallurgical",e.ELECTRICAL="electrical",e.AERONAUTICAL="aeronautical"}(t.HarvestingCategory||(t.HarvestingCategory={})),function(e){e.LITERARY_MATERIALS="literary_materials",e.MECHANICAL_PARTS="mechanical_parts",e.ALCHEMICAL_REAGENTS="alchemical_reagents",e.ARCHAEOLOGICAL_ARTIFACTS="archaeological_artifacts",e.BOTANICAL_SPECIMENS="botanical_specimens",e.METAL_INGOTS="metal_ingots",e.ELECTRICAL_COMPONENTS="electrical_components",e.AERONAUTICAL_PARTS="aeronautical_parts",e.RARE_TREASURES="rare_treasures"}(t.ResourceCategory||(t.ResourceCategory={})),function(e){e.COMMON="common",e.UNCOMMON="uncommon",e.RARE="rare",e.LEGENDARY="legendary"}(t.ResourceRarity||(t.ResourceRarity={}))},414:(e,t,n)=>{e.exports=n(654)},421:(e,t,n)=>{n.d(t,{$V:()=>c,Ay:()=>S,Nh:()=>y,S8:()=>o,oU:()=>l,q3:()=>m,setCharacter:()=>s,setLoading:()=>g});var r=n(774);const a={character:null,hasCharacter:null,characterLoading:!1,activityProgress:null,isOnline:!1,lastSyncTime:null,loading:!1,error:null,activitySwitching:!1},i=(0,r.Z0)({name:"game",initialState:a,reducers:{setCharacter:(e,t)=>{try{const n=t.payload;if(!n||!n.characterId||!n.name)throw new Error("Invalid character data: missing required fields");if("number"!==typeof n.level||n.level<1)throw new Error("Invalid character data: level must be a positive number");if("number"!==typeof n.experience||n.experience<0)throw new Error("Invalid character data: experience must be non-negative");if("number"!==typeof n.currency||n.currency<0)throw new Error("Invalid character data: currency must be non-negative");e.character=n,e.hasCharacter=!0,e.error=null}catch(n){e.error=n instanceof Error?n.message:"Character validation failed",e.hasCharacter=!1}},setHasCharacter:(e,t)=>{e.hasCharacter=t.payload},setCharacterLoading:(e,t)=>{e.characterLoading=t.payload},clearCharacter:e=>{e.character=null,e.hasCharacter=!1},updateCharacterActivity:(e,t)=>{e.character&&(e.character.currentActivity={...e.character.currentActivity,type:t.payload,startedAt:new Date})},updateCharacterStats:(e,t)=>{if(e.character)try{const n=t.payload;if(void 0!==n.level&&("number"!==typeof n.level||n.level<1))throw new Error("Invalid level update: must be a positive number");if(void 0!==n.experience&&("number"!==typeof n.experience||n.experience<0))throw new Error("Invalid experience update: must be non-negative");if(void 0!==n.currency&&("number"!==typeof n.currency||n.currency<0))throw new Error("Invalid currency update: must be non-negative");e.character={...e.character,...n},e.error=null}catch(n){e.error=n instanceof Error?n.message:"Character update validation failed"}},addExperience:(e,t)=>{if(e.character)try{const n=t.payload;if("number"!==typeof n||n<0)throw new Error("Invalid experience gain: must be a non-negative number");e.character.experience+=n;const r=Math.floor(Math.sqrt(e.character.experience/100))+1;r>e.character.level&&(e.character.level=r),e.error=null}catch(n){e.error=n instanceof Error?n.message:"Experience update failed"}},updateCurrency:(e,t)=>{if(e.character)try{const n=t.payload;if("number"!==typeof n||n<0)throw new Error("Invalid currency update: must be a non-negative number");e.character.currency=n,e.error=null}catch(n){e.error=n instanceof Error?n.message:"Currency update failed"}},setOnlineStatus:(e,t)=>{e.isOnline=t.payload},updateLastSyncTime:e=>{e.lastSyncTime=Date.now()},setLoading:(e,t)=>{e.loading=t.payload},setError:(e,t)=>{e.error=t.payload},setActivityProgress:(e,t)=>{e.activityProgress=t.payload},setActivitySwitching:(e,t)=>{e.activitySwitching=t.payload},applyActivityRewards:(e,t)=>{if(e.character)try{const n=t.payload;if(!Array.isArray(n))throw new Error("Invalid rewards: must be an array");n.forEach(t=>{if(!t||"number"!==typeof t.amount||t.amount<0)throw new Error("Invalid reward: must have positive amount");switch(t.type){case"experience":e.character.experience+=t.amount;const n=Math.floor(Math.sqrt(e.character.experience/100))+1;n>e.character.level&&(e.character.level=n);break;case"currency":e.character.currency+=t.amount;break;default:console.warn(`Unknown reward type: ${t.type}`)}}),e.error=null}catch(n){e.error=n instanceof Error?n.message:"Reward application failed"}},recoverGameState:(e,t)=>{try{const n=t.payload;if(n.character){const t=n.character;t.characterId&&t.name&&"number"===typeof t.level&&t.level>0&&"number"===typeof t.experience&&t.experience>=0&&"number"===typeof t.currency&&t.currency>=0&&(e.character=t,e.hasCharacter=!0)}"boolean"===typeof n.isOnline&&(e.isOnline=n.isOnline),"number"===typeof n.lastSyncTime&&(e.lastSyncTime=n.lastSyncTime),n.activityProgress&&(e.activityProgress=n.activityProgress),e.loading=!1,e.characterLoading=!1,e.activitySwitching=!1,e.error=null}catch(n){Object.assign(e,a),e.error="Game state recovery failed"}}}}),{setCharacter:s,setHasCharacter:o,setCharacterLoading:l,clearCharacter:c,updateCharacterActivity:u,updateCharacterStats:d,addExperience:h,updateCurrency:p,setOnlineStatus:m,updateLastSyncTime:f,setLoading:g,setError:y,setActivityProgress:v,setActivitySwitching:x,applyActivityRewards:b,recoverGameState:E}=i.actions,S=i.reducer},523:(e,t,n)=>{t.P=void 0;const r=n(315),a=n(360),i=n(146);t.P=class{static createHarvestingTask(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const o=`harvesting-${t.id}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,l=[];if(t.requiredLevel>0&&l.push({type:"level",requirement:t.requiredLevel,description:`Requires level ${t.requiredLevel}`,isMet:a>=t.requiredLevel}),t.requiredStats)for(const[r,i]of Object.entries(t.requiredStats))l.push({type:"stat",requirement:r,value:i,description:`Requires ${r} ${i}`,isMet:this.getPlayerStat(n,r)>=i});const c=s.location;if(c)for(const r of c.requirements){let e=r.isMet;e||("level"===r.type?e=a>=r.requirement:"item"===r.type&&s.playerInventory?e=(s.playerInventory[r.requirement]||0)>0:"equipment"===r.type&&s.playerEquipment&&(e=!!s.playerEquipment[r.requirement])),l.push({...r,isMet:e})}const u=s.tools||[];for(const r of u)r.durability<=0&&l.push({type:"equipment",requirement:r.toolId,description:`Tool ${r.name} needs repair`,isMet:!1});const d=[];if(t.energyCost>0){var h;const e=(null===(h=s.playerInventory)||void 0===h?void 0:h.energy)||100;d.push({resourceId:"energy",resourceName:"Energy",quantityRequired:t.energyCost,quantityAvailable:e,isSufficient:e>=t.energyCost})}const p=this.calculateEnhancedHarvestingDuration(t,n,u,c),m={activity:t,playerStats:n,location:c,tools:u,expectedYield:this.calculateEnhancedExpectedYield(t,n,u,c)},f={id:o,type:r.TaskType.HARVESTING,name:t.name,description:t.description,icon:t.icon,duration:p,startTime:0,playerId:e,activityData:m,prerequisites:l,resourceRequirements:d,progress:0,completed:!1,rewards:[],priority:s.priority||5,estimatedCompletion:Date.now()+p,retryCount:0,maxRetries:3,isValid:!0,validationErrors:[]},g=s.playerInventory||{},y=i.TaskValidationService.validateTask(f,n,a,g);return f.isValid=y.isValid,f.validationErrors=y.errors.map(e=>e.message),f}static createCraftingTask(e,t,n,a,s){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const l=`crafting-${t.recipeId}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,c=o.quantity||1,u=[];t.requiredLevel>0&&u.push({type:"level",requirement:t.requiredLevel,description:`Requires level ${t.requiredLevel}`,isMet:a>=t.requiredLevel}),u.push({type:"skill",requirement:t.requiredSkill,value:t.requiredLevel,description:`Requires ${t.requiredSkill} level ${t.requiredLevel}`,isMet:this.getCraftingSkillLevel(n,t.requiredSkill)>=t.requiredLevel});const d=[];for(const r of t.materials){const e=r.quantity*c,t=s[r.materialId]||0;d.push({resourceId:r.materialId,resourceName:r.name,quantityRequired:e,quantityAvailable:t,isSufficient:t>=e})}const h={recipe:t,materials:t.materials.map(e=>({materialId:e.materialId,name:e.name,quantity:e.quantity*c,type:e.type})),craftingStation:o.craftingStation,playerSkillLevel:this.getCraftingSkillLevel(n,t.requiredSkill),qualityModifier:this.calculateQualityModifier(n,t),expectedOutputs:t.outputs.map(e=>({itemId:e.itemId,name:e.name,quantity:e.quantity*c,baseStats:e.baseStats,qualityModifier:e.qualityModifier}))},p={id:l,type:r.TaskType.CRAFTING,name:`Craft ${t.name}${c>1?` (x${c})`:""}`,description:t.description,icon:"\ud83d\udd27",duration:1e3*t.craftingTime*c,startTime:0,playerId:e,activityData:h,prerequisites:u,resourceRequirements:d,progress:0,completed:!1,rewards:[],priority:o.priority||5,estimatedCompletion:Date.now()+1e3*t.craftingTime*c,retryCount:0,maxRetries:2,isValid:!0,validationErrors:[]},m=i.TaskValidationService.validateTask(p,n,a,s);return p.isValid=m.isValid,p.validationErrors=m.errors.map(e=>e.message),p}static createCombatTask(e,t,n,a,s){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const l=`combat-${t.enemyId}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,c=[],u=Math.max(1,t.level-2);c.push({type:"level",requirement:u,description:`Recommended level ${u} for ${t.name}`,isMet:a>=u});const d=[];d.push({resourceId:"health",resourceName:"Health",quantityRequired:Math.floor(.5*s.maxHealth),quantityAvailable:s.health,isSufficient:s.health>=Math.floor(.5*s.maxHealth)});const h=this.calculateCombatEstimate(s,t,a),p={enemy:t,playerLevel:a,playerStats:s,equipment:o.equipment||[],combatStrategy:o.strategy||{strategyId:"balanced",name:"Balanced",description:"Balanced attack and defense",modifiers:[]},estimatedOutcome:h},m={id:l,type:r.TaskType.COMBAT,name:`Fight ${t.name}`,description:`Engage in combat with ${t.name} (Level ${t.level})`,icon:"\u2694\ufe0f",duration:1e3*h.estimatedDuration,startTime:0,playerId:e,activityData:p,prerequisites:c,resourceRequirements:d,progress:0,completed:!1,rewards:[],priority:o.priority||5,estimatedCompletion:Date.now()+1e3*h.estimatedDuration,retryCount:0,maxRetries:1,isValid:!0,validationErrors:[]},f=i.TaskValidationService.validateTask(m,n,a,{});return m.isValid=f.isValid,m.validationErrors=f.errors.map(e=>e.message),m}static calculateExpectedYield(e,t){const n=[];for(const[r,a]of Object.entries(e.dropTable))for(const e of a)n.push({resourceId:e.itemId,minQuantity:e.minQuantity,maxQuantity:e.maxQuantity,probability:e.dropRate,rarity:r});return n}static calculateEnhancedExpectedYield(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;const a=[];let i=1,s=0;for(const c of n)for(const e of c.bonuses)"yield"===e.type&&(i+=e.value),"quality"===e.type&&(s+=e.value);if(r){const t=`${e.category.toLowerCase()}_yield`;r.bonusModifiers[t]&&(i+=r.bonusModifiers[t]),r.bonusModifiers.rare_find&&(s+=r.bonusModifiers.rare_find)}const o=this.getRelevantStatForCategory(e.category),l=this.getPlayerStat(t,o);i+=Math.min(.5,l/100);for(const[c,u]of Object.entries(e.dropTable)){const e=c;for(const t of u){let n=t.dropRate;"uncommon"===e?n*=1+.5*s:"rare"===e?n*=1+s:"legendary"===e&&(n*=1+1.5*s),n=Math.min("common"===e?.8:"uncommon"===e?.4:"rare"===e?.2:.05,n);const r=Math.round(t.minQuantity*i),o=Math.round(t.maxQuantity*i);a.push({resourceId:t.itemId,minQuantity:r,maxQuantity:o,probability:n,rarity:e})}}return a}static calculateHarvestingDuration(e,t){let n=1e3*e.baseTime;if(e.requiredStats)for(const[r,a]of Object.entries(e.requiredStats)){const e=this.getPlayerStat(t,r);if(e>a){const t=.01*(e-a);n*=1-Math.min(t,.5)}}return Math.max(1e3,Math.floor(n))}static calculateEnhancedHarvestingDuration(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,a=1e3*e.baseTime;if(e.requiredStats)for(const[s,o]of Object.entries(e.requiredStats)){const e=this.getPlayerStat(t,s);if(e>o){a*=1-Math.min(.5,.01*(e-o))}}for(const s of n)for(const e of s.bonuses)"speed"===e.type&&(a*=1-e.value);if(r){const t=`${e.category.toLowerCase()}_quality`;if(r.bonusModifiers[t]){a*=1-.5*r.bonusModifiers[t]}}const i=this.getHarvestingSkillLevel(t,e.category);return a*=1-Math.min(.4,.01*i),Math.max(1e3,Math.floor(a))}static getRelevantStatForCategory(e){switch(e){case a.HarvestingCategory.LITERARY:return"intelligence";case a.HarvestingCategory.MECHANICAL:return"dexterity";case a.HarvestingCategory.ALCHEMICAL:return"intelligence";case a.HarvestingCategory.ARCHAEOLOGICAL:return"perception";case a.HarvestingCategory.ELECTRICAL:return"intelligence";case a.HarvestingCategory.AERONAUTICAL:return"perception";case a.HarvestingCategory.METALLURGICAL:return"strength";default:return"intelligence"}}static getHarvestingSkillLevel(e,t){if(!e.harvestingSkills)return 1;switch(t){case a.HarvestingCategory.LITERARY:return e.harvestingSkills.level||1;case a.HarvestingCategory.MECHANICAL:return e.harvestingSkills.salvaging||1;case a.HarvestingCategory.ALCHEMICAL:case a.HarvestingCategory.ARCHAEOLOGICAL:case a.HarvestingCategory.ELECTRICAL:case a.HarvestingCategory.AERONAUTICAL:return e.harvestingSkills.level||1;case a.HarvestingCategory.METALLURGICAL:return e.harvestingSkills.mining||1;default:return 1}}static calculateQualityModifier(e,t){const n=this.getCraftingSkillLevel(e,t.requiredSkill),r=.02*Math.max(0,n-t.requiredLevel);return Math.min(1.5,.8+r)}static calculateCombatEstimate(e,t,n){const r=(e.attack+e.defense+e.health/10)/(t.stats.attack+t.stats.defense+t.stats.health/10),a=Math.max(.05,Math.min(.95,.5+.3*(r-1)));let i="medium";return i=a>.8?"low":a>.6?"medium":a>.3?"high":"extreme",{winProbability:a,estimatedDuration:Math.max(10,Math.floor(t.stats.health/Math.max(1,e.attack-t.stats.defense)*3)),expectedRewards:t.lootTable.map(e=>({type:"item",itemId:e.itemId,quantity:e.quantity,rarity:e.rarity,isRare:"common"!==e.rarity})),riskLevel:i}}static getPlayerStat(e,t){switch(t.toLowerCase()){case"strength":return e.strength;case"dexterity":return e.dexterity;case"intelligence":return e.intelligence;case"vitality":return e.vitality;default:return 0}}static getCraftingSkillLevel(e,t){switch(t){case"clockmaking":return e.craftingSkills.clockmaking;case"engineering":return e.craftingSkills.engineering;case"alchemy":return e.craftingSkills.alchemy;case"steamcraft":return e.craftingSkills.steamcraft;default:return 0}}static updateTaskProgress(e,t){const n=Math.min(1,Math.max(0,e.progress+t));return{...e,progress:n,completed:n>=1}}static canRetryTask(e){return e.retryCount<e.maxRetries&&!e.completed}static createRetryTask(e){return{...e,id:`${e.id}-retry-${e.retryCount+1}`,retryCount:e.retryCount+1,progress:0,completed:!1,startTime:0,estimatedCompletion:Date.now()+e.duration}}static calculateQueueDuration(e){return e.reduce((e,t)=>e+t.duration,0)}static sortTasksByPriority(e){return[...e].sort((e,t)=>t.priority-e.priority)}static filterValidTasks(e){return e.filter(e=>e.isValid&&0===e.validationErrors.length)}static createTaskFromActivity(e,t){const n=`${t.type.toLowerCase()}-${t.id}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,r=[];if(t.requirements)for(const a of t.requirements)r.push({type:"activity",requirement:a,description:a,isMet:!0});return{id:n,type:t.type,name:t.name,description:t.description,icon:t.icon,duration:t.duration,startTime:0,playerId:e,activityData:{activity:{id:t.id,name:t.name,description:t.description,icon:t.icon,category:a.HarvestingCategory.MECHANICAL,requiredLevel:1,baseTime:t.duration/1e3,energyCost:10,dropTable:{guaranteed:[],common:[],uncommon:[],rare:[],legendary:[]},statBonuses:{experience:10}},playerStats:{strength:10,dexterity:10,intelligence:10,vitality:10,harvestingSkills:{level:1,mining:1,foraging:1,salvaging:1,crystal_extraction:1,experience:0},craftingSkills:{level:1,experience:0,clockmaking:1,engineering:1,alchemy:1,steamcraft:1},combatSkills:{level:1,melee:1,ranged:1,defense:1,tactics:1,experience:0}},tools:[],expectedYield:[]},prerequisites:r,resourceRequirements:[],progress:0,completed:!1,rewards:[],priority:5,estimatedCompletion:Date.now()+t.duration,retryCount:0,maxRetries:3,isValid:!0,validationErrors:[]}}static calculateChecksum(e){let t=0;if(0===e.length)return t.toString();for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return Math.abs(t).toString(16)}}},538:(e,t,n)=>{e.exports=n(759)},609:(e,t,n)=>{n.d(t,{P:()=>i,_b:()=>a});var r=n(280);class a{static configure(e){this.config={...this.config,...e}}static getConfig(){return{...this.config}}static async checkNetworkConnectivity(){const e=Date.now();if(e-this.lastNetworkCheck<this.networkCheckInterval)return this.isOnline;try{const t=await r._P.fetchJson(`${this.config.baseURL}/health`,{},{timeout:3e3,retries:0});return this.isOnline=t&&("healthy"===t.status||"degraded"===t.status),this.lastNetworkCheck=e,this.isOnline}catch(t){return console.warn("[NetworkClient] Health check failed:",t),this.isOnline=!1,this.lastNetworkCheck=e,!1}}static async post(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=`${this.config.baseURL}${e}`;!await this.checkNetworkConnectivity()&&this.config.enableMockFallback&&console.warn("[NetworkClient] Network appears to be down, will attempt request but may fallback to mock");try{console.log(`[NetworkClient] Attempting POST to ${a}`);const e={timeout:this.config.timeout,retries:this.config.retries,retryDelay:this.config.retryDelay,exponentialBackoff:!0,...n},i=await r._P.postJson(a,t,e);return console.log(`[NetworkClient] POST to ${a} successful`),{data:i,success:!0,fromMock:!1}}catch(s){if(console.error(`[NetworkClient] POST to ${a} failed:`,s.message),this.shouldFallbackToMock(s))throw console.warn("[NetworkClient] Falling back to mock service due to network error"),new i(s.message,s);throw this.enhanceNetworkError(s,"POST",a)}}static async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=`${this.config.baseURL}${e}`;try{console.log(`[NetworkClient] Attempting GET to ${n}`);const e={timeout:this.config.timeout,retries:this.config.retries,retryDelay:this.config.retryDelay,exponentialBackoff:!0,...t},a=await r._P.fetchJson(n,{},e);return console.log(`[NetworkClient] GET to ${n} successful`),{data:a,success:!0,fromMock:!1}}catch(a){if(console.error(`[NetworkClient] GET to ${n} failed:`,a.message),this.shouldFallbackToMock(a))throw console.warn("[NetworkClient] Falling back to mock service due to network error"),new i(a.message,a);throw this.enhanceNetworkError(a,"GET",n)}}static async put(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=`${this.config.baseURL}${e}`;try{console.log(`[NetworkClient] Attempting PUT to ${a}`);const e={timeout:this.config.timeout,retries:this.config.retries,retryDelay:this.config.retryDelay,exponentialBackoff:!0,...n},i=await r._P.putJson(a,t,e);return console.log(`[NetworkClient] PUT to ${a} successful`),{data:i,success:!0,fromMock:!1}}catch(s){if(console.error(`[NetworkClient] PUT to ${a} failed:`,s.message),this.shouldFallbackToMock(s))throw console.warn("[NetworkClient] Falling back to mock service due to network error"),new i(s.message,s);throw this.enhanceNetworkError(s,"PUT",a)}}static async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=`${this.config.baseURL}${e}`;try{console.log(`[NetworkClient] Attempting DELETE to ${n}`);const e={timeout:this.config.timeout,retries:this.config.retries,retryDelay:this.config.retryDelay,exponentialBackoff:!0,...t};return await r._P.delete(n,e),console.log(`[NetworkClient] DELETE to ${n} successful`),{data:void 0,success:!0,fromMock:!1}}catch(a){if(console.error(`[NetworkClient] DELETE to ${n} failed:`,a.message),this.shouldFallbackToMock(a))throw console.warn("[NetworkClient] Falling back to mock service due to network error"),new i(a.message,a);throw this.enhanceNetworkError(a,"DELETE",n)}}static shouldFallbackToMock(e){return!!this.config.enableMockFallback&&(!!e.isNetworkError||(!(!e.message||!e.message.includes("fetch"))||(!(!e.message||!e.message.includes("CORS"))||(404===e.statusCode||!!(e.statusCode&&e.statusCode>=500)))))}static enhanceNetworkError(e,t,n){let r=`${t} request to ${n} failed`;if(e.isNetworkError)r=e.isOffline?"You appear to be offline. Please check your internet connection and try again.":e.isTimeout?"The request timed out. Please try again.":"Network error occurred. Please check your connection and try again.";else if(e.statusCode)switch(e.statusCode){case 400:r="Invalid request. Please check your input and try again.";break;case 401:r="Authentication required. Please log in and try again.";break;case 403:r="Access denied. You do not have permission to perform this action.";break;case 404:r="Service not found. The server may be unavailable.";break;case 429:r="Too many requests. Please wait a moment and try again.";break;case 500:r="Server error occurred. Please try again later.";break;case 503:r="Service temporarily unavailable. Please try again later.";break;default:r=`Server returned error ${e.statusCode}. Please try again.`}const a=new Error(r);return a.originalError=e,a.statusCode=e.statusCode,a.isNetworkError=e.isNetworkError,a}static async testConnectivity(){const e=Date.now();try{await this.checkNetworkConnectivity();const t=Date.now()-e;return{isOnline:this.isOnline,latency:t}}catch(t){return{isOnline:!1,error:t.message}}}}a.config={baseURL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",timeout:15e3,retries:2,retryDelay:1e3,enableMockFallback:!0,mockFallbackDelay:3e3},a.isOnline=!0,a.lastNetworkCheck=0,a.networkCheckInterval=5e3;class i extends Error{constructor(e,t){super(e),this.originalError=void 0,this.shouldFallback=!0,this.name="NetworkFallbackError",this.originalError=t}}},630:(e,t,n)=>{e.exports=n(138)},654:(e,t,n)=>{var r=n(950),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},759:(e,t,n)=>{var r=n(950);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=r.useState,s=r.useEffect,o=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(r){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),a=r[0].inst,u=r[1];return o(function(){a.value=n,a.getSnapshot=t,c(a)&&u({inst:a})},[e,n,t]),s(function(){return c(a)&&u({inst:a}),e(function(){c(a)&&u({inst:a})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},761:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<a&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,m=!1,f=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function E(e){if(g=!1,b(e),!f)if(null!==r(c))f=!0,P(S);else{var t=r(u);null!==t&&O(E,t.startTime-e)}}function S(e,n){f=!1,g&&(g=!1,v(C),C=-1),m=!0;var i=p;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&a(c),b(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&O(E,d.startTime-n),l=!1}return l}finally{h=null,p=i,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,N=!1,k=null,C=-1,I=5,A=-1;function T(){return!(t.unstable_now()-A<I)}function R(){if(null!==k){var e=t.unstable_now();A=e;var n=!0;try{n=k(!0,e)}finally{n?w():(N=!1,k=null)}}else N=!1}if("function"===typeof x)w=function(){x(R)};else if("undefined"!==typeof MessageChannel){var j=new MessageChannel,_=j.port2;j.port1.onmessage=R,w=function(){_.postMessage(null)}}else w=function(){y(R,0)};function P(e){k=e,N||(N=!0,w())}function O(e,n){C=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,P(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(g?(v(C),C=-1):g=!0,O(E,i-s))):(e.sortIndex=o,n(c,e),f||m||(f=!0,P(S))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},774:(e,t,n)=>{function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function a(e){return!!e&&!!e[W]}function i(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Q}(e)||Array.isArray(e)||!!e[G]||!!(null===(t=e.constructor)||void 0===t?void 0:t[G])||h(e)||p(e))}function s(e,t,n){void 0===n&&(n=!1),0===o(e)?(n?Object.keys:K)(e).forEach(function(r){n&&"symbol"==typeof r||t(r,e[r],e)}):e.forEach(function(n,r){return t(r,n,e)})}function o(e){var t=e[W];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:h(e)?2:p(e)?3:0}function l(e,t){return 2===o(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){return 2===o(e)?e.get(t):e[t]}function u(e,t,n){var r=o(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function d(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function h(e){return B&&e instanceof Map}function p(e){return z&&e instanceof Set}function m(e){return e.o||e.t}function f(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Y(e);delete t[W];for(var n=K(t),r=0;r<n.length;r++){var a=n[r],i=t[a];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]})}return Object.create(Object.getPrototypeOf(e),t)}function g(e,t){return void 0===t&&(t=!1),v(e)||a(e)||!i(e)||(o(e)>1&&(e.set=e.add=e.clear=e.delete=y),Object.freeze(e),t&&s(e,function(e,t){return g(t,!0)},!0)),e}function y(){r(2)}function v(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function x(e){var t=J[e];return t||r(18,e),t}function b(e,t){J[e]||(J[e]=t)}function E(){return F}function S(e,t){t&&(x("Patches"),e.u=[],e.s=[],e.v=t)}function w(e){N(e),e.p.forEach(C),e.p=null}function N(e){e===F&&(F=e.l)}function k(e){return F={p:[],l:F,h:e,m:!0,_:0}}function C(e){var t=e[W];0===t.i||1===t.i?t.j():t.g=!0}function I(e,t){t._=t.p.length;var n=t.p[0],a=void 0!==e&&e!==n;return t.h.O||x("ES5").S(t,e,a),a?(n[W].P&&(w(t),r(4)),i(e)&&(e=A(t,e),t.l||R(t,e)),t.u&&x("Patches").M(n[W].t,e,t.u,t.s)):e=A(t,n,[]),w(t),t.u&&t.v(t.u,t.s),e!==H?e:void 0}function A(e,t,n){if(v(t))return t;var r=t[W];if(!r)return s(t,function(a,i){return T(e,r,t,a,i,n)},!0),t;if(r.A!==e)return t;if(!r.P)return R(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var a=4===r.i||5===r.i?r.o=f(r.k):r.o,i=a,o=!1;3===r.i&&(i=new Set(a),a.clear(),o=!0),s(i,function(t,i){return T(e,r,a,t,i,n,o)}),R(e,a,!1),n&&e.u&&x("Patches").N(r,n,e.u,e.s)}return r.o}function T(e,t,n,r,s,o,c){if(a(s)){var d=A(e,s,o&&t&&3!==t.i&&!l(t.R,r)?o.concat(r):void 0);if(u(n,r,d),!a(d))return;e.m=!1}else c&&n.add(s);if(i(s)&&!v(s)){if(!e.h.D&&e._<1)return;A(e,s),t&&t.A.l||R(e,s)}}function R(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&g(t,n)}function j(e,t){var n=e[W];return(n?m(n):e)[t]}function _(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function P(e){e.P||(e.P=!0,e.l&&P(e.l))}function O(e){e.o||(e.o=f(e.t))}function M(e,t,n){var r=h(t)?x("MapSet").F(t,n):p(t)?x("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:E(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},a=r,i=X;n&&(a=[r],i=Z);var s=Proxy.revocable(a,i),o=s.revoke,l=s.proxy;return r.k=l,r.j=o,l}(t,n):x("ES5").J(t,n);return(n?n.A:E()).p.push(r),r}function L(e){return a(e)||r(22,e),function e(t){if(!i(t))return t;var n,r=t[W],a=o(t);if(r){if(!r.P&&(r.i<4||!x("ES5").K(r)))return r.t;r.I=!0,n=U(t,a),r.I=!1}else n=U(t,a);return s(n,function(t,a){r&&c(r.t,t)===a||u(n,t,e(a))}),3===a?new Set(n):n}(e)}function U(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return f(e)}function D(){function e(e,t){var n=i[e];return n?n.enumerable=t:i[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[W];return X.get(t,e)},set:function(t){var n=this[W];X.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var a=e[t][W];if(!a.P)switch(a.i){case 5:r(a)&&P(a);break;case 4:n(a)&&P(a)}}}function n(e){for(var t=e.t,n=e.k,r=K(n),a=r.length-1;a>=0;a--){var i=r[a];if(i!==W){var s=t[i];if(void 0===s&&!l(t,i))return!0;var o=n[i],c=o&&o[W];if(c?c.t!==s:!d(o,s))return!0}}var u=!!t[W];return r.length!==K(t).length+(u?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var i={};b("ES5",{J:function(t,n){var r=Array.isArray(t),a=function(t,n){if(t){for(var r=Array(n.length),a=0;a<n.length;a++)Object.defineProperty(r,""+a,e(a,!0));return r}var i=Y(n);delete i[W];for(var s=K(i),o=0;o<s.length;o++){var l=s[o];i[l]=e(l,t||!!i[l].enumerable)}return Object.create(Object.getPrototypeOf(n),i)}(r,t),i={i:r?5:4,A:n?n.A:E(),P:!1,I:!1,R:{},l:n,t:t,k:a,o:null,g:!1,C:!1};return Object.defineProperty(a,W,{value:i,writable:!0}),a},S:function(e,n,i){i?a(n)&&n[W].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[W];if(n){var a=n.t,i=n.k,o=n.R,c=n.i;if(4===c)s(i,function(t){t!==W&&(void 0!==a[t]||l(a,t)?o[t]||e(i[t]):(o[t]=!0,P(n)))}),s(a,function(e){void 0!==i[e]||l(i,e)||(o[e]=!1,P(n))});else if(5===c){if(r(n)&&(P(n),o.length=!0),i.length<a.length)for(var u=i.length;u<a.length;u++)o[u]=!1;else for(var d=a.length;d<i.length;d++)o[d]=!0;for(var h=Math.min(i.length,a.length),p=0;p<h;p++)i.hasOwnProperty(p)||(o[p]=!0),void 0===o[p]&&e(i[p])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}n.d(t,{U1:()=>ze,Z0:()=>He,WA:()=>at});var q,F,$="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),B="undefined"!=typeof Map,z="undefined"!=typeof Set,V="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,H=$?Symbol.for("immer-nothing"):((q={})["immer-nothing"]=!0,q),G=$?Symbol.for("immer-draftable"):"__$immer_draftable",W=$?Symbol.for("immer-state"):"__$immer_state",Q=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),K="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Y=Object.getOwnPropertyDescriptors||function(e){var t={};return K(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},J={},X={get:function(e,t){if(t===W)return e;var n=m(e);if(!l(n,t))return function(e,t,n){var r,a=_(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!i(r)?r:r===j(e.t,t)?(O(e),e.o[t]=M(e.A.h,r,e)):r},has:function(e,t){return t in m(e)},ownKeys:function(e){return Reflect.ownKeys(m(e))},set:function(e,t,n){var r=_(m(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var a=j(m(e),t),i=null==a?void 0:a[W];if(i&&i.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(d(n,a)&&(void 0!==n||l(e.t,t)))return!0;O(e),P(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==j(e.t,t)||t in e.t?(e.R[t]=!1,O(e),P(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=m(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){r(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){r(12)}},Z={};s(X,function(e,t){Z[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Z.deleteProperty=function(e,t){return Z.set.call(this,e,t,void 0)},Z.set=function(e,t,n){return X.set.call(this,e[0],t,n,e[0])};var ee=function(){function e(e){var t=this;this.O=V,this.D=!0,this.produce=function(e,n,a){if("function"==typeof e&&"function"!=typeof n){var s=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=s);for(var r=arguments.length,a=Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return o.produce(e,function(e){var r;return(r=n).call.apply(r,[t,e].concat(a))})}}var l;if("function"!=typeof n&&r(6),void 0!==a&&"function"!=typeof a&&r(7),i(e)){var c=k(t),u=M(t,e,void 0),d=!0;try{l=n(u),d=!1}finally{d?w(c):N(c)}return"undefined"!=typeof Promise&&l instanceof Promise?l.then(function(e){return S(c,a),I(e,c)},function(e){throw w(c),e}):(S(c,a),I(l,c))}if(!e||"object"!=typeof e){if(void 0===(l=n(e))&&(l=e),l===H&&(l=void 0),t.D&&g(l,!0),a){var h=[],p=[];x("Patches").M(e,l,h,p),a(h,p)}return l}r(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,a=Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return t.produceWithPatches(n,function(t){return e.apply(void 0,[t].concat(a))})};var r,a,i=t.produce(e,n,function(e,t){r=e,a=t});return"undefined"!=typeof Promise&&i instanceof Promise?i.then(function(e){return[e,r,a]}):[i,r,a]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){i(e)||r(8),a(e)&&(e=L(e));var t=k(this),n=M(this,e,void 0);return n[W].C=!0,N(t),n},t.finishDraft=function(e,t){var n=(e&&e[W]).A;return S(n,t),I(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!V&&r(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var i=x("Patches").$;return a(e)?i(e,t):this.produce(e,function(e){return i(e,t)})},e}(),te=new ee,ne=te.produce;te.produceWithPatches.bind(te),te.setAutoFreeze.bind(te),te.setUseProxies.bind(te),te.applyPatches.bind(te),te.createDraft.bind(te),te.finishDraft.bind(te);const re=ne;function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function ie(e){var t=function(e,t){if("object"!=ae(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ae(t)?t:t+""}function se(e,t,n){return(t=ie(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach(function(t){se(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ce(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var ue="function"===typeof Symbol&&Symbol.observable||"@@observable",de=function(){return Math.random().toString(36).substring(7).split("").join(".")},he={INIT:"@@redux/INIT"+de(),REPLACE:"@@redux/REPLACE"+de(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+de()}};function pe(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function me(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(ce(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(ce(1));return n(me)(e,t)}if("function"!==typeof e)throw new Error(ce(2));var a=e,i=t,s=[],o=s,l=!1;function c(){o===s&&(o=s.slice())}function u(){if(l)throw new Error(ce(3));return i}function d(e){if("function"!==typeof e)throw new Error(ce(4));if(l)throw new Error(ce(5));var t=!0;return c(),o.push(e),function(){if(t){if(l)throw new Error(ce(6));t=!1,c();var n=o.indexOf(e);o.splice(n,1),s=null}}}function h(e){if(!pe(e))throw new Error(ce(7));if("undefined"===typeof e.type)throw new Error(ce(8));if(l)throw new Error(ce(9));try{l=!0,i=a(i,e)}finally{l=!1}for(var t=s=o,n=0;n<t.length;n++){(0,t[n])()}return e}return h({type:he.INIT}),(r={dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!==typeof e)throw new Error(ce(10));a=e,h({type:he.REPLACE})}})[ue]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(ce(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[ue]=function(){return this},e},r}function fe(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var a=t[r];0,"function"===typeof e[a]&&(n[a]=e[a])}var i,s=Object.keys(n);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:he.INIT}))throw new Error(ce(12));if("undefined"===typeof n(void 0,{type:he.PROBE_UNKNOWN_ACTION()}))throw new Error(ce(13))})}(n)}catch(o){i=o}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,a={},o=0;o<s.length;o++){var l=s[o],c=n[l],u=e[l],d=c(u,t);if("undefined"===typeof d){t&&t.type;throw new Error(ce(14))}a[l]=d,r=r||d!==u}return(r=r||s.length!==Object.keys(e).length)?a:e}}function ge(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function ye(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(ce(15))},a={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map(function(e){return e(a)});return r=ge.apply(void 0,i)(n.dispatch),le(le({},n),{},{dispatch:r})}}}function ve(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(a){return"function"===typeof a?a(n,r,e):t(a)}}}}var xe=ve();xe.withExtraArgument=ve;const be=xe;var Ee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Se=function(e,t){var n,r,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(o){i=[6,o],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},we=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},Ne=Object.defineProperty,ke=Object.defineProperties,Ce=Object.getOwnPropertyDescriptors,Ie=Object.getOwnPropertySymbols,Ae=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable,Re=function(e,t,n){return t in e?Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},je=function(e,t){for(var n in t||(t={}))Ae.call(t,n)&&Re(e,n,t[n]);if(Ie)for(var r=0,a=Ie(t);r<a.length;r++){n=a[r];Te.call(t,n)&&Re(e,n,t[n])}return e},_e=function(e,t){return ke(e,Ce(t))},Pe=function(e,t,n){return new Promise(function(r,a){var i=function(e){try{o(n.next(e))}catch(t){a(t)}},s=function(e){try{o(n.throw(e))}catch(t){a(t)}},o=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(i,s)};o((n=n.apply(e,t)).next())})},Oe="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?ge:ge.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function Me(e){if("object"!==typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}var Le=function(e){return e&&"function"===typeof e.match};function Ue(e,t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(t){var a=t.apply(void 0,n);if(!a)throw new Error("prepareAction did not return an object");return je(je({type:e,payload:a.payload},"meta"in a&&{meta:a.meta}),"error"in a&&{error:a.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}var De=function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=e.apply(this,n)||this;return Object.setPrototypeOf(a,t.prototype),a}return Ee(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,we([void 0],e[0].concat(this)))):new(t.bind.apply(t,we([void 0],e.concat(this))))},t}(Array),qe=function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=e.apply(this,n)||this;return Object.setPrototypeOf(a,t.prototype),a}return Ee(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,we([void 0],e[0].concat(this)))):new(t.bind.apply(t,we([void 0],e.concat(this))))},t}(Array);function Fe(e){return i(e)?re(e,function(){}):e}function $e(){return function(e){return function(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t,r=(e.immutableCheck,e.serializableCheck,e.actionCreatorCheck,new De);n&&(!function(e){return"boolean"===typeof e}(n)?r.push(be.withExtraArgument(n.extraArgument)):r.push(be));0;return r}(e)}}var Be=!0;function ze(e){var t,n=$e(),r=e||{},a=r.reducer,i=void 0===a?void 0:a,s=r.middleware,o=void 0===s?n():s,l=r.devTools,c=void 0===l||l,u=r.preloadedState,d=void 0===u?void 0:u,h=r.enhancers,p=void 0===h?void 0:h;if("function"===typeof i)t=i;else{if(!Me(i))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=fe(i)}var m=o;if("function"===typeof m&&(m=m(n),!Be&&!Array.isArray(m)))throw new Error("when using a middleware builder function, an array of middleware must be returned");if(!Be&&m.some(function(e){return"function"!==typeof e}))throw new Error("each middleware provided to configureStore must be a function");var f=ye.apply(void 0,m),g=ge;c&&(g=Oe(je({trace:!Be},"object"===typeof c&&c)));var y=new qe(f),v=y;return Array.isArray(p)?v=we([f],p):"function"===typeof p&&(v=p(y)),me(t,d,g.apply(void 0,v))}function Ve(e){var t,n={},r=[],a={addCase:function(e,t){var r="string"===typeof e?e:e.type;if(!r)throw new Error("`builder.addCase` cannot be called with an empty action type");if(r in n)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return n[r]=t,a},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),a},addDefaultCase:function(e){return t=e,a}};return e(a),[n,r,t]}function He(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");var n,r="function"==typeof e.initialState?e.initialState:Fe(e.initialState),s=e.reducers||{},o=Object.keys(s),l={},c={},u={};function d(){var t="function"===typeof e.extraReducers?Ve(e.extraReducers):[e.extraReducers],n=t[0],s=void 0===n?{}:n,o=t[1],l=void 0===o?[]:o,u=t[2],d=void 0===u?void 0:u,h=je(je({},s),c);return function(e,t,n,r){void 0===n&&(n=[]);var s,o="function"===typeof t?Ve(t):[t,n,r],l=o[0],c=o[1],u=o[2];if(function(e){return"function"===typeof e}(e))s=function(){return Fe(e())};else{var d=Fe(e);s=function(){return d}}function h(e,t){void 0===e&&(e=s());var n=we([l[t.type]],c.filter(function(e){return(0,e.matcher)(t)}).map(function(e){return e.reducer}));return 0===n.filter(function(e){return!!e}).length&&(n=[u]),n.reduce(function(e,n){if(n){var r;if(a(e))return void 0===(r=n(e,t))?e:r;if(i(e))return re(e,function(e){return n(e,t)});if(void 0===(r=n(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}return e},e)}return h.getInitialState=s,h}(r,function(e){for(var t in h)e.addCase(t,h[t]);for(var n=0,r=l;n<r.length;n++){var a=r[n];e.addMatcher(a.matcher,a.reducer)}d&&e.addDefaultCase(d)})}return o.forEach(function(e){var n,r,a=s[e],i=t+"/"+e;"reducer"in a?(n=a.reducer,r=a.prepare):n=a,l[e]=n,c[i]=n,u[e]=r?Ue(i,r):Ue(i)}),{name:t,reducer:function(e,t){return n||(n=d()),n(e,t)},actions:u,caseReducers:l,getInitialState:function(){return n||(n=d()),n.getInitialState()}}}var Ge=function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},We=["name","message","stack","code"],Qe=function(e,t){this.payload=e,this.meta=t},Ke=function(e,t){this.payload=e,this.meta=t},Ye=function(e){if("object"===typeof e&&null!==e){for(var t={},n=0,r=We;n<r.length;n++){var a=r[n];"string"===typeof e[a]&&(t[a]=e[a])}return t}return{message:String(e)}};!function(){function e(e,t,n){var r=Ue(e+"/fulfilled",function(e,t,n,r){return{payload:e,meta:_e(je({},r||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})}}),a=Ue(e+"/pending",function(e,t,n){return{payload:void 0,meta:_e(je({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})}}),i=Ue(e+"/rejected",function(e,t,r,a,i){return{payload:a,error:(n&&n.serializeError||Ye)(e||"Rejected"),meta:_e(je({},i||{}),{arg:r,requestId:t,rejectedWithValue:!!a,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}}),s="undefined"!==typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){0},e}();return Object.assign(function(e){return function(o,l,c){var u,d=(null==n?void 0:n.idGenerator)?n.idGenerator(e):Ge(),h=new s;function p(e){u=e,h.abort()}var m=function(){return Pe(this,null,function(){var s,m,f,g,y,v;return Se(this,function(x){switch(x.label){case 0:return x.trys.push([0,4,,5]),g=null==(s=null==n?void 0:n.condition)?void 0:s.call(n,e,{getState:l,extra:c}),null===(b=g)||"object"!==typeof b||"function"!==typeof b.then?[3,2]:[4,g];case 1:g=x.sent(),x.label=2;case 2:if(!1===g||h.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return y=new Promise(function(e,t){return h.signal.addEventListener("abort",function(){return t({name:"AbortError",message:u||"Aborted"})})}),o(a(d,e,null==(m=null==n?void 0:n.getPendingMeta)?void 0:m.call(n,{requestId:d,arg:e},{getState:l,extra:c}))),[4,Promise.race([y,Promise.resolve(t(e,{dispatch:o,getState:l,extra:c,requestId:d,signal:h.signal,abort:p,rejectWithValue:function(e,t){return new Qe(e,t)},fulfillWithValue:function(e,t){return new Ke(e,t)}})).then(function(t){if(t instanceof Qe)throw t;return t instanceof Ke?r(t.payload,d,e,t.meta):r(t,d,e)})])];case 3:return f=x.sent(),[3,5];case 4:return v=x.sent(),f=v instanceof Qe?i(null,d,e,v.payload,v.meta):i(v,d,e),[3,5];case 5:return n&&!n.dispatchConditionRejection&&i.match(f)&&f.meta.condition||o(f),[2,f]}var b})})}();return Object.assign(m,{abort:p,requestId:d,arg:e,unwrap:function(){return m.then(Je)}})}},{pending:a,rejected:i,fulfilled:r,typePrefix:e})}e.withTypes=function(){return e}}();function Je(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var Xe=function(e,t){return Le(e)?e.match(t):e(t)};function Ze(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.some(function(e){return Xe(e,t)})}}function et(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.every(function(e){return Xe(e,t)})}}function tt(e,t){if(!e||!e.meta)return!1;var n="string"===typeof e.meta.requestId,r=t.indexOf(e.meta.requestStatus)>-1;return n&&r}function nt(e){return"function"===typeof e[0]&&"pending"in e[0]&&"fulfilled"in e[0]&&"rejected"in e[0]}function rt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?function(e){return tt(e,["rejected"])}:nt(e)?function(t){var n=e.map(function(e){return e.rejected});return Ze.apply(void 0,n)(t)}:rt()(e[0])}function at(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(e){return e&&e.meta&&e.meta.rejectedWithValue};return 0===e.length||nt(e)?function(t){return et(rt.apply(void 0,e),n)(t)}:at()(e[0])}Object.assign;var it="listenerMiddleware";Ue(it+"/add"),Ue(it+"/removeAll"),Ue(it+"/remove");"function"===typeof queueMicrotask&&queueMicrotask.bind("undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:globalThis);var st,ot=function(e){return function(t){setTimeout(t,e)}};"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:ot(10);D()},863:(e,t,n)=>{n(355)},876:(e,t,n)=>{var r=n(630),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return r.isMemo(e)?s:o[e.$$typeof]||a}o[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[r.Memo]=s;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,m=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(m){var a=p(n);a&&a!==m&&e(t,a,r)}var s=u(n);d&&(s=s.concat(d(n)));for(var o=l(t),f=l(n),g=0;g<s.length;++g){var y=s[g];if(!i[y]&&(!r||!r[y])&&(!f||!f[y])&&(!o||!o[y])){var v=h(n,y);try{c(t,y,v)}catch(x){}}}}return t}},940:(e,t,n)=>{var r=n(950),a=n(538);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=a.useSyncExternalStore,o=r.useRef,l=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var d=o(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=c(function(){function e(e){if(!l){if(l=!0,s=e,e=r(e),void 0!==a&&h.hasValue){var t=h.value;if(a(t,e))return o=t}return o=e}if(t=o,i(s,e))return t;var n=r(e);return void 0!==a&&a(t,n)?(s=e,t):(s=e,o=n)}var s,o,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,a]);var p=s(e,d[0],d[1]);return l(function(){h.hasValue=!0,h.value=p},[p]),u(p),p}},950:(e,t,n)=>{e.exports=n(49)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&r;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>s[e]=()=>r[e]);return s.default=()=>r,n.d(i,s),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r=n(950),a=n.t(r,2),i=n(352),s=n(774),o=n(9),l=n(421);const c={channels:[],messages:{},activeChannelId:null,unreadCounts:{},isConnected:!1,loading:!1,error:null,typingUsers:{}},u=(0,s.Z0)({name:"chat",initialState:c,reducers:{setChannels:(e,t)=>{try{const n=t.payload;if(!Array.isArray(n))throw new Error("Invalid channels: must be an array");const r=n.filter(e=>e&&e.channelId&&"string"===typeof e.channelId&&e.name&&"string"===typeof e.name);e.channels=r,r.forEach(t=>{t.channelId in e.unreadCounts||(e.unreadCounts[t.channelId]=0)}),e.error=null}catch(n){e.error=n instanceof Error?n.message:"Channel validation failed",e.channels=[]}},addChannel:(e,t)=>{try{const n=t.payload;if(!n||!n.channelId||!n.name)throw new Error("Invalid channel: missing required fields");const r=e.channels.findIndex(e=>e.channelId===n.channelId);r>=0?e.channels[r]=n:(e.channels.push(n),e.unreadCounts[n.channelId]=0),e.error=null}catch(n){e.error=n instanceof Error?n.message:"Channel addition failed"}},removeChannel:(e,t)=>{e.channels=e.channels.filter(e=>e.channelId!==t.payload),delete e.messages[t.payload],delete e.unreadCounts[t.payload],e.activeChannelId===t.payload&&(e.activeChannelId=e.channels.length>0?e.channels[0].channelId:null)},setMessages:(e,t)=>{try{const{channelId:n,messages:r}=t.payload;if(!n||"string"!==typeof n)throw new Error("Invalid channelId for messages");if(!Array.isArray(r))throw new Error("Invalid messages: must be an array");const a=r.filter(e=>e&&e.messageId&&e.content&&e.senderId&&e.timestamp);e.messages[n]=a,e.error=null}catch(n){e.error=n instanceof Error?n.message:"Message validation failed"}},addMessage:(e,t)=>{try{const n=t.payload;if(!n||!n.messageId||!n.channelId||!n.content)throw new Error("Invalid message: missing required fields");const r=n.channelId;e.messages[r]||(e.messages[r]=[]);const a=e.messages[r].findIndex(e=>e.messageId===n.messageId);a>=0?e.messages[r][a]=n:(e.messages[r].push(n),e.messages[r].sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime()),e.activeChannelId!==r&&(e.unreadCounts[r]=(e.unreadCounts[r]||0)+1)),e.error=null}catch(n){e.error=n instanceof Error?n.message:"Message addition failed"}},setActiveChannel:(e,t)=>{e.activeChannelId=t.payload,e.unreadCounts[t.payload]=0},markChannelAsRead:(e,t)=>{e.unreadCounts[t.payload]=0},setConnectionStatus:(e,t)=>{e.isConnected=t.payload},setLoading:(e,t)=>{e.loading=t.payload},setError:(e,t)=>{e.error=t.payload},setTypingUsers:(e,t)=>{const{channelId:n,userIds:r}=t.payload;e.typingUsers[n]=r},addTypingUser:(e,t)=>{const{channelId:n,userId:r}=t.payload;e.typingUsers[n]||(e.typingUsers[n]=[]),e.typingUsers[n].includes(r)||e.typingUsers[n].push(r)},removeTypingUser:(e,t)=>{const{channelId:n,userId:r}=t.payload;e.typingUsers[n]&&(e.typingUsers[n]=e.typingUsers[n].filter(e=>e!==r))},recoverChatState:(e,t)=>{try{const n=t.payload;if(Array.isArray(n.channels)){const t=n.channels.filter(e=>e&&e.channelId&&e.name);t.length>0&&(e.channels=t,t.forEach(t=>{t.channelId in e.unreadCounts||(e.unreadCounts[t.channelId]=0)}))}if(n.messages&&"object"===typeof n.messages)for(const[t,r]of Object.entries(n.messages))if(Array.isArray(r)){const n=r.filter(e=>e&&e.messageId&&e.content&&e.senderId);n.length>0&&(e.messages[t]=n)}if(n.unreadCounts&&"object"===typeof n.unreadCounts)for(const[t,r]of Object.entries(n.unreadCounts))"number"===typeof r&&r>=0&&(e.unreadCounts[t]=r);n.activeChannelId&&e.channels.find(e=>e.channelId===n.activeChannelId)&&(e.activeChannelId=n.activeChannelId),"boolean"===typeof n.isConnected&&(e.isConnected=n.isConnected),e.loading=!1,e.error=null}catch(n){Object.assign(e,c),e.error="Chat state recovery failed"}}}}),{setChannels:d,addChannel:h,removeChannel:p,setMessages:m,addMessage:f,setActiveChannel:g,markChannelAsRead:y,setConnectionStatus:v,setLoading:x,setError:b,setTypingUsers:E,addTypingUser:S,removeTypingUser:w,recoverChatState:N}=u.actions,k=u.reducer,C="auth/clearError",I="game/setError",A="chat/setError",T=e=>t=>n=>{try{const o=t(n);if((0,s.WA)(n)||n.type.endsWith("/rejected")&&n.payload){var r,a,i;const t=e.getState(),s={timestamp:(new Date).toISOString(),action:n.type,error:(null===(r=n.payload)||void 0===r?void 0:r.message)||(null===(a=n.error)||void 0===a?void 0:a.message)||"Unknown error",state:{auth:{error:t.auth.error,loading:t.auth.loading,isAuthenticated:t.auth.isAuthenticated,user:t.auth.user,tokens:t.auth.tokens},game:{error:t.game.error,loading:t.game.loading,character:t.game.character,hasCharacter:t.game.hasCharacter,characterLoading:t.game.characterLoading,activityProgress:t.game.activityProgress,isOnline:t.game.isOnline,lastSyncTime:t.game.lastSyncTime,activitySwitching:t.game.activitySwitching},chat:{error:t.chat.error,loading:t.chat.loading,channels:t.chat.channels,messages:t.chat.messages,activeChannelId:t.chat.activeChannelId,unreadCounts:t.chat.unreadCounts,isConnected:t.chat.isConnected,typingUsers:t.chat.typingUsers}},userId:null===(i=t.auth.user)||void 0===i?void 0:i.userId};console.error("Redux Error:",s),function(e,t){var n,r;const a=t.type,i=(null===(n=t.payload)||void 0===n?void 0:n.message)||(null===(r=t.error)||void 0===r?void 0:r.message)||"";a.includes("auth/")&&i.includes("token")&&setTimeout(()=>{e.dispatch({type:C})},5e3);(i.includes("network")||i.includes("fetch"))&&(e.dispatch({type:"game/setOnlineStatus",payload:!1}),setTimeout(()=>{e.dispatch({type:"game/setOnlineStatus",payload:!0})},1e4));(i.includes("state")||i.includes("invalid"))&&(a.includes("game/")?e.dispatch({type:I,payload:null}):a.includes("chat/")&&e.dispatch({type:A,payload:null}))}(e,n)}return o}catch(o){return console.error("Error in errorLoggingMiddleware:",o),t(n)}};const R=e=>t=>n=>{const r=t(n);try{const t=e.getState();!function(e){if(e.isAuthenticated&&!e.user)throw new Error("Invalid auth state: authenticated but no user data");if(e.isAuthenticated&&!e.tokens)throw new Error("Invalid auth state: authenticated but no tokens");if(e.tokens){const t=["accessToken","idToken","refreshToken"];for(const n of t)if(!e.tokens[n])throw new Error(`Invalid auth state: missing ${n}`)}if(e.user&&(!e.user.userId||!e.user.email))throw new Error("Invalid auth state: incomplete user data")}(t.auth),function(e){if(!0===e.hasCharacter&&!e.character)throw new Error("Invalid game state: hasCharacter is true but no character data");if(e.character){const t=["characterId","name","level","experience","currency"];for(const n of t)if(void 0===e.character[n]||null===e.character[n])throw new Error(`Invalid game state: character missing ${n}`);if("number"!==typeof e.character.level||e.character.level<1)throw new Error("Invalid game state: character level must be a positive number");if("number"!==typeof e.character.experience||e.character.experience<0)throw new Error("Invalid game state: character experience must be a non-negative number");if("number"!==typeof e.character.currency||e.character.currency<0)throw new Error("Invalid game state: character currency must be a non-negative number")}}(t.game),function(e){if(!Array.isArray(e.channels))throw new Error("Invalid chat state: channels must be an array");if("object"!==typeof e.messages||null===e.messages)throw new Error("Invalid chat state: messages must be an object");if("object"!==typeof e.unreadCounts||null===e.unreadCounts)throw new Error("Invalid chat state: unreadCounts must be an object");if(e.activeChannelId&&!e.channels.find(t=>t.channelId===e.activeChannelId))throw new Error("Invalid chat state: activeChannelId references non-existent channel")}(t.chat)}catch(a){if(console.error("State validation error:",a),a instanceof Error){const t=a.message;t.includes("auth")?e.dispatch({type:"auth/logout"}):t.includes("game")?e.dispatch({type:"game/setError",payload:"Game state corrupted, please refresh"}):t.includes("chat")&&e.dispatch({type:"chat/setError",payload:"Chat state corrupted, reconnecting..."})}}return r};const j=(0,s.U1)({reducer:{auth:o.Ay,game:l.Ay,chat:k},middleware:e=>e({serializableCheck:{ignoredActions:["persist/PERSIST"],ignoredActionsPaths:["payload.lastActiveAt","payload.createdAt","payload.currentActivity.startedAt"],ignoredPaths:["game.character.lastActiveAt","game.character.createdAt","game.character.currentActivity.startedAt"]}}).concat(T).concat(R)});function _(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var P,O=function e(t,n){function r(e,r,a){if("undefined"!==typeof document){"number"===typeof(a=_({},n,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var s in a)a[s]&&(i+="; "+s,!0!==a[s]&&(i+="="+a[s].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+i}}return Object.create({set:r,get:function(e){if("undefined"!==typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},a=0;a<n.length;a++){var i=n[a].split("="),s=i.slice(1).join("=");try{var o=decodeURIComponent(i[0]);if(r[o]=t.read(s,o),e===o)break}catch(l){}}return e?r[e]:r}},remove:function(e,t){r(e,"",_({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,_({},this.attributes,t))},withConverter:function(t){return e(_({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});class M{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{path:t,domain:n,expires:r,sameSite:a,secure:i}=e;if(this.domain=n,this.path=t||"/",this.expires=Object.prototype.hasOwnProperty.call(e,"expires")?r:365,this.secure=!Object.prototype.hasOwnProperty.call(e,"secure")||i,Object.prototype.hasOwnProperty.call(e,"sameSite")){if(!a||!["strict","lax","none"].includes(a))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if("none"===a&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=a}}async setItem(e,t){O.set(e,t,this.getData())}async getItem(e){return O.get(e)??null}async removeItem(e){O.remove(e,this.getData())}async clear(){const e=O.get(),t=Object.keys(e).map(e=>this.removeItem(e));await Promise.all(t)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}!function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"}(P||(P={}));class L extends Error{constructor(e){let{message:t,name:n,recoverySuggestion:r,underlyingError:a,metadata:i}=e;if(super(t),this.name=n,this.underlyingError=a,this.recoverySuggestion=r,i){const{extendedRequestId:e,httpStatusCode:t,requestId:n}=i;this.metadata={extendedRequestId:e,httpStatusCode:t,requestId:n}}this.constructor=L,Object.setPrototypeOf(this,L.prototype)}}class U extends L{constructor(){super({name:P.PlatformNotSupported,message:"Function not supported on current platform"})}}class D{constructor(e){this.storage=e}async setItem(e,t){if(!this.storage)throw new U;this.storage.setItem(e,t)}async getItem(e){if(!this.storage)throw new U;return this.storage.getItem(e)}async removeItem(e){if(!this.storage)throw new U;this.storage.removeItem(e)}async clear(){if(!this.storage)throw new U;this.storage.clear()}}var q;!function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"}(q||(q={}));const F={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class ${constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:q.WARN;this.name=e,this.level=t,this._pluggables=[]}_padding(e){return e<10?"0"+e:""+e}_ts(){const e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()}configure(e){return e?(this._config=e,this._config):this._config}_log(e){let t=this.level;$.LOG_LEVEL&&(t=$.LOG_LEVEL),"undefined"!==typeof window&&window.LOG_LEVEL&&(t=window.LOG_LEVEL);if(!(F[e]>=F[t]))return;let n=console.log.bind(console);e===q.ERROR&&console.error&&(n=console.error.bind(console)),e===q.WARN&&console.warn&&(n=console.warn.bind(console)),$.BIND_ALL_LOG_LEVELS&&(e===q.INFO&&console.info&&(n=console.info.bind(console)),e===q.DEBUG&&console.debug&&(n=console.debug.bind(console)));const r=`[${e}] ${this._ts()} ${this.name}`;let a="";for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(1===s.length&&"string"===typeof s[0])a=`${r} - ${s[0]}`,n(a);else if(1===s.length)a=`${r} ${s[0]}`,n(r,s[0]);else if("string"===typeof s[0]){let e=s.slice(1);1===e.length&&(e=e[0]),a=`${r} - ${s[0]} ${e}`,n(`${r} - ${s[0]}`,e)}else a=`${r} ${s}`,n(r,s);for(const l of this._pluggables){const e={message:a,timestamp:Date.now()};l.pushLogs([e])}}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log(q.INFO,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log(q.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log(q.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log(q.ERROR,...t)}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log(q.DEBUG,...t)}verbose(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log(q.VERBOSE,...t)}addPluggable(e){e&&"Logging"===e.getCategoryName()&&(this._pluggables.push(e),e.configure(this._config))}listPluggables(){return this._pluggables}}$.LOG_LEVEL=null,$.BIND_ALL_LOG_LEVELS=!1;class B{constructor(){this.storage=new Map}get length(){return this.storage.size}key(e){return e>this.length-1?null:Array.from(this.storage.keys())[e]}setItem(e,t){this.storage.set(e,t)}getItem(e){return this.storage.get(e)??null}removeItem(e){this.storage.delete(e)}clear(){this.storage.clear()}}const z=new $("CoreStorageUtils"),V=()=>{try{if("undefined"!==typeof window&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch(e){return z.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new B}};class H{constructor(e){this._storage=e}get storage(){if(!this._storage)throw new U;return this._storage}setItem(e,t){this.storage.setItem(e,t)}getItem(e){return this.storage.getItem(e)}removeItem(e){this.storage.removeItem(e)}clear(){this.storage.clear()}}const G=new class extends D{constructor(){super((()=>{try{if("undefined"!==typeof window&&window.localStorage)return window.localStorage}catch(e){z.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new B})())}},W=(new class extends D{constructor(){super(V())}},new class extends H{constructor(){super(V())}}),Q=(new D(new B),"undefined"!==typeof Symbol?Symbol("amplify_default"):"@@amplify_default"),K=new $("Hub");class Y{constructor(e){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=e}_remove(e,t){const n=this.listeners.get(e);n?this.listeners.set(e,[...n.filter(e=>{let{callback:n}=e;return n!==t})]):K.warn(`No listeners for ${e}`)}dispatch(e,t,n,r){if("string"===typeof e&&this.protectedChannels.indexOf(e)>-1){r===Q||K.warn(`WARNING: ${e} is protected and dispatching on it can have unintended consequences`)}const a={channel:e,payload:{...t},source:n,patternInfo:[]};try{this._toListeners(a)}catch(i){K.error(i)}}listen(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"noname";if("function"!==typeof t)throw new L({name:"NoHubcallbackProvidedException",message:"No callback supplied to Hub"});n=t;let a=this.listeners.get(e);return a||(a=[],this.listeners.set(e,a)),a.push({name:r,callback:n}),()=>{this._remove(e,n)}}_toListeners(e){const{channel:t,payload:n}=e,r=this.listeners.get(t);r&&r.forEach(r=>{K.debug(`Dispatching to ${t} with `,n);try{r.callback(e)}catch(a){K.error(a)}})}}const J=new Y("__default__"),X=new Y("internal-hub"),Z=e=>{const t=Reflect.ownKeys(e);for(const n of t){const t=e[n];(t&&"object"===typeof t||"function"===typeof t)&&Z(t)}return Object.freeze(e)},ee=Symbol("oauth-listener"),te=new $("parseAWSExports"),ne={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},re=e=>e?.split(",")??[],ae=e=>{let{domain:t,scope:n,redirectSignIn:r,redirectSignOut:a,responseType:i}=e;return{domain:t,scopes:n,redirectSignIn:re(r),redirectSignOut:re(a),responseType:i}},ie=e=>e.map(e=>{const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)});function se(e){const t={};if(e.storage&&(t.Storage=function(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:r}=e;return{S3:{bucket:t,region:n,buckets:r&&he(r)}}}(e.storage)),e.auth&&(t.Auth=function(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:r,password_policy:a,mfa_configuration:i,mfa_methods:s,unauthenticated_identities_enabled:o,oauth:l,username_attributes:c,standard_required_attributes:u,groups:d}=e,h={Cognito:{userPoolId:t,userPoolClientId:n,groups:d}};return r&&(h.Cognito={...h.Cognito,identityPoolId:r}),a&&(h.Cognito.passwordFormat={requireLowercase:a.require_lowercase,requireNumbers:a.require_numbers,requireUppercase:a.require_uppercase,requireSpecialCharacters:a.require_symbols,minLength:a.min_length??6}),i&&(h.Cognito.mfa={status:de(i),smsEnabled:s?.includes("SMS"),totpEnabled:s?.includes("TOTP")}),o&&(h.Cognito.allowGuestAccess=o),l&&(h.Cognito.loginWith={oauth:{domain:l.domain,redirectSignIn:l.redirect_sign_in_uri,redirectSignOut:l.redirect_sign_out_uri,responseType:"token"===l.response_type?"token":"code",scopes:l.scopes,providers:ue(l.identity_providers)}}),c&&(h.Cognito.loginWith={...h.Cognito.loginWith,email:c.includes("email"),phone:c.includes("phone_number"),username:c.includes("username")}),u&&(h.Cognito.userAttributes=u.reduce((e,t)=>({...e,[t]:{required:!0}}),{})),h}(e.auth)),e.analytics&&(t.Analytics=function(e){if(!e?.amazon_pinpoint)return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}(e.analytics)),e.geo&&(t.Geo=function(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:r,search_indices:a}=e;return{LocationService:{region:t,searchIndices:a,geofenceCollections:n,maps:r}}}(e.geo)),e.data&&(t.API=function(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:r,api_key:a,model_introspection:i}=e;return{GraphQL:{endpoint:r,defaultAuthMode:le(n),region:t,apiKey:a,modelIntrospection:i}}}(e.data)),e.custom){const n=function(e){if(!e?.events)return;const{url:t,aws_region:n,api_key:r,default_authorization_type:a}=e.events;return{Events:{endpoint:t,defaultAuthMode:le(a),region:n,apiKey:r}}}(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=function(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:r}=e,a=n.includes("IN_APP_MESSAGING"),i=n.includes("APNS")||n.includes("FCM");if(!a&&!i)return;const s={};return a&&(s.InAppMessaging={Pinpoint:{appId:r,region:t}}),i&&(s.PushNotification={Pinpoint:{appId:r,region:t}}),s}(e.notifications)),t}const oe={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function le(e){return oe[e]}const ce={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function ue(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((e,t)=>(void 0!==ce[t]&&e.push(ce[t]),e),[])}function de(e){return"OPTIONAL"===e?"optional":"REQUIRED"===e?"on":"off"}function he(e){const t={};return e.forEach(e=>{let{name:n,bucket_name:r,aws_region:a,paths:i}=e;if(n in t)throw new Error(`Duplicate friendly name found: ${n}. Name must be unique.`);const s=i?Object.entries(i).reduce((e,t)=>{let[n,r]=t;return void 0!==r&&(e[n]=r),e},{}):void 0;t[n]={bucketName:r,region:a,paths:s}}),t}const pe=e=>Object.keys(e).some(e=>e.startsWith("aws_"))?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new L({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:r,aws_appsync_region:a,aws_bots_config:i,aws_cognito_identity_pool_id:s,aws_cognito_sign_up_verification_method:o,aws_cognito_mfa_configuration:l,aws_cognito_mfa_types:c,aws_cognito_password_protection_settings:u,aws_cognito_verification_mechanisms:d,aws_cognito_signup_attributes:h,aws_cognito_social_providers:p,aws_cognito_username_attributes:m,aws_mandatory_sign_in:f,aws_mobile_analytics_app_id:g,aws_mobile_analytics_app_region:y,aws_user_files_s3_bucket:v,aws_user_files_s3_bucket_region:x,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:b,aws_user_pools_id:E,aws_user_pools_web_client_id:S,geo:w,oauth:N,predictions:k,aws_cloud_logic_custom:C,Notifications:I,modelIntrospection:A}=e,T={};g&&(T.Analytics={Pinpoint:{appId:g,region:y}});const{InAppMessaging:R,Push:j}=I??{};if(R?.AWSPinpoint||j?.AWSPinpoint){if(R?.AWSPinpoint){const{appId:e,region:t}=R.AWSPinpoint;T.Notifications={InAppMessaging:{Pinpoint:{appId:e,region:t}}}}if(j?.AWSPinpoint){const{appId:e,region:t}=j.AWSPinpoint;T.Notifications={...T.Notifications,PushNotification:{Pinpoint:{appId:e,region:t}}}}}if(Array.isArray(i)&&(T.Interactions={LexV1:Object.fromEntries(i.map(e=>[e.name,e]))}),r){const e=ne[n];e||te.debug(`Invalid authentication type ${n}. Falling back to IAM.`),T.API={GraphQL:{endpoint:r,apiKey:t,region:a,defaultAuthMode:e??"iam"}},A&&(T.API.GraphQL.modelIntrospection=A)}const _=l?{status:l&&l.toLowerCase(),totpEnabled:c?.includes("TOTP")??!1,smsEnabled:c?.includes("SMS")??!1}:void 0,P=u?{minLength:u.passwordPolicyMinLength,requireLowercase:u.passwordPolicyCharacters?.includes("REQUIRES_LOWERCASE")??!1,requireUppercase:u.passwordPolicyCharacters?.includes("REQUIRES_UPPERCASE")??!1,requireNumbers:u.passwordPolicyCharacters?.includes("REQUIRES_NUMBERS")??!1,requireSpecialCharacters:u.passwordPolicyCharacters?.includes("REQUIRES_SYMBOLS")??!1}:void 0,O=Array.from(new Set([...d??[],...h??[]])).reduce((e,t)=>({...e,[t.toLowerCase()]:{required:!0}}),{}),M=m?.includes("EMAIL")??!1,U=m?.includes("PHONE_NUMBER")??!1;(s||E)&&(T.Auth={Cognito:{identityPoolId:s,allowGuestAccess:"enable"!==f,signUpVerificationMethod:o,userAttributes:O,userPoolClientId:S,userPoolId:E,mfa:_,passwordFormat:P,loginWith:{username:!(M||U),email:M,phone:U}}});const D=!!N&&Object.keys(N).length>0,q=!!p&&p.length>0;if(T.Auth&&D&&(T.Auth.Cognito.loginWith={...T.Auth.Cognito.loginWith,oauth:{...ae(N),...q&&{providers:ie(p)}}}),v&&(T.Storage={S3:{bucket:v,region:x,dangerouslyConnectToHttpEndpointForTesting:b}}),w){const{amazon_location_service:e}=w;T.Geo={LocationService:{maps:e.maps,geofenceCollections:e.geofenceCollections,searchIndices:e.search_indices,region:e.region}}}if(C&&(T.API={...T.API,REST:C.reduce((e,t)=>{const{name:n,endpoint:r,region:a,service:i}=t;return{...e,[n]:{endpoint:r,...i?{service:i}:void 0,...a?{region:a}:void 0}}},{})}),k){const{VoiceId:e}=k?.convert?.speechGenerator?.defaults??{};T.Predictions=e?{...k,convert:{...k.convert,speechGenerator:{...k.convert.speechGenerator,defaults:{voiceId:e}}}}:k}return T}(e):function(e){const{version:t}=e;return!!t&&t.startsWith("1")}(e)?se(e):e;function me(e,t,n,r){return new(n||(n=Promise))(function(a,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,o)}l((r=r.apply(e,t||[])).next())})}function fe(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(l){o=[6,l],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var ge=64,ye=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ve=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],xe=Math.pow(2,53)-1,be=function(){function e(){this.state=Int32Array.from(ve),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>xe)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===ge&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%ge>=56){for(var r=this.bufferLength;r<ge;r++)t.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(r=this.bufferLength;r<56;r++)t.setUint8(r,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var a=new Uint8Array(32);for(r=0;r<8;r++)a[4*r]=this.state[r]>>>24&255,a[4*r+1]=this.state[r]>>>16&255,a[4*r+2]=this.state[r]>>>8&255,a[4*r+3]=this.state[r]>>>0&255;return a},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],r=t[1],a=t[2],i=t[3],s=t[4],o=t[5],l=t[6],c=t[7],u=0;u<ge;u++){if(u<16)this.temp[u]=(255&e[4*u])<<24|(255&e[4*u+1])<<16|(255&e[4*u+2])<<8|255&e[4*u+3];else{var d=this.temp[u-2],h=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,p=((d=this.temp[u-15])>>>7|d<<25)^(d>>>18|d<<14)^d>>>3;this.temp[u]=(h+this.temp[u-7]|0)+(p+this.temp[u-16]|0)}var m=(((s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7))+(s&o^~s&l)|0)+(c+(ye[u]+this.temp[u]|0)|0)|0,f=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&r^n&a^r&a)|0;c=l,l=o,o=s,s=i+m|0,i=a,a=r,r=n,n=m+f|0}t[0]+=n,t[1]+=r,t[2]+=a,t[3]+=i,t[4]+=s,t[5]+=o,t[6]+=l,t[7]+=c},e}();var Ee="undefined"!==typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function Se(e){return e instanceof Uint8Array?e:"string"===typeof e?Ee(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var we=function(){function e(e){this.secret=e,this.hash=new be,this.reset()}return e.prototype.update=function(e){if(!function(e){return"string"===typeof e?0===e.length:0===e.byteLength}(e)&&!this.error)try{this.hash.update(Se(e))}catch(t){this.error=t}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return me(this,void 0,void 0,function(){return fe(this,function(e){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new be,this.secret){this.outer=new be;var e=function(e){var t=Se(e);if(t.byteLength>ge){var n=new be;n.update(t),t=n.digest()}var r=new Uint8Array(ge);return r.set(t),r}(this.secret),t=new Uint8Array(ge);t.set(e);for(var n=0;n<ge;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(n=0;n<e.byteLength;n++)e[n]=0}},e}();const Ne={},ke={};for(let Kl=0;Kl<256;Kl++){let e=Kl.toString(16).toLowerCase();1===e.length&&(e=`0${e}`),Ne[Kl]=e,ke[e]=Kl}const Ce=new $("Auth");class Ie{configure(e,t){this.authConfig=e,this.authOptions=t,e&&e.Cognito?.userPoolEndpoint&&Ce.warn(Ae("Amazon Cognito User Pool")),e&&e.Cognito?.identityPoolEndpoint&&Ce.warn(Ae("Amazon Cognito Identity Pool"))}async fetchAuthSession(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=await this.getTokens(n);return r?(t=r.accessToken?.payload?.sub,e=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:r,authenticated:!0,forceRefresh:n.forceRefresh}))):e=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:n.forceRefresh})),{tokens:r,credentials:e?.credentials,identityId:e?.identityId,userSub:t}}async clearCredentials(){await(this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId())}async getTokens(e){return await(this.authOptions?.tokenProvider?.getTokens(e))??void 0}}const Ae=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;const Te=new class{constructor(){this.oAuthListener=void 0,this.isConfigured=!1,this.resourcesConfig={},this.libraryOptions={},this.Auth=new Ie}configure(e,t){const n=pe(e);this.resourcesConfig=n,t&&(this.libraryOptions=t),this.resourcesConfig=Z(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),J.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",Q),this.notifyOAuthListener(),this.isConfigured=!0}getConfig(){return this.isConfigured||console.warn("Amplify has not been configured. Please call Amplify.configure() before using this service."),this.resourcesConfig}[ee](e){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth?e(this.resourcesConfig.Auth?.Cognito):this.oAuthListener=e}notifyOAuthListener(){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth&&this.oAuthListener&&(this.oAuthListener(this.resourcesConfig.Auth?.Cognito),this.oAuthListener=void 0)}};var Re,je,_e,Pe,Oe,Me,Le,Ue,De,qe,Fe,$e,Be,ze;!function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"}(Re||(Re={})),function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"}(je||(je={})),function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"}(_e||(_e={})),function(e){e.Record="1",e.IdentifyUser="2"}(Pe||(Pe={})),function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"}(Oe||(Oe={})),function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"}(Me||(Me={})),function(e){e.Subscribe="1",e.GraphQl="2"}(Le||(Le={})),function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"}(Ue||(Ue={})),function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"}(De||(De={})),function(e){e.None="0"}(qe||(qe={})),function(e){e.Convert="1",e.Identify="2",e.Interpret="3"}(Fe||(Fe={})),function(e){e.Subscribe="1"}($e||($e={})),function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"}(Be||(Be={})),function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"}(ze||(ze={}));const Ve="6.15.3",He=()=>"undefined"!==typeof global,Ge=()=>"undefined"!==typeof window,We=()=>"undefined"!==typeof document,Qe=()=>"undefined"!==typeof process,Ke=(e,t)=>!!Object.keys(e).find(e=>e.startsWith(t));const Ye=[{platform:Re.Expo,detectionMethod:function(){return He()&&"undefined"!==typeof global.expo}},{platform:Re.ReactNative,detectionMethod:function(){return"undefined"!==typeof navigator&&"undefined"!==typeof navigator.product&&"ReactNative"===navigator.product}},{platform:Re.NextJs,detectionMethod:function(){return Ge()&&window.next&&"object"===typeof window.next}},{platform:Re.Nuxt,detectionMethod:function(){return Ge()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:Re.Angular,detectionMethod:function(){const e=Boolean(We()&&document.querySelector("[ng-version]")),t=Boolean(Ge()&&"undefined"!==typeof window.ng);return e||t}},{platform:Re.React,detectionMethod:function(){const e=e=>e.startsWith("_react")||e.startsWith("__react");return We()&&Array.from(document.querySelectorAll("[id]")).some(t=>Object.keys(t).find(e))}},{platform:Re.VueJs,detectionMethod:function(){return Ge()&&Ke(window,"__VUE")}},{platform:Re.Svelte,detectionMethod:function(){return Ge()&&Ke(window,"__SVELTE")}},{platform:Re.WebUnknown,detectionMethod:function(){return Ge()}},{platform:Re.NextJsSSR,detectionMethod:function(){return He()&&(Ke(global,"__next")||Ke(global,"__NEXT"))}},{platform:Re.NuxtSSR,detectionMethod:function(){return He()&&"undefined"!==typeof global.__NUXT_PATHS__}},{platform:Re.ReactSSR,detectionMethod:function(){return Qe()&&!!Object.keys({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}).find(e=>e.includes("react"))}},{platform:Re.VueJsSSR,detectionMethod:function(){return He()&&Ke(global,"__VUE")}},{platform:Re.AngularSSR,detectionMethod:function(){return Qe()&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:Re.SvelteSSR,detectionMethod:function(){return Qe()&&!!Object.keys({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}).find(e=>e.includes("svelte"))}}];let Je;const Xe=[];let Ze=!1;const et=()=>{if(!Je){if(Je=Ye.find(e=>e.detectionMethod())?.platform||Re.ServerSideUnknown,Ze)for(;Xe.length;)Xe.pop()?.();else Xe.forEach(e=>{e()});tt(Re.ServerSideUnknown,10),tt(Re.WebUnknown,10)}return Je};function tt(e,t){Je!==e||Ze||setTimeout(()=>{Je=void 0,Ze=!0,setTimeout(et,1e3)},t)}const nt={},rt="aws-amplify",at=e=>e.replace(/\+.*/,"");new class{constructor(){this.userAgent=`${rt}/${at(Ve)}`}get framework(){return et()}get isReactNative(){return this.framework===Re.ReactNative||this.framework===Re.Expo}observeFrameworkChanges(e){(e=>{Ze||Xe.push(e)})(e)}};const it=function(){let{category:e,action:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=[[rt,at(Ve)]];if(e&&n.push([e,t]),n.push(["framework",et()]),e&&t){const r=((e,t)=>nt[e]?.[t]?.additionalDetails)(e,t);r&&r.forEach(e=>{n.push(e)})}return n},st=e=>it(e).map(e=>{let[t,n]=e;return t&&n?`${t}/${n}`:t}).join(" "),ot=e=>{const{headers:t,statusCode:n}=e;return{...lt(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},lt=e=>"object"===typeof e?.$metadata,ct=async e=>{if(!e||e.statusCode<300)return;const t=await ut(e),n=(e=>{const[t]=e.toString().split(/[,:]+/);return t.includes("#")?t.split("#")[1]:t})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),r=t.message??t.Message??"Unknown error",a=new Error(r);return Object.assign(a,{name:n,$metadata:ot(e)})},ut=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:ot(e)})},dt=(e,t,n,r)=>async(a,i)=>{const s={...r,...a},o=await s.endpointResolver(s,i),l=await t(i,o),c=await e(l,{...s});return n(c)};const ht=3,pt="amz-sdk-invocation-id",mt=3e5,ft=e=>{const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e5;return t=>{const n=2**t*100+100*Math.random();return!(n>e)&&n}}(mt),n=t(e);return!1===n?mt:n},gt=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],yt=e=>async(t,n)=>{const r=n??await e(t)??void 0,a=r?.code||r?.name,i=t?.statusCode;return{retryable:Et(n)||bt(i,a)||(e=>!!e&&gt.includes(e))(a)||St(i,a)}},vt=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],xt=["TimeoutError","RequestTimeout","RequestTimeoutException"],bt=(e,t)=>429===e||!!t&&vt.includes(t),Et=e=>[P.NetworkError,"ERR_NETWORK"].includes(e?.name),St=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&xt.includes(t),wt="cognito-identity",Nt={service:wt,retryDecider:yt(ct),computeDelay:ft,cache:"no-store"},kt=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,r;const a=new Promise(t=>{r=t,n=setTimeout(t,e)});return t?.addEventListener("abort",function e(a){clearTimeout(n),t?.removeEventListener("abort",e),r()}),a},Ct=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},It={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let At;const Tt=new Uint8Array(16);const Rt=[];for(let Kl=0;Kl<256;++Kl)Rt.push((Kl+256).toString(16).slice(1));function jt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(Rt[e[t+0]]+Rt[e[t+1]]+Rt[e[t+2]]+Rt[e[t+3]]+"-"+Rt[e[t+4]]+Rt[e[t+5]]+"-"+Rt[e[t+6]]+Rt[e[t+7]]+"-"+Rt[e[t+8]]+Rt[e[t+9]]+"-"+Rt[e[t+10]]+Rt[e[t+11]]+Rt[e[t+12]]+Rt[e[t+13]]+Rt[e[t+14]]+Rt[e[t+15]]).toLowerCase()}const _t=function(e,t,n){if(It.randomUUID&&!t&&!e)return It.randomUUID();const r=(e=e||{}).random??e.rng?.()??function(){if(!At){if("undefined"===typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");At=crypto.getRandomValues.bind(crypto)}return At(Tt)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return jt(r)},Pt=(e,t)=>(n,r)=>{const a={};let i=t=>e(t,r);for(let e=t.length-1;e>=0;e--){i=(0,t[e])(r)(i,a)}return i(n)},Ot=e=>{let t;return()=>(t||(t=e()),t)},Mt=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),Lt=Pt(async(e,t)=>{let n,{url:r,method:a,headers:i,body:s}=e,{abortSignal:o,cache:l,withCrossDomainCredentials:c}=t;try{n=await fetch(r,{method:a,headers:i,body:Mt(a)?s:void 0,signal:o,cache:l,credentials:c?"include":"same-origin"})}catch(d){if(d instanceof TypeError)throw new L({name:P.NetworkError,message:"A network error has occurred.",underlyingError:d});throw d}const u={};n.headers?.forEach((e,t)=>{u[t.toLowerCase()]=e});return{...{statusCode:n.status,headers:u,body:null},body:Object.assign(n.body??{},{text:Ot(()=>n.text()),blob:Ot(()=>n.blob()),json:Ot(()=>n.json())})}},[e=>{let{userAgentHeader:t="x-amz-user-agent",userAgentValue:n=""}=e;return e=>async function(r){if(0===n.trim().length){return await e(r)}{const a=t.toLowerCase();r.headers[a]=r.headers[a]?`${r.headers[a]} ${n}`:n;return await e(r)}}},()=>e=>async function(t){return t.headers[pt]||(t.headers[pt]=_t()),e(t)},e=>{let{maxAttempts:t=ht,retryDecider:n,computeDelay:r,abortSignal:a}=e;if(t<1)throw new Error("maxAttempts must be greater than 0");return(e,i)=>async function(s){let o,l,c=i.attemptsCount??0;const u=()=>{if(l)return Ct(l,c),l;throw Ct(o,c),o};for(;!a?.aborted&&c<t;){try{l=await e(s),o=void 0}catch(d){o=d,l=void 0}c=(i.attemptsCount??0)>c?i.attemptsCount??0:c+1,i.attemptsCount=c;const{isCredentialsExpiredError:h,retryable:p}=await n(l,o,i);if(!p)return u();if(i.isCredentialsExpired=!!h,!a?.aborted&&c<t){const e=r(c);await kt(e,a)}}if(a?.aborted)throw new Error("Request aborted.");return u()}},e=>{let{maxAttempts:t=ht}=e;return(e,n)=>async function(r){const a=n.attemptsCount??0;return r.headers["amz-sdk-request"]=`attempt=${a+1}; max=${t}`,e(r)}}]),Ut=Pt(Lt,[()=>e=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),Dt=e=>(t,n)=>{const r=qt(e),a=JSON.stringify(t);return Ft(n,r,a)},qt=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),Ft=(e,t,n)=>{let{url:r}=e;return{headers:t,url:r,body:n,method:"POST"}},$t=e=>dt(Ut,Dt("GetCredentialsForIdentity"),Bt,{...Nt,...e,userAgentValue:st()}),Bt=async e=>{if(e.statusCode>=300){throw await ct(e)}const t=await ut(e);return{IdentityId:t.IdentityId,Credentials:zt(t.Credentials),$metadata:ot(e)}},zt=function(){let{Expiration:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...t,Expiration:e&&new Date(1e3*e)}},Vt=()=>{if("object"===typeof window&&"object"===typeof window.crypto)return window.crypto;if("object"===typeof crypto)return crypto;throw new L({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},Ht={convert(e,t){let n=e;return t?.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),(()=>{if("undefined"!==typeof window&&"function"===typeof window.atob)return window.atob;if("function"===typeof atob)return atob;throw new L({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})})()(n)}},Gt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L;return(n,r,a)=>{const{message:i,recoverySuggestion:s}=e[r];if(!n)throw new t({name:r,message:a?`${i} ${a}`:i,recoverySuggestion:s})}};var Wt;!function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"}(Wt||(Wt={}));const Qt=Gt({[Wt.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[Wt.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[Wt.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[Wt.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[Wt.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}});function Kt(e){let t=!0;t=!!e&&(!!e.userPoolId&&!!e.userPoolClientId),Qt(t,Wt.AuthUserPoolException)}function Yt(e){Qt(!!e?.loginWith?.oauth?.domain&&!!e?.loginWith?.oauth?.redirectSignOut&&!!e?.loginWith?.oauth?.redirectSignIn&&!!e?.loginWith?.oauth?.responseType,Wt.OAuthNotConfigureException)}function Jt(e){Qt(!!e?.identityPoolId,Wt.InvalidIdentityPoolIdException)}function Xt(e){const t=e.split(".");if(3!==t.length)throw new Error("Invalid token");try{const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(Ht.convert(n).split("").map(e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));return{toString:()=>e,payload:JSON.parse(r)}}catch(n){throw new Error("Invalid token payload")}}class Zt extends L{constructor(e){super(e),this.constructor=Zt,Object.setPrototypeOf(this,Zt.prototype)}}function en(e){if(!e||"Error"===e.name||e instanceof TypeError)throw new Zt({name:P.Unknown,message:"An unknown error has occurred.",underlyingError:e})}function tn(e){const t=e?.split("_")[0];if(!e||e.indexOf("_")<0||!t||"string"!==typeof t)throw new Zt({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function nn(e){if(!e||!e.includes(":"))throw new Zt({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}const rn="UserUnAuthenticatedException",an="AutoSignInException",sn=new Zt({name:"InvalidRedirectException",message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."}),on=(new Zt({name:"InvalidAppSchemeException",message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."}),new Zt({name:"InvalidPreferredRedirectUrlException",message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."})),ln=new Zt({name:"InvalidOriginException",message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."});function cn(e){if(!e||!e.accessToken)throw new Zt({name:rn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const un=new Zt({name:"TokenRefreshException",message:"Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. \n\tPlease change your oauth configuration to use 'code grant' flow.",recoverySuggestion:"Please logout and change your Amplify configuration to use \"code grant\" flow. \n\tE.g { responseType: 'code' }"}),dn=new Zt({name:rn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function hn(e){if(function(e){return fn(e)&&!e?.refreshToken}(e))throw un;if(!function(e){return fn(e)&&e?.refreshToken}(e))throw dn}function pn(e){if(!e||!e.deviceKey||!e.deviceGroupKey||!e.randomPassword)throw new Zt({name:"DeviceMetadataNotFoundException",message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}const mn={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function fn(e){return e?.accessToken||e?.idToken}const gn={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},yn={partitions:[gn,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},vn=e=>{const{partitions:t}=yn;for(const{regions:n,outputs:r,regionRegex:a}of t){const t=new RegExp(a);if(n.includes(e)||t.test(e))return r.dnsSuffix}return gn.outputs.dnsSuffix},xn=URL,bn=e=>{let{endpointOverride:t}=e;return e=>t?{url:new xn(t)}:(e=>{let{region:t}=e;return{url:new xn(`https://${wt}.${t}.${vn(t)}`)}})(e)},En=async e=>{if(e.statusCode>=300){throw await ct(e)}return{IdentityId:(await ut(e)).IdentityId,$metadata:ot(e)}};function Sn(e){const t=Xt(e).payload.iss,n={};if(!t)throw new Zt({name:"InvalidIdTokenException",message:"Invalid Idtoken."});return n[t.replace(/(^\w+:|^)\/\//,"")]=e,n}async function wn(e){let{tokens:t,authConfig:n,identityIdStore:r}=e;r.setAuthConfig({Cognito:n});const a=await r.loadIdentityId();if(a)return a.id;const i=t?.idToken?Sn(t.idToken.toString()):{},s=await async function(e,t){const n=t?.identityPoolId,r=nn(n),a=(i={endpointResolver:bn({endpointOverride:t.identityPoolEndpoint})},dt(Ut,Dt("GetId"),En,{...Nt,...i,userAgentValue:st()}));var i;let s;try{s=(await a({region:r},{IdentityPoolId:n,Logins:e})).IdentityId}catch(o){throw en(o),new Zt(o)}if(!s)throw new Zt({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return s}(i,n);return r.storeIdentityId({id:s,type:t?"primary":"guest"}),s}const Nn=new $("CognitoCredentialsProvider"),kn=3e6;class Cn{constructor(e){this._nextCredentialsRefresh=0,this._identityIdStore=e}async clearCredentialsAndIdentityId(){Nn.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){Nn.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(e){const t=e.authenticated,{tokens:n}=e,{authConfig:r}=e;try{Jt(r?.Cognito)}catch{return}if(!t&&!r.Cognito.allowGuestAccess)return;const{forceRefresh:a}=e,i=this.hasTokenChanged(n),s=await wn({tokens:n,authConfig:r.Cognito,identityIdStore:this._identityIdStore});return(a||i)&&this.clearCredentials(),t?(function(e){if(!e||!e.idToken)throw new Zt({name:rn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}(n),this.credsForOIDCTokens(r.Cognito,n,s)):this.getGuestCredentials(s,r.Cognito)}async getGuestCredentials(e,t){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!1===this._credentialsAndIdentityId.isAuthenticatedCreds)return Nn.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const n=nn(t.identityPoolId),r=$t({endpointResolver:bn({endpointOverride:t.identityPoolEndpoint})});let a;try{a=await r({region:n},{IdentityId:e})}catch(i){throw en(i),new Zt(i)}if(a?.Credentials?.AccessKeyId&&a?.Credentials?.SecretKey){this._nextCredentialsRefresh=(new Date).getTime()+kn;const t={credentials:{accessKeyId:a.Credentials.AccessKeyId,secretAccessKey:a.Credentials.SecretKey,sessionToken:a.Credentials.SessionToken,expiration:a.Credentials.Expiration},identityId:e};return a.IdentityId&&(t.identityId=a.IdentityId,this._identityIdStore.storeIdentityId({id:a.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...t,isAuthenticatedCreds:!1},t}throw new Zt({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(e,t,n){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!0===this._credentialsAndIdentityId.isAuthenticatedCreds)return Nn.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const r=t.idToken?Sn(t.idToken.toString()):{},a=nn(e.identityPoolId),i=$t({endpointResolver:bn({endpointOverride:e.identityPoolEndpoint})});let s;try{s=await i({region:a},{IdentityId:n,Logins:r})}catch(o){throw en(o),new Zt(o)}if(s?.Credentials?.AccessKeyId&&s?.Credentials?.SecretKey){this._nextCredentialsRefresh=(new Date).getTime()+kn;const e={credentials:{accessKeyId:s.Credentials.AccessKeyId,secretAccessKey:s.Credentials.SecretKey,sessionToken:s.Credentials.SessionToken,expiration:s.Credentials.Expiration},identityId:n};return s.IdentityId&&(e.identityId=s.IdentityId,this._identityIdStore.storeIdentityId({id:s.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...e,isAuthenticatedCreds:!0,associatedIdToken:t.idToken?.toString()},e}throw new Zt({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return void 0===this._nextCredentialsRefresh||this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(e){return!!e&&!!this._credentialsAndIdentityId?.associatedIdToken&&e.idToken?.toString()!==this._credentialsAndIdentityId.associatedIdToken}}const In={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var An;!function(e){e.InvalidAuthTokens="InvalidAuthTokens"}(An||(An={}));const Tn=Gt({[An.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}}),Rn="CognitoIdentityServiceProvider";class jn{getKeyValueStorage(){if(!this.keyValueStorage)throw new Zt({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(e){this.keyValueStorage=e}setAuthConfig(e){this.authConfig=e}async loadTokens(){try{const e=await this.getAuthKeys(),t=await this.getKeyValueStorage().getItem(e.accessToken);if(!t)throw new Zt({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const n=Xt(t),r=await this.getKeyValueStorage().getItem(e.idToken),a=r?Xt(r):void 0,i=await this.getKeyValueStorage().getItem(e.refreshToken)??void 0,s=await this.getKeyValueStorage().getItem(e.clockDrift)??"0",o=Number.parseInt(s),l=await this.getKeyValueStorage().getItem(e.signInDetails),c={accessToken:n,idToken:a,refreshToken:i,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:o,username:await this.getLastAuthUser()};return l&&(c.signInDetails=JSON.parse(l)),c}catch(e){return null}}async storeTokens(e){Tn(void 0!==e,An.InvalidAuthTokens);const t=e.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),t);const n=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n.accessToken,e.accessToken.toString()),e.idToken?await this.getKeyValueStorage().setItem(n.idToken,e.idToken.toString()):await this.getKeyValueStorage().removeItem(n.idToken),e.refreshToken?await this.getKeyValueStorage().setItem(n.refreshToken,e.refreshToken):await this.getKeyValueStorage().removeItem(n.refreshToken),e.deviceMetadata&&(e.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(n.deviceKey,e.deviceMetadata.deviceKey),e.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(n.deviceGroupKey,e.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(n.randomPasswordKey,e.deviceMetadata.randomPassword)),e.signInDetails?await this.getKeyValueStorage().setItem(n.signInDetails,JSON.stringify(e.signInDetails)):await this.getKeyValueStorage().removeItem(n.signInDetails),await this.getKeyValueStorage().setItem(n.clockDrift,`${e.clockDrift}`)}async clearTokens(){const e=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(e.accessToken),this.getKeyValueStorage().removeItem(e.idToken),this.getKeyValueStorage().removeItem(e.clockDrift),this.getKeyValueStorage().removeItem(e.refreshToken),this.getKeyValueStorage().removeItem(e.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(e.oauthMetadata)])}async getDeviceMetadata(e){const t=await this.getAuthKeys(e),n=await this.getKeyValueStorage().getItem(t.deviceKey),r=await this.getKeyValueStorage().getItem(t.deviceGroupKey),a=await this.getKeyValueStorage().getItem(t.randomPasswordKey);return a&&r&&n?{deviceKey:n,deviceGroupKey:r,randomPassword:a}:null}async clearDeviceMetadata(e){const t=await this.getAuthKeys(e);await Promise.all([this.getKeyValueStorage().removeItem(t.deviceKey),this.getKeyValueStorage().removeItem(t.deviceGroupKey),this.getKeyValueStorage().removeItem(t.randomPasswordKey)])}async getAuthKeys(e){Kt(this.authConfig?.Cognito);const t=e??await this.getLastAuthUser();return _n(Rn,`${this.authConfig.Cognito.userPoolClientId}.${t}`)}getLastAuthUserKey(){Kt(this.authConfig?.Cognito);const e=this.authConfig.Cognito.userPoolClientId;return`${Rn}.${e}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(e){const{oauthMetadata:t}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(t,JSON.stringify(e))}async getOAuthMetadata(){const{oauthMetadata:e}=await this.getAuthKeys(),t=await this.getKeyValueStorage().getItem(e);return t&&JSON.parse(t)}}const _n=(e,t)=>Pn(In)(`${e}`,t);function Pn(e){const t=Object.values({...e});return(e,n)=>t.reduce((t,r)=>({...t,[r]:`${e}.${n}.${r}`}),{})}const On={identityId:"identityId"},Mn=new $("DefaultIdentityIdStore");class Ln{setAuthConfig(e){Jt(e.Cognito),this.authConfig=e,this._authKeys=Un("Cognito",e.Cognito.identityPoolId)}constructor(e){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=e}async loadIdentityId(){Jt(this.authConfig?.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const e=await this.keyValueStorage.getItem(this._authKeys.identityId);return e?(this._hasGuestIdentityId=!0,{id:e,type:"guest"}):null}}catch(e){return Mn.log("Error getting stored IdentityId.",e),null}}async storeIdentityId(e){Jt(this.authConfig?.Cognito),"guest"===e.type?(this.keyValueStorage.setItem(this._authKeys.identityId,e.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=e.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const Un=(e,t)=>Pn(On)(`com.amplify.${e}`,t),Dn=new Cn(new Ln(G)),qn=e=>(t,n)=>{const r=Fn(e),a=JSON.stringify(t);return $n(n,r,a)},Fn=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),$n=(e,t,n)=>{let{url:r}=e;return{headers:t,url:r,body:n,method:"POST"}},Bn=()=>async e=>{if(e.statusCode>=300){const t=await ct(e);throw en(t),new Zt({name:t.name,message:t.message,metadata:t.$metadata})}return ut(e)},zn=Pt(Lt,[()=>(e,t)=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),Vn="cognito-idp",Hn={service:Vn,retryDecider:yt(ct),computeDelay:ft,get userAgentValue(){return st()},cache:"no-store"},Gn=e=>dt(zn,qn("InitiateAuth"),Bn(),{...Hn,...e}),Wn=e=>{let{endpointOverride:t}=e;return e=>t?{url:new xn(t)}:(e=>{let{region:t}=e;return{url:new xn(`https://${Vn}.${t}.${vn(t)}`)}})(e)};function Qn(e){let{username:t,userPoolId:n,userPoolClientId:r}=e;if("undefined"===typeof window)return;const a=window.AmazonCognitoAdvancedSecurityData;if("undefined"===typeof a)return;const i=a.getData(t,n,r);if(i){return{EncodedData:i}}return{}}const Kn=async e=>{let{tokens:t,authConfig:n,username:r}=e;Kt(n?.Cognito);const{userPoolId:a,userPoolClientId:i,userPoolEndpoint:s}=n.Cognito,o=tn(a);hn(t);const l=t.refreshToken,c={REFRESH_TOKEN:l};t.deviceMetadata?.deviceKey&&(c.DEVICE_KEY=t.deviceMetadata.deviceKey);const u=Qn({username:r,userPoolId:a,userPoolClientId:i}),d=Gn({endpointResolver:Wn({endpointOverride:s})}),{AuthenticationResult:h}=await d({region:o},{ClientId:i,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:c,UserContextData:u}),p=Xt(h?.AccessToken??""),m=h?.IdToken?Xt(h.IdToken):void 0,{iat:f}=p.payload;if(!f)throw new Zt({name:"iatNotFoundException",message:"iat not found in access token"});return{accessToken:p,idToken:m,clockDrift:1e3*f-(new Date).getTime(),refreshToken:l,username:r}},Yn=(e=>{let t;return async function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t||(t=new Promise((n,a)=>{e(...r).then(e=>{n(e)}).catch(e=>{a(e)}).finally(()=>{t=void 0})}),t)}})(Kn),Jn=()=>"undefined"!==typeof window&&"undefined"!==typeof window.document;function Xn(e){let{expiresAt:t,clockDrift:n,tolerance:r=5e3}=e;return Date.now()+n+r>t}const Zn="amplify-signin-with-hostedUI",er="CognitoIdentityServiceProvider";class tr{constructor(e){this.keyValueStorage=e}async clearOAuthInflightData(){Kt(this.cognitoConfig);const e=nr(er,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(e.inflightOAuth),this.keyValueStorage.removeItem(e.oauthPKCE),this.keyValueStorage.removeItem(e.oauthState)])}async clearOAuthData(){Kt(this.cognitoConfig);const e=nr(er,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(Zn),this.keyValueStorage.removeItem(e.oauthSignIn)}loadOAuthState(){Kt(this.cognitoConfig);const e=nr(er,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthState)}storeOAuthState(e){Kt(this.cognitoConfig);const t=nr(er,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthState,e)}loadPKCE(){Kt(this.cognitoConfig);const e=nr(er,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthPKCE)}storePKCE(e){Kt(this.cognitoConfig);const t=nr(er,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthPKCE,e)}setAuthConfig(e){this.cognitoConfig=e}async loadOAuthInFlight(){Kt(this.cognitoConfig);const e=nr(er,this.cognitoConfig.userPoolClientId);return"true"===await this.keyValueStorage.getItem(e.inflightOAuth)}async storeOAuthInFlight(e){Kt(this.cognitoConfig);const t=nr(er,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(t.inflightOAuth,`${e}`)}async loadOAuthSignIn(){Kt(this.cognitoConfig);const e=nr(er,this.cognitoConfig.userPoolClientId),t=await this.keyValueStorage.getItem(Zn),[n,r]=(await this.keyValueStorage.getItem(e.oauthSignIn))?.split(",")??[];return{isOAuthSignIn:"true"===n||"true"===t,preferPrivateSession:"true"===r}}async storeOAuthSignIn(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Kt(this.cognitoConfig);const n=nr(er,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.oauthSignIn,`${e},${t}`)}}const nr=(e,t)=>Pn(mn)(e,t),rr=new tr(G),ar=[];class ir{constructor(){this.waitForInflightOAuth=Jn()?async()=>{if(await rr.loadOAuthInFlight())return this.inflightPromise||(this.inflightPromise=new Promise((e,t)=>{var n;n=e,ar.push(n)})),this.inflightPromise}:async()=>{}}setAuthConfig(e){rr.setAuthConfig(e.Cognito),this.authConfig=e}setTokenRefresher(e){this.tokenRefresher=e}setAuthTokenStore(e){this.tokenStore=e}getTokenStore(){if(!this.tokenStore)throw new Zt({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new Zt({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(e){let t;try{Kt(this.authConfig?.Cognito)}catch(i){return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,t=await this.getTokenStore().loadTokens();const n=await this.getTokenStore().getLastAuthUser();if(null===t)return null;const r=!!t?.idToken&&Xn({expiresAt:1e3*(t.idToken?.payload?.exp??0),clockDrift:t.clockDrift??0}),a=Xn({expiresAt:1e3*(t.accessToken?.payload?.exp??0),clockDrift:t.clockDrift??0});return(e?.forceRefresh||r||a)&&(t=await this.refreshTokens({tokens:t,username:n}),null===t)?null:{accessToken:t?.accessToken,idToken:t?.idToken,signInDetails:t?.signInDetails}}async refreshTokens(e){let{tokens:t,username:n}=e;try{const{signInDetails:e}=t,r=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:n});return r.signInDetails=e,await this.setTokens({tokens:r}),J.dispatch("auth",{event:"tokenRefresh"},"Auth",Q),r}catch(r){return this.handleErrors(r)}}handleErrors(e){if(en(e),e.name!==P.NetworkError&&this.clearTokens(),J.dispatch("auth",{event:"tokenRefresh_failure",data:{error:e}},"Auth",Q),e.name.startsWith("NotAuthorizedException"))return null;throw e}async setTokens(e){let{tokens:t}=e;return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(e){return this.getTokenStore().getDeviceMetadata(e)}clearDeviceMetadata(e){return this.getTokenStore().clearDeviceMetadata(e)}setOAuthMetadata(e){return this.getTokenStore().setOAuthMetadata(e)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}const sr=new class{constructor(){this.authTokenStore=new jn,this.authTokenStore.setKeyValueStorage(G),this.tokenOrchestrator=new ir,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(Yn)}getTokens(){let{forceRefresh:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{forceRefresh:!1};return this.tokenOrchestrator.getTokens({forceRefresh:e})}setKeyValueStorage(e){this.authTokenStore.setKeyValueStorage(e)}setAuthConfig(e){this.authTokenStore.setAuthConfig(e),this.tokenOrchestrator.setAuthConfig(e)}},{tokenOrchestrator:or}=sr,lr={configure(e,t){const n=pe(e),r=new M({sameSite:"lax"}),a=t?.ssr?r:G,i=t?.ssr?new Cn(new Ln(r)):Dn;if(n.Auth)if(t?.Auth)Te.configure(n,t);else{if(!Te.libraryOptions.Auth)return sr.setAuthConfig(n.Auth),sr.setKeyValueStorage(a),void Te.configure(n,{...t,Auth:{tokenProvider:sr,credentialsProvider:i}});if(t){const e=Te.libraryOptions.Auth;return void 0!==t.ssr&&(sr.setKeyValueStorage(a),e.credentialsProvider=i),void Te.configure(n,{Auth:e,...t})}Te.configure(n)}else Te.configure(n,t)},getConfig:()=>Te.getConfig()};const cr=async()=>(async e=>{const t=e.getConfig().Auth?.Cognito;Kt(t);const n=await e.Auth.getTokens({forceRefresh:!1});cn(n);const{"cognito:username":r,sub:a}=n.idToken?.payload??{},i={username:r,userId:a},s=function(e){return e?.signInDetails}(n);return s&&(i.signInDetails=s),i})(Te),ur=e=>((e,t)=>e.Auth.fetchAuthSession(t))(Te,e);var dr,hr,pr,mr,fr,gr,yr,vr,xr,br,Er,Sr,wr,Nr,kr,Cr,Ir,Ar,Tr,Rr,jr,_r,Pr,Or;!function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"}(dr||(dr={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(hr||(hr={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(pr||(pr={})),function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(mr||(mr={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(fr||(fr={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(gr||(gr={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(yr||(yr={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(vr||(vr={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(xr||(xr={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(br||(br={})),function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"}(Er||(Er={})),function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"}(Sr||(Sr={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(wr||(wr={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"}(Nr||(Nr={})),function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(kr||(kr={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(Cr||(Cr={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Ir||(Ir={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Ar||(Ar={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"}(Tr||(Tr={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Rr||(Rr={})),function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(jr||(jr={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(_r||(_r={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Pr||(Pr={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Or||(Or={}));var Mr;!function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"}(Mr||(Mr={}));const Lr={[Mr.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[Mr.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[Mr.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[Mr.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[Mr.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[Mr.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[Mr.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[Mr.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[Mr.EmptySignInPassword]:{message:"password is required to signIn"},[Mr.EmptySignInUsername]:{message:"username is required to signIn"},[Mr.EmptySignUpPassword]:{message:"password is required to signUp"},[Mr.EmptySignUpUsername]:{message:"username is required to signUp"},[Mr.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[Mr.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[Mr.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[Mr.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[Mr.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};var Ur,Dr;!function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"}(Ur||(Ur={})),function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"}(Dr||(Dr={}));const qr=(e,t)=>st({category:je.Auth,action:e,...t}),Fr=e=>dt(zn,qn("RespondToAuthChallenge"),Bn(),{...Hn,...e});async function $r(e){if(!e.AccessToken)throw new L({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"});{const t=Xt(e.AccessToken),n=1e3*(t.payload.iat||0),r=(new Date).getTime(),a=n>0?n-r:0;let i,s,o;e.RefreshToken&&(s=e.RefreshToken),e.IdToken&&(i=Xt(e.IdToken)),e?.NewDeviceMetadata&&(o=e.NewDeviceMetadata);const l={accessToken:t,idToken:i,refreshToken:s,clockDrift:a,deviceMetadata:o,username:e.username};e?.signInDetails&&(l.signInDetails=e.signInDetails),await or.setTokens({tokens:l})}}const Br=async()=>{try{J.dispatch("auth",{event:"signedIn",data:await cr()},"Auth",Q)}catch(e){if(e.name===rn)throw new Zt({name:"UnexpectedSignInInterruptionException",message:"Unable to get user session following successful sign-in.",recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."});throw e}},zr="CognitoSignInState",Vr={username:`${zr}.username`,challengeName:`${zr}.challengeName`,signInSession:`${zr}.signInSession`,expiry:`${zr}.expiry`},Hr=()=>{Kr.dispatch({type:"RESET_STATE"})},Gr=()=>{for(const e of Object.values(Vr))W.removeItem(e)},Wr=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),Qr=()=>{const e=W.getItem(Vr.expiry);if(!e||Number(e)<=Date.now())return Gr(),Wr();return{username:W.getItem(Vr.username)??void 0,challengeName:W.getItem(Vr.challengeName)??void 0,signInSession:W.getItem(Vr.signInSession)??void 0}},Kr=(e=>{let t=e(Wr(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}})((e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return Jr({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return Jr(t.value),{...t.value};case"SET_CHALLENGE_NAME":return Jr({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return Jr({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return Qr();case"RESET_STATE":return Gr(),Wr();default:return e}});function Yr(e){Kr.dispatch({type:"SET_SIGN_IN_STATE",value:e})}const Jr=e=>{let{challengeName:t,signInSession:n,username:r}=e;r&&W.setItem(Vr.username,r),t&&W.setItem(Vr.challengeName,t),n&&(W.setItem(Vr.signInSession,n),W.setItem(Vr.expiry,String(Date.now()+18e4)))};class Xr extends L{constructor(e){super(e),this.constructor=Xr,Object.setPrototypeOf(this,Xr.prototype)}}var Zr;!function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"}(Zr||(Zr={}));const ea="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",ta="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",na="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",ra={[Zr.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:ea},[Zr.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:na},[Zr.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:na},[Zr.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:ea},[Zr.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[Zr.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[Zr.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:ta},[Zr.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:ta},[Zr.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:ta},[Zr.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},aa=Gt(ra,Xr),ia=e=>{if(e instanceof Error){if("AbortError"===e.name){const{message:t,recoverySuggestion:n}=ra[Zr.PasskeyOperationAborted];return new Xr({name:Zr.PasskeyOperationAborted,message:t,recoverySuggestion:n,underlyingError:e})}if("SecurityError"===e.name){const{message:t,recoverySuggestion:n}=ra[Zr.RelyingPartyMismatch];return new Xr({name:Zr.RelyingPartyMismatch,message:t,recoverySuggestion:n,underlyingError:e})}}return new Xr({name:P.Unknown,message:"An unknown error has occurred.",underlyingError:e})};const sa={convert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{urlSafe:!1,skipPadding:!1};const n="string"===typeof e?e:function(e){return Array.from(e,e=>String.fromCodePoint(e)).join("")}(e);let r=(()=>{if("undefined"!==typeof window&&"function"===typeof window.btoa)return window.btoa;if("function"===typeof btoa)return btoa;throw new L({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})})()(n);return t.urlSafe&&(r=r.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(r=r.replace(/=/g,"")),r}},oa=e=>sa.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),la=e=>Uint8Array.from(Ht.convert(e,{urlSafe:!0}),e=>e.charCodeAt(0)).buffer;const ca=async e=>{try{const t=Jn()&&window.isSecureContext&&"credentials"in navigator&&"function"===typeof window.PublicKeyCredential;aa(t,Zr.PasskeyNotSupported);const n=(e=>{const t=la(e.challenge),n=(e.allowCredentials||[]).map(e=>({...e,id:la(e.id)}));return{...e,challenge:t,allowCredentials:n}})(e),r=await navigator.credentials.get({publicKey:n});return function(e){aa(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,Zr.PasskeyRetrievalFailed)}(r),(e=>{const t={clientDataJSON:oa(e.response.clientDataJSON),authenticatorData:oa(e.response.authenticatorData),signature:oa(e.response.signature)};e.response.userHandle&&(t.userHandle=oa(e.response.userHandle));const n={id:e.id,rawId:oa(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(n.authenticatorAttachment=e.authenticatorAttachment),n})(r)}catch(t){throw(e=>{if(e instanceof Xr)return e;if(e instanceof Error&&"NotAllowedError"===e.name){const{message:t,recoverySuggestion:n}=ra[Zr.PasskeyAuthenticationCanceled];return new Xr({name:Zr.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}return ia(e)})(t)}},ua=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:n="",model:r="",architecture:a="",fullVersionList:i=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]);return[t,n,a,r,t,i.map(e=>`${e.brand}/${e.version}`).join(";")].filter(e=>e).join(" ")||navigator.userAgent},da={convert:e=>(new TextEncoder).encode(e)};function ha(e,t){null!=e&&this.fromString(e,t)}function pa(){return new ha(null,null)}let ma;const fa="undefined"!==typeof navigator;fa&&"Microsoft Internet Explorer"===navigator.appName?(ha.prototype.am=function(e,t,n,r,a,i){const s=32767&t,o=t>>15;for(;--i>=0;){let t=32767&this[e];const i=this[e++]>>15,l=o*t+i*s;t=s*t+((32767&l)<<15)+n[r]+(1073741823&a),a=(t>>>30)+(l>>>15)+o*i+(a>>>30),n[r++]=1073741823&t}return a},ma=30):fa&&"Netscape"!==navigator.appName?(ha.prototype.am=function(e,t,n,r,a,i){for(;--i>=0;){const i=t*this[e++]+n[r]+a;a=Math.floor(i/67108864),n[r++]=67108863&i}return a},ma=26):(ha.prototype.am=function(e,t,n,r,a,i){const s=16383&t,o=t>>14;for(;--i>=0;){let t=16383&this[e];const i=this[e++]>>14,l=o*t+i*s;t=s*t+((16383&l)<<14)+n[r]+a,a=(t>>28)+(l>>14)+o*i,n[r++]=268435455&t}return a},ma=28),ha.prototype.DB=ma,ha.prototype.DM=(1<<ma)-1,ha.prototype.DV=1<<ma;ha.prototype.FV=Math.pow(2,52),ha.prototype.F1=52-ma,ha.prototype.F2=2*ma-52;const ga=[];let ya,va;for(ya="0".charCodeAt(0),va=0;va<=9;++va)ga[ya++]=va;for(ya="a".charCodeAt(0),va=10;va<36;++va)ga[ya++]=va;for(ya="A".charCodeAt(0),va=10;va<36;++va)ga[ya++]=va;function xa(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function ba(e,t){const n=ga[e.charCodeAt(t)];return null==n?-1:n}function Ea(e){const t=pa();return t.fromInt(e),t}function Sa(e){let t,n=1;return 0!==(t=e>>>16)&&(e=t,n+=16),0!==(t=e>>8)&&(e=t,n+=8),0!==(t=e>>4)&&(e=t,n+=4),0!==(t=e>>2)&&(e=t,n+=2),0!==(t=e>>1)&&(e=t,n+=1),n}function wa(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}wa.prototype.convert=function(e){const t=pa();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(ha.ZERO)>0&&this.m.subTo(t,t),t},wa.prototype.revert=function(e){const t=pa();return e.copyTo(t),this.reduce(t),t},wa.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=32767&e[t];const r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},wa.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},wa.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},ha.prototype.copyTo=function(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},ha.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},ha.prototype.fromString=function(e,t){let n;if(16===t)n=4;else if(8===t)n=3;else if(2===t)n=1;else if(32===t)n=5;else{if(4!==t)throw new Error("Only radix 2, 4, 8, 16, 32 are supported");n=2}this.t=0,this.s=0;let r=e.length,a=!1,i=0;for(;--r>=0;){const t=ba(e,r);t<0?"-"===e.charAt(r)&&(a=!0):(a=!1,0===i?this[this.t++]=t:i+n>this.DB?(this[this.t-1]|=(t&(1<<this.DB-i)-1)<<i,this[this.t++]=t>>this.DB-i):this[this.t-1]|=t<<i,i+=n,i>=this.DB&&(i-=this.DB))}this.clamp(),a&&ha.ZERO.subTo(this,this)},ha.prototype.clamp=function(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t},ha.prototype.dlShiftTo=function(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s},ha.prototype.drShiftTo=function(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s},ha.prototype.lShiftTo=function(e,t){const n=e%this.DB,r=this.DB-n,a=(1<<r)-1,i=Math.floor(e/this.DB);let s,o=this.s<<n&this.DM;for(s=this.t-1;s>=0;--s)t[s+i+1]=this[s]>>r|o,o=(this[s]&a)<<n;for(s=i-1;s>=0;--s)t[s]=0;t[i]=o,t.t=this.t+i+1,t.s=this.s,t.clamp()},ha.prototype.rShiftTo=function(e,t){t.s=this.s;const n=Math.floor(e/this.DB);if(n>=this.t)return void(t.t=0);const r=e%this.DB,a=this.DB-r,i=(1<<r)-1;t[0]=this[n]>>r;for(let s=n+1;s<this.t;++s)t[s-n-1]|=(this[s]&i)<<a,t[s-n]=this[s]>>r;r>0&&(t[this.t-n-1]|=(this.s&i)<<a),t.t=this.t-n,t.clamp()},ha.prototype.subTo=function(e,t){let n=0,r=0;const a=Math.min(e.t,this.t);for(;n<a;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()},ha.prototype.multiplyTo=function(e,t){const n=this.abs(),r=e.abs();let a=n.t;for(t.t=a+r.t;--a>=0;)t[a]=0;for(a=0;a<r.t;++a)t[a+n.t]=n.am(0,r[a],t,a,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&ha.ZERO.subTo(t,t)},ha.prototype.squareTo=function(e){const t=this.abs();let n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){const r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()},ha.prototype.divRemTo=function(e,t,n){const r=e.abs();if(r.t<=0)return;const a=this.abs();if(a.t<r.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null===n&&(n=pa());const i=pa(),s=this.s,o=e.s,l=this.DB-Sa(r[r.t-1]);l>0?(r.lShiftTo(l,i),a.lShiftTo(l,n)):(r.copyTo(i),a.copyTo(n));const c=i.t,u=i[c-1];if(0===u)return;const d=u*(1<<this.F1)+(c>1?i[c-2]>>this.F2:0),h=this.FV/d,p=(1<<this.F1)/d,m=1<<this.F2;let f=n.t,g=f-c;const y=null===t?pa():t;for(i.dlShiftTo(g,y),n.compareTo(y)>=0&&(n[n.t++]=1,n.subTo(y,n)),ha.ONE.dlShiftTo(c,y),y.subTo(i,i);i.t<c;)i[i.t++]=0;for(;--g>=0;){let e=n[--f]===u?this.DM:Math.floor(n[f]*h+(n[f-1]+m)*p);if((n[f]+=i.am(0,e,n,g,0,c))<e)for(i.dlShiftTo(g,y),n.subTo(y,n);n[f]<--e;)n.subTo(y,n)}null!==t&&(n.drShiftTo(c,t),s!==o&&ha.ZERO.subTo(t,t)),n.t=c,n.clamp(),l>0&&n.rShiftTo(l,n),s<0&&ha.ZERO.subTo(n,n)},ha.prototype.invDigit=function(){if(this.t<1)return 0;const e=this[0];if(0===(1&e))return 0;let t=3&e;return t=t*(2-(15&e)*t)&15,t=t*(2-(255&e)*t)&255,t=t*(2-((65535&e)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t},ha.prototype.addTo=function(e,t){let n=0,r=0;const a=Math.min(e.t,this.t);for(;n<a;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[n++]=r:r<-1&&(t[n++]=this.DV+r),t.t=n,t.clamp()},ha.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(16==e)t=4;else if(8===e)t=3;else if(2===e)t=1;else if(32===e)t=5;else{if(4!==e)throw new Error("Only radix 2, 4, 8, 16, 32 are supported");t=2}const n=(1<<t)-1;let r,a=!1,i="",s=this.t,o=this.DB-s*this.DB%t;if(s-- >0)for(o<this.DB&&(r=this[s]>>o)>0&&(a=!0,i=xa(r));s>=0;)o<t?(r=(this[s]&(1<<o)-1)<<t-o,r|=this[--s]>>(o+=this.DB-t)):(r=this[s]>>(o-=t)&n,o<=0&&(o+=this.DB,--s)),r>0&&(a=!0),a&&(i+=xa(r));return a?i:"0"},ha.prototype.negate=function(){const e=pa();return ha.ZERO.subTo(this,e),e},ha.prototype.abs=function(){return this.s<0?this.negate():this},ha.prototype.compareTo=function(e){let t=this.s-e.s;if(0!=t)return t;let n=this.t;if(t=n-e.t,0!=t)return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0},ha.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Sa(this[this.t-1]^this.s&this.DM)},ha.prototype.mod=function(e){const t=pa();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(ha.ZERO)>0&&e.subTo(t,t),t},ha.prototype.equals=function(e){return 0===this.compareTo(e)},ha.prototype.add=function(e){const t=pa();return this.addTo(e,t),t},ha.prototype.subtract=function(e){const t=pa();return this.subTo(e,t),t},ha.prototype.multiply=function(e){const t=pa();return this.multiplyTo(e,t),t},ha.prototype.divide=function(e){const t=pa();return this.divRemTo(e,t,null),t},ha.prototype.modPow=function(e,t,n){let r,a=e.bitLength(),i=Ea(1);const s=new wa(t);if(a<=0)return i;r=a<18?1:a<48?3:a<144?4:a<768?5:6;const o=[];let l=3;const c=r-1,u=(1<<r)-1;if(o[1]=s.convert(this),r>1){const e=pa();for(s.sqrTo(o[1],e);l<=u;)o[l]=pa(),s.mulTo(e,o[l-2],o[l]),l+=2}let d,h,p=e.t-1,m=!0,f=pa();for(a=Sa(e[p])-1;p>=0;){for(a>=c?d=e[p]>>a-c&u:(d=(e[p]&(1<<a+1)-1)<<c-a,p>0&&(d|=e[p-1]>>this.DB+a-c)),l=r;0===(1&d);)d>>=1,--l;if((a-=l)<0&&(a+=this.DB,--p),m)o[d].copyTo(i),m=!1;else{for(;l>1;)s.sqrTo(i,f),s.sqrTo(f,i),l-=2;l>0?s.sqrTo(i,f):(h=i,i=f,f=h),s.mulTo(f,o[d],i)}for(;p>=0&&0===(e[p]&1<<a);)s.sqrTo(i,f),h=i,i=f,f=h,--a<0&&(a=this.DB-1,--p)}const g=s.revert(i);return n(null,g),g},ha.ZERO=Ea(0),ha.ONE=Ea(1);const Na={},ka={};for(let Kl=0;Kl<256;Kl++){let e=Kl.toString(16).toLowerCase();1===e.length&&(e=`0${e}`),Na[Kl]=e,ka[e]=Kl}const Ca=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const r=e.slice(n,n+2).toLowerCase();if(!(r in ka))throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`);t[n/2]=ka[r]}return t},Ia=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Na[e[n]];return t},Aa=e=>{const t=new we;t.update(e);const n=t.digestSync(),r=Ia(n);return new Array(64-r.length).join("0")+r},Ta=e=>Aa(Ca(e)),Ra=/^[89a-f]/i,ja=e=>{if(!(e instanceof ha))throw new Error("Not a BigInteger");const t=e.compareTo(ha.ZERO)<0;let n=e.abs().toString(16);if(n=n.length%2!==0?`0${n}`:n,n=Ra.test(n)?`00${n}`:n,t){const e=n.split("").map(e=>{const t=15&~parseInt(e,16);return"0123456789ABCDEF".charAt(t)}).join("");n=new ha(e,16).add(ha.ONE).toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n};function _a(){return Vt().getRandomValues(new Uint32Array(1))[0]}class Pa{constructor(e,t){this.words=[];let n=e;n=this.words=n||[],this.sigBytes=void 0!==t?t:4*n.length}random(e){const t=[];for(let n=0;n<e;n+=4)t.push(_a());return new Pa(t,e)}toString(){return function(e){const{words:t}=e,{sigBytes:n}=e,r=[];for(let a=0;a<n;a++){const e=t[a>>>2]>>>24-a%4*8&255;r.push((e>>>4).toString(16)),r.push((15&e).toString(16))}return r.join("")}(this)}}const Oa=e=>{const t=(new Pa).random(e).toString();return Ca(t)};class Ma{constructor(e){let{userPoolName:t,a:n,g:r,A:a,N:i}=e;this.encoder=da,this.userPoolName=t,this.a=n,this.g=r,this.A=a,this.N=i,this.k=new ha(Ta(`${ja(i)}${ja(r)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new Zt({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new Zt({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new Zt({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(e,t){this.randomPassword=sa.convert(Oa(40));const n=`${e}${t}:${this.randomPassword}`,r=Aa(n),a=Ia(Oa(16));return this.saltToHashDevices=ja(new ha(a,16)),new Promise((e,t)=>{this.g.modPow(new ha(Ta(this.saltToHashDevices+r),16),this.N,(n,r)=>{n?t(n):(this.verifierDevices=ja(r),e())})})}async getPasswordAuthenticationKey(e){let{username:t,password:n,serverBValue:r,salt:a}=e;if(r.mod(this.N).equals(ha.ZERO))throw new Error("B cannot be zero.");const i=(e=>{let{A:t,B:n}=e;const r=new ha(Ta(ja(t)+ja(n)),16);if(r.equals(ha.ZERO))throw new Error("U cannot be zero.");return r})({A:this.A,B:r}),s=`${this.userPoolName}${t}:${n}`,o=Aa(s),l=new ha(Ta(ja(a)+o),16),c=await(async e=>{let{a:t,g:n,k:r,x:a,B:i,N:s,U:o}=e;return new Promise((e,l)=>{n.modPow(a,s,(n,c)=>{n?l(n):i.subtract(r.multiply(c)).modPow(t.add(o.multiply(a)),s,(t,n)=>{t?l(t):e(n.mod(s))})})})})({a:this.a,g:this.g,k:this.k,x:l,B:r,N:this.N,U:i}),u=this.encoder.convert("Caldera Derived Key"),d=this.encoder.convert(String.fromCharCode(1)),h=new Uint8Array(u.byteLength+d.byteLength);h.set(u,0),h.set(d,u.byteLength);const p=((e,t,n)=>{const r=new we(t);r.update(e);const a=r.digestSync(),i=new we(a);return i.update(n),i.digestSync().slice(0,16)})(Ca(ja(c)),Ca(ja(i)),h);return p}}const La=async e=>{const t=new ha("FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",16),n=new ha("2",16),r=Ua(),a=await(async e=>{let{a:t,g:n,N:r}=e;return new Promise((e,a)=>{n.modPow(t,r,(t,n)=>{t?a(t):n.mod(r).equals(ha.ZERO)?a(new Error("Illegal parameter. A mod N cannot be 0.")):e(n)})})})({a:r,g:n,N:t});return new Ma({userPoolName:e,a:r,g:n,A:a,N:t})},Ua=()=>new ha(Ia(Oa(128)),16);async function Da(e){let{userPoolId:t,userPoolEndpoint:n,newDeviceMetadata:r,accessToken:a}=e;if(!r)return;const i=t.split("_")[1]||"",s=await La(i),o=r?.DeviceKey,l=r?.DeviceGroupKey;try{await s.generateHashDevice(l??"",o??"")}catch(h){return}const c={Salt:sa.convert(Ca(s.getSaltToHashDevices())),PasswordVerifier:sa.convert(Ca(s.getVerifierDevices()))},u=s.getRandomPassword();try{const e=(d={endpointResolver:Wn({endpointOverride:n})},dt(zn,qn("ConfirmDevice"),Bn(),{...Hn,...d}));return await e({region:tn(t)},{AccessToken:a,DeviceName:await ua(),DeviceKey:r?.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:o,deviceGroupKey:l,randomPassword:u}}catch(p){return}var d}const qa=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Fa=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],$a=()=>{const e=new Date,t=Fa[e.getUTCDay()],n=qa[e.getUTCMonth()],r=e.getUTCDate();let a=e.getUTCHours();a<10&&(a=`0${a}`);let i=e.getUTCMinutes();i<10&&(i=`0${i}`);let s=e.getUTCSeconds();s<10&&(s=`0${s}`);return`${t} ${n} ${r} ${a}:${i}:${s} UTC ${e.getUTCFullYear()}`},Ba=e=>{let{userPoolName:t,username:n,challengeParameters:r,dateNow:a,hkdf:i}=e;const s=da.convert(t),o=da.convert(n),l=za(r.SECRET_BLOCK),c=da.convert(a),u=new Uint8Array(s.byteLength+o.byteLength+l.byteLength+c.byteLength);u.set(s,0),u.set(o,s.byteLength),u.set(l,s.byteLength+o.byteLength),u.set(c,s.byteLength+o.byteLength+l.byteLength);const d=new we(i);d.update(u);const h=d.digestSync();return sa.convert(h)},za=e=>{const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=Ht.convert(t),r=new Uint8Array(n.length);for(let a=0;a<n.length;++a)r[a]=n.charCodeAt(a);return r};async function Va(e){let{username:t,config:n,clientMetadata:r,session:a,tokenOrchestrator:i}=e;const{userPoolId:s,userPoolEndpoint:o}=n,l=n.userPoolClientId,c=await(i?.getDeviceMetadata(t));pn(c);const u=await La(c.deviceGroupKey),d={ChallengeName:"DEVICE_SRP_AUTH",ClientId:l,ChallengeResponses:{USERNAME:t,SRP_A:u.A.toString(16),DEVICE_KEY:c.deviceKey},ClientMetadata:r,Session:a},h=Fr({endpointResolver:Wn({endpointOverride:o})}),{ChallengeParameters:p,Session:m}=await h({region:tn(s)},d);return async function(e,t,n,r,a,i,s){let{userPoolId:o,userPoolClientId:l,userPoolEndpoint:c}=i;const u=await(s?.getDeviceMetadata(e));pn(u);const d=new ha(t?.SRP_B,16),h=new ha(t?.SALT,16),{deviceKey:p}=u,{deviceGroupKey:m}=u,f=await a.getPasswordAuthenticationKey({username:u.deviceKey,password:u.randomPassword,serverBValue:d,salt:h}),g=$a(),y={USERNAME:t?.USERNAME??e,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:g,PASSWORD_CLAIM_SIGNATURE:Ba({username:p,userPoolName:m,challengeParameters:t,dateNow:g,hkdf:f}),DEVICE_KEY:p},v=Qn({username:e,userPoolId:o,userPoolClientId:l}),x={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:l,ChallengeResponses:y,Session:r,ClientMetadata:n,UserContextData:v},b=Fr({endpointResolver:Wn({endpointOverride:c})});return b({region:tn(o)},x)}(t,p,r,m,u,n,i)}async function Ha(e,t,n,r,a,i,s){const{userPoolId:o,userPoolClientId:l,userPoolEndpoint:c}=i,u=o?.split("_")[1]||"",d=new ha(t?.SRP_B,16),h=new ha(t?.SALT,16),p=t?.USER_ID_FOR_SRP;if(!p)throw new Zt({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const m=await a.getPasswordAuthenticationKey({username:p,password:e,serverBValue:d,salt:h}),f=$a(),g={USERNAME:p,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:f,PASSWORD_CLAIM_SIGNATURE:Ba({username:p,userPoolName:u,challengeParameters:t,dateNow:f,hkdf:m})},y=await s.getDeviceMetadata(p);y&&y.deviceKey&&(g.DEVICE_KEY=y.deviceKey);const v={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:g,ClientMetadata:n,Session:r,ClientId:l,UserContextData:Qn({username:p,userPoolId:o,userPoolClientId:l})},x=Fr({endpointResolver:Wn({endpointOverride:c})}),b=await x({region:tn(o)},v);return"DEVICE_SRP_AUTH"===b.ChallengeName?Va({username:p,config:i,clientMetadata:n,session:b.Session,tokenOrchestrator:s}):b}async function Ga(e,t,n,r){try{return await e(...t)}catch(a){if(a instanceof Zt&&"ResourceNotFoundException"===a.name&&a.message.includes("Device does not exist."))return await r.clearDeviceMetadata(n),e(...t);throw a}}function Wa(e){const{dispatch:t}=Kr;t({type:"SET_USERNAME",value:e})}async function Qa(e){let{username:t,password:n,clientMetadata:r,config:a,tokenOrchestrator:i,authFlow:s,preferredChallenge:o}=e;const{userPoolId:l,userPoolClientId:c,userPoolEndpoint:u}=a,d=l?.split("_")[1]||"",h=await La(d),p={USERNAME:t,SRP_A:h.A.toString(16)};"USER_AUTH"===s&&o&&(p.PREFERRED_CHALLENGE=o);const m={AuthFlow:s,AuthParameters:p,ClientMetadata:r,ClientId:c,UserContextData:Qn({username:t,userPoolId:l,userPoolClientId:c})},f=Gn({endpointResolver:Wn({endpointOverride:u})}),g=await f({region:tn(l),userAgentValue:qr(Me.SignIn)},m),{ChallengeParameters:y,Session:v}=g,x=y?.USERNAME??t;return Wa(x),"PASSWORD_VERIFIER"===g.ChallengeName?Ga(Ha,[n,y,r,v,h,a,i],x,i):g}const Ka="userAttributes.";async function Ya(e,t,n,r,a){const{userPoolClientId:i,userPoolId:s,userPoolEndpoint:o}=r,l={USERNAME:e,PASSWORD:t},c=await a.getDeviceMetadata(e);c&&c.deviceKey&&(l.DEVICE_KEY=c.deviceKey);const u={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:l,ClientMetadata:n,ClientId:i,UserContextData:Qn({username:e,userPoolId:s,userPoolClientId:i})},d=Gn({endpointResolver:Wn({endpointOverride:o})}),h=await d({region:tn(s),userAgentValue:qr(Me.SignIn)},u),p=h.ChallengeParameters?.USERNAME??h.ChallengeParameters?.USER_ID_FOR_SRP??e;return Wa(p),"DEVICE_SRP_AUTH"===h.ChallengeName?Va({username:p,config:r,clientMetadata:n,session:h.Session,tokenOrchestrator:a}):h}async function Ja(e,t,n,r){const{userPoolClientId:a,userPoolId:i,userPoolEndpoint:s}=n,o={USERNAME:e},l=await r.getDeviceMetadata(e);l&&l.deviceKey&&(o.DEVICE_KEY=l.deviceKey);const c={AuthFlow:"CUSTOM_AUTH",AuthParameters:o,ClientMetadata:t,ClientId:a,UserContextData:Qn({username:e,userPoolId:i,userPoolClientId:a})},u=Gn({endpointResolver:Wn({endpointOverride:s})}),d=await u({region:tn(i),userAgentValue:qr(Me.SignIn)},c),h=d.ChallengeParameters?.USERNAME??e;return Wa(h),"DEVICE_SRP_AUTH"===d.ChallengeName?Va({username:h,config:n,clientMetadata:t,session:d.Session,tokenOrchestrator:r}):d}async function Xa(e){const{challengeName:t,challengeParameters:n,availableChallenges:r}=e,a=Te.getConfig().Auth?.Cognito;switch(Kt(a),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:e,username:t}=Kr.getState(),r=ri(ai(n.MFAS_CAN_SETUP))||[],s=r.filter(e=>"EMAIL"===e||"TOTP"===e),o=s.includes("TOTP"),l=s.includes("EMAIL");if(o&&l)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:s}};if(l)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(o){const n=(i={endpointResolver:Wn({endpointOverride:a.userPoolEndpoint})},dt(zn,qn("AssociateSoftwareToken"),Bn(),{...Hn,...i})),{Session:r,SecretCode:s}=await n({region:tn(a.userPoolId)},{Session:e});return Kr.dispatch({type:"SET_SIGN_IN_SESSION",value:r}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:Za(s,t)}}}throw new Zt({name:Dr.SignInException,message:`Cannot initiate MFA setup from available types: ${r}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:ti(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:ri(ai(n.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{const e=await async function(e){const t=Te.getConfig().Auth?.Cognito;Kt(t);const{username:n,signInSession:r,signInDetails:a,challengeName:i}=Kr.getState();if("WEB_AUTHN"!==i||!n)throw new Zt({name:Dr.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:s}=e;aa(!!s,Zr.InvalidPasskeyAuthenticationOptions);const o=await ca(JSON.parse(s)),l=Fr({endpointResolver:Wn({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:h}=await l({region:tn(t.userPoolId),userAgentValue:qr(Me.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:n,CREDENTIAL:JSON.stringify(o)},ClientId:t.userPoolClientId,Session:r});if(Yr({signInSession:h,username:n,challengeName:c,signInDetails:a}),d)return await $r({...d,username:n,NewDeviceMetadata:await Da({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:a}),Kr.dispatch({type:"RESET_STATE"}),await Br(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if("WEB_AUTHN"===c)throw new Zt({name:Dr.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:c,challengeParameters:u}}(n);return function(e){return"isSignedIn"in e&&"nextStep"in e}(e)?e:Xa(e)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:r}}}var i;throw new Zt({name:Dr.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function Za(e,t){return{sharedSecret:e,getSetupUri:(n,r)=>new xn(`otpauth://totp/${n}:${r??t}?secret=${e}&issuer=${n}`)}}function ei(e){return e===kr.PasswordResetRequiredException?{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}}:e===kr.UserNotConfirmedException?{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}:void 0}function ti(e){if(!e)return[];return JSON.parse(e).map(e=>e.includes(Ka)?e.replace(Ka,""):e)}function ni(e){return"SMS_MFA"===e?"SMS":"SOFTWARE_TOKEN_MFA"===e?"TOTP":"EMAIL_OTP"===e?"EMAIL":void 0}function ri(e){if(e)return e.map(ni).filter(Boolean)}function ai(e){return e?JSON.parse(e):[]}function ii(e){return Kr.getState().username??e}function si(e,t){const{message:n,recoverySuggestion:r}=Lr[t];if(!e)throw new Zt({name:t,message:n,recoverySuggestion:r})}async function oi(e){const{username:t,password:n,options:r}=e,a={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},i=Te.getConfig().Auth?.Cognito;Kt(i);const s=r?.clientMetadata;si(!!t,Mr.EmptySignInUsername),si(!!n,Mr.EmptySignInPassword);try{const{ChallengeName:e,ChallengeParameters:r,AuthenticationResult:o,Session:l}=await async function(e,t,n,r,a){Kt(r);const{userPoolId:i,userPoolClientId:s,userPoolEndpoint:o}=r,l=i?.split("_")[1]||"",c=await La(l),u={AuthFlow:"CUSTOM_AUTH",AuthParameters:{USERNAME:e,SRP_A:c.A.toString(16),CHALLENGE_NAME:"SRP_A"},ClientMetadata:n,ClientId:s,UserContextData:Qn({username:e,userPoolId:i,userPoolClientId:s})},d=Gn({endpointResolver:Wn({endpointOverride:o})}),{ChallengeParameters:h,Session:p}=await d({region:tn(i),userAgentValue:qr(Me.SignIn)},u),m=h?.USERNAME??e;return Wa(m),Ga(Ha,[t,h,n,p,c,r,a],m,a)}(t,n,s,i,or),c=ii(t);return Yr({signInSession:l,username:c,challengeName:e,signInDetails:a}),o?(await $r({username:c,...o,NewDeviceMetadata:await Da({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:o.NewDeviceMetadata,accessToken:o.AccessToken}),signInDetails:a}),Hr(),await Br(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Xa({challengeName:e,challengeParameters:r})}catch(o){Hr(),en(o);const e=ei(o.name);if(e)return e;throw o}}const li=(e=>{let t=e({active:!1},{type:"RESET"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}})((e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return{active:!1};default:return e}}),ci=async()=>{throw new Zt({name:an,message:"The autoSignIn flow has not started, or has been cancelled/completed.",recoverySuggestion:"Please try to use the signIn API or log out before starting a new autoSignIn flow."})};let ui=null;function di(e){ui=e}function hi(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(ui=ci),li.dispatch({type:"RESET"})}async function pi(e){const{username:t,password:n}=e,r=Te.getConfig().Auth?.Cognito,a={loginId:t,authFlowType:"USER_SRP_AUTH"};Kt(r);const i=e.options?.clientMetadata;si(!!t,Mr.EmptySignInUsername),si(!!n,Mr.EmptySignInPassword);try{const{ChallengeName:e,ChallengeParameters:s,AuthenticationResult:o,Session:l}=await async function(e,t,n,r,a){return Qa({username:e,password:t,clientMetadata:n,config:r,tokenOrchestrator:a,authFlow:"USER_SRP_AUTH"})}(t,n,i,r,or),c=ii(t);return Yr({signInSession:l,username:c,challengeName:e,signInDetails:a}),o?(await $r({username:c,...o,NewDeviceMetadata:await Da({userPoolId:r.userPoolId,userPoolEndpoint:r.userPoolEndpoint,newDeviceMetadata:o.NewDeviceMetadata,accessToken:o.AccessToken}),signInDetails:a}),Hr(),await Br(),hi(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Xa({challengeName:e,challengeParameters:s})}catch(s){Hr(),hi(),en(s);const e=ei(s.name);if(e)return e;throw s}}async function mi(e){const{username:t,password:n,options:r}=e,a=Te.getConfig().Auth?.Cognito,i={loginId:t,authFlowType:"USER_AUTH"};Kt(a);const s=r?.clientMetadata,o=r?.preferredChallenge;si(!!t,Mr.EmptySignInUsername);try{const e={username:t,config:a,tokenOrchestrator:or,clientMetadata:s,preferredChallenge:o,password:n},r=li.getState();r.active&&r.username===t&&(e.session=r.session);const l=await async function(e){let{username:t,clientMetadata:n,config:r,tokenOrchestrator:a,preferredChallenge:i,password:s,session:o}=e;const{userPoolId:l,userPoolClientId:c,userPoolEndpoint:u}=r,d=Qn({username:t,userPoolId:l,userPoolClientId:c}),h={USERNAME:t};if(i){if("PASSWORD_SRP"===i)return si(!!s,Mr.EmptySignInPassword),Qa({username:t,password:s,clientMetadata:n,config:r,tokenOrchestrator:a,authFlow:"USER_AUTH",preferredChallenge:i});"PASSWORD"===i&&(si(!!s,Mr.EmptySignInPassword),h.PASSWORD=s),h.PREFERRED_CHALLENGE=i}const p={AuthFlow:"USER_AUTH",AuthParameters:h,ClientMetadata:n,ClientId:c,UserContextData:d};o&&(p.Session=o);const m=Gn({endpointResolver:Wn({endpointOverride:u})}),f=await m({region:tn(l),userAgentValue:qr(Me.SignIn)},p);return Wa(t),f}(e),c=ii(t);return Yr({signInSession:l.Session,username:c,challengeName:l.ChallengeName,signInDetails:i}),l.AuthenticationResult?(await $r({username:c,...l.AuthenticationResult,NewDeviceMetadata:await Da({userPoolId:a.userPoolId,userPoolEndpoint:a.userPoolEndpoint,newDeviceMetadata:l.AuthenticationResult.NewDeviceMetadata,accessToken:l.AuthenticationResult.AccessToken}),signInDetails:i}),Hr(),await Br(),hi(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Xa({challengeName:l.ChallengeName,challengeParameters:l.ChallengeParameters,availableChallenges:"AvailableChallenges"in l?l.AvailableChallenges:void 0})}catch(l){Hr(),hi(),en(l);const e=ei(l.name);if(e)return e;throw l}}async function fi(e){hi(!1);const t=e.options?.authFlowType;switch(await async function(){let e;try{e=await cr()}catch(t){}if(e&&e.userId&&e.username)throw new Zt({name:"UserAlreadyAuthenticatedException",message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}(),t){case"USER_SRP_AUTH":default:return pi(e);case"USER_PASSWORD_AUTH":return async function(e){const{username:t,password:n,options:r}=e,a=Te.getConfig().Auth?.Cognito,i={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};Kt(a);const s=r?.clientMetadata;si(!!t,Mr.EmptySignInUsername),si(!!n,Mr.EmptySignInPassword);try{const{ChallengeName:e,ChallengeParameters:r,AuthenticationResult:o,Session:l}=await Ga(Ya,[t,n,s,a,or],t,or),c=ii(t);return Yr({signInSession:l,username:c,challengeName:e,signInDetails:i}),o?(await $r({...o,username:c,NewDeviceMetadata:await Da({userPoolId:a.userPoolId,userPoolEndpoint:a.userPoolEndpoint,newDeviceMetadata:o.NewDeviceMetadata,accessToken:o.AccessToken}),signInDetails:i}),Hr(),await Br(),hi(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Xa({challengeName:e,challengeParameters:r})}catch(o){Hr(),hi(),en(o);const e=ei(o.name);if(e)return e;throw o}}(e);case"CUSTOM_WITHOUT_SRP":return async function(e){const t=Te.getConfig().Auth?.Cognito;Kt(t);const{username:n,password:r,options:a}=e,i={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},s=a?.clientMetadata;si(!!n,Mr.EmptySignInUsername),si(!r,Mr.CustomAuthSignInPassword);try{const{ChallengeName:e,ChallengeParameters:r,AuthenticationResult:a,Session:o}=await Ga(Ja,[n,s,t,or],n,or),l=ii(n);return Yr({signInSession:o,username:l,challengeName:e,signInDetails:i}),a?(await $r({username:l,...a,NewDeviceMetadata:await Da({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:a.NewDeviceMetadata,accessToken:a.AccessToken}),signInDetails:i}),Hr(),await Br(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Xa({challengeName:e,challengeParameters:r})}catch(o){Hr(),en(o);const e=ei(o.name);if(e)return e;throw o}}(e);case"CUSTOM_WITH_SRP":return oi(e);case"USER_AUTH":return mi(e)}}function gi(e){return Object.entries(e).map(e=>{let[t,n]=e;return{Name:t,Value:n}})}const yi=18e4;function vi(e,t){let n;return r=>{n||e(...r),clearTimeout(n),n=setTimeout(()=>{n=void 0},t)}}const xi=vi(function(e,t,n){const r=Date.now(),a=setInterval(async()=>{if(Date.now()-r>yi)clearInterval(a),n(new Zt({name:an,message:"The account was not confirmed on time.",recoverySuggestion:"Try to verify your account by clicking the link sent your email or phone and then login manually."})),hi();else try{const n=await fi(e);"CONFIRM_SIGN_UP"!==n.nextStep.signInStep&&(t(n),clearInterval(a),hi())}catch(i){clearInterval(a),n(i),hi()}},5e3)},300),bi=vi(async function(e,t,n){try{t("USER_AUTH"===e?.options?.authFlowType?await mi(e):await fi(e)),hi()}catch(r){n(r),hi()}},300);function Ei(e){return async()=>new Promise((t,n)=>{bi([e,t,n])})}const Si=Ei,wi=e=>dt(zn,qn("SignUp"),async e=>{if(e.statusCode>=300){const t=await ct(e);if(en(t),t.name===Tr.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const e=Mr.EmptySignUpPassword,{message:t,recoverySuggestion:n}=Lr[e];throw new Zt({name:e,message:t,recoverySuggestion:n})}throw new Zt({name:t.name,message:t.message})}return ut(e)},{...Hn,...e});async function Ni(e){const{username:t,password:n,options:r}=e,a=Te.getConfig().Auth?.Cognito,i=a?.signUpVerificationMethod??"code",{clientMetadata:s,validationData:o,autoSignIn:l}=e.options??{};Kt(a),si(!!t,Mr.EmptySignUpUsername);const c="boolean"!==typeof l?l:void 0,u={username:t,options:c};"CUSTOM_WITHOUT_SRP"!==c?.authFlowType&&(u.password=n);const{userPoolId:d,userPoolClientId:h,userPoolEndpoint:p}=a,m=wi({endpointResolver:Wn({endpointOverride:p})}),f={Username:t,Password:void 0,UserAttributes:r?.userAttributes&&gi(r?.userAttributes),ClientMetadata:s,ValidationData:o&&gi(o),ClientId:h,UserContextData:Qn({username:t,userPoolId:d,userPoolClientId:h})};n&&(f.Password=n);const{UserSub:g,CodeDeliveryDetails:y,UserConfirmed:v,Session:x}=await m({region:tn(d),userAgentValue:qr(Me.SignUp)},f);(c||!0===l)&&(li.dispatch({type:"START"}),li.dispatch({type:"SET_USERNAME",value:t}),li.dispatch({type:"SET_SESSION",value:x}));const b={destination:y?.Destination,deliveryMedium:y?.DeliveryMedium,attributeName:y?.AttributeName},E=!!v,S=li.getState().active;if(E)return S?(di(Si(u)),{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:g}):{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:g};if(S){if("link"===i)return di(function(e){return async()=>new Promise((t,n)=>{xi([e,t,n])})}(u)),{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:b},userId:g};!function(e){const t=X.listen("auth-internal",async n=>{let{payload:r}=n;if("confirmSignUp"===r.event){const n=r.data;n?.isSignUpComplete&&(X.dispatch("auth-internal",{event:"autoSignIn"}),di(Ei(e)),t())}}),n=setTimeout(()=>{t(),clearTimeout(n),hi()},yi)}(u)}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:b},userId:g}}async function ki(e){const{username:t,confirmationCode:n,options:r}=e,a=Te.getConfig().Auth?.Cognito;Kt(a);const{userPoolId:i,userPoolClientId:s,userPoolEndpoint:o}=a,l=r?.clientMetadata;si(!!t,Mr.EmptyConfirmSignUpUsername),si(!!n,Mr.EmptyConfirmSignUpCode);const c=Qn({username:t,userPoolId:i,userPoolClientId:s}),u=(d={endpointResolver:Wn({endpointOverride:o})},dt(zn,qn("ConfirmSignUp"),Bn(),{...Hn,...d}));var d;const{Session:h}=await u({region:tn(a.userPoolId),userAgentValue:qr(Me.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:l,ForceAliasCreation:r?.forceAliasCreation,ClientId:a.userPoolClientId,UserContextData:c});return new Promise((e,n)=>{try{const n={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},r=li.getState();if(!r.active||r.username!==t)return e(n),void hi();li.dispatch({type:"SET_SESSION",value:h});const a=X.listen("auth-internal",t=>{let{payload:n}=t;if("autoSignIn"===n.event)e({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),a()});X.dispatch("auth-internal",{event:"confirmSignUp",data:n})}catch(r){n(r)}})}async function Ci(e){const{username:t}=e;si(!!t,Mr.EmptyResetPasswordUsername);const n=Te.getConfig().Auth?.Cognito;Kt(n);const{userPoolClientId:r,userPoolId:a,userPoolEndpoint:i}=n,s=e.options?.clientMetadata,o=Qn({username:t,userPoolId:a,userPoolClientId:r}),l=(c={endpointResolver:Wn({endpointOverride:i})},dt(zn,qn("ForgotPassword"),Bn(),{...Hn,...c}));var c;const u=(await l({region:tn(a),userAgentValue:qr(Me.ResetPassword)},{Username:t,ClientMetadata:s,ClientId:r,UserContextData:o})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:u?.DeliveryMedium,destination:u?.Destination,attributeName:u?.AttributeName}}}}async function Ii(e){const t=Te.getConfig().Auth?.Cognito;Kt(t);const{userPoolClientId:n,userPoolId:r,userPoolEndpoint:a}=t,{username:i,newPassword:s}=e;si(!!i,Mr.EmptyConfirmResetPasswordUsername),si(!!s,Mr.EmptyConfirmResetPasswordNewPassword);const o=e.confirmationCode;si(!!o,Mr.EmptyConfirmResetPasswordConfirmationCode);const l=e.options?.clientMetadata,c=Qn({username:i,userPoolId:r,userPoolClientId:n}),u=(d={endpointResolver:Wn({endpointOverride:a})},dt(zn,qn("ConfirmForgotPassword"),Bn(),{...Hn,...d}));var d;await u({region:tn(t.userPoolId),userAgentValue:qr(Me.ConfirmResetPassword)},{Username:i,ConfirmationCode:o,Password:s,ClientMetadata:l,ClientId:t.userPoolClientId,UserContextData:c})}function Ai(){return Te.Auth.clearCredentials()}const Ti=async e=>{await e.clearOAuthData(),or.clearTokens(),await Ai(),J.dispatch("auth",{event:"signedOut"},"Auth",Q)};const Ri=e=>e.startsWith(String(window.location.origin+(window.location.pathname||"/"))),ji=e=>e.includes(String(window.location.hostname)),_i=e=>e.startsWith("http://"),Pi=e=>e.startsWith("https://"),Oi=async function(e){let t=arguments.length>2?arguments[2]:void 0;Yt(e);const{loginWith:n,userPoolClientId:r}=e,{domain:a,redirectSignOut:i}=n.oauth,s=function(e,t){if(t){const n=e?.find(e=>e===t);if(!n)throw on;return n}{const t=e?.find(Ri)??e?.find(ji),n=e?.find(Pi)??e?.find(_i);if(t)return t;if(n)throw ln;throw sn}}(i,t);return(async e=>{window?.location&&(window.location.href=e.replace("http://","https://"))})(`https://${a}/logout?${Object.entries({client_id:r,logout_uri:encodeURIComponent(s)}).map(e=>{let[t,n]=e;return`${t}=${n}`}).join("&")}`)},Mi=new $("Auth");async function Li(e){const t=Te.getConfig().Auth?.Cognito;let n;Kt(t),e?.global?await async function(e){try{const{userPoolEndpoint:n,userPoolId:r}=e,a=await or.getTokenStore().loadTokens();cn(a);const i=(t={endpointResolver:Wn({endpointOverride:n})},dt(zn,qn("GlobalSignOut"),Bn(),{...Hn,...t}));await i({region:tn(r),userAgentValue:qr(Me.SignOut)},{AccessToken:a.accessToken.toString()})}catch(n){Mi.debug("Global signOut error caught but will proceed with token removal")}var t}(t):await async function(e){try{const{userPoolEndpoint:n,userPoolId:r,userPoolClientId:a}=e,i=await or.getTokenStore().loadTokens();if(hn(i),Ui(i.accessToken)){const e=(t={endpointResolver:Wn({endpointOverride:n})},dt(zn,qn("RevokeToken"),Bn(),{...Hn,...t}));await e({region:tn(r),userAgentValue:qr(Me.SignOut)},{ClientId:a,Token:i.refreshToken})}}catch(n){Mi.debug("Client signOut error caught but will proceed with token removal")}var t}(t);try{Yt(t),n=!0}catch(r){n=!1}if(n){const n=new tr(G);n.setAuthConfig(t);const{type:r}=await(async(e,t,n,r)=>{const{isOAuthSignIn:a}=await t.loadOAuthSignIn(),i=await n.getOAuthMetadata();if(await Ti(t),a||i?.oauthSignIn)return Oi(e,!1,r)})(t,n,or,e?.oauth?.redirectUrl)??{};if("error"===r)throw new Zt({name:"OAuthSignOutException",message:"An error occurred when attempting to log out from OAuth provider."})}else or.clearTokens(),await Ai(),J.dispatch("auth",{event:"signedOut"},"Auth",Q)}const Ui=e=>!!e?.payload?.origin_jti;console.log("Configuring AWS Amplify for Cognito authentication"),lr.configure({Auth:{Cognito:{userPoolId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_USER_POOL_ID||"",userPoolClientId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_USER_POOL_CLIENT_ID||"",identityPoolId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_IDENTITY_POOL_ID||"",loginWith:{email:!0}}}});class Di{constructor(){if(this.currentUser=null,this.authTokens=null,this.SESSION_STORAGE_KEY="steampunk_idle_session",this.USER_STORAGE_KEY="steampunk_idle_user",Di.instance)return Di.instance;Di.instance=this,this.restoreSession()}restoreSession(){try{const e=localStorage.getItem(this.SESSION_STORAGE_KEY),t=localStorage.getItem(this.USER_STORAGE_KEY);if(e&&t){const n=JSON.parse(e),r=JSON.parse(t);if(n.expiresAt&&new Date(n.expiresAt)>new Date)return this.authTokens=n.tokens,this.currentUser=r,void console.log("Session restored from persistent localStorage");this.clearStoredSession()}const n=localStorage.getItem("mockAuthSession");if(n){const e=JSON.parse(n);if(e.user&&e.tokens)return this.currentUser=e.user,this.authTokens=e.tokens,this.storeSession(e.user,e.tokens),void console.log("Session restored from mock auth (dev mode)")}}catch(e){console.error("Failed to restore session:",e),this.clearStoredSession();try{localStorage.removeItem("mockAuthSession")}catch(t){console.error("Failed to clear mock session:",t)}}}storeSession(e,t){try{const n={tokens:t,expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem(this.SESSION_STORAGE_KEY,JSON.stringify(n)),localStorage.setItem(this.USER_STORAGE_KEY,JSON.stringify(e))}catch(n){console.error("Failed to store session:",n)}}clearStoredSession(){try{localStorage.removeItem(this.SESSION_STORAGE_KEY),localStorage.removeItem(this.USER_STORAGE_KEY),localStorage.removeItem("mockAuthSession")}catch(e){console.error("Failed to clear stored session:",e)}}async initializeAuth(){try{if(console.log("AuthService: Initializing authentication"),this.currentUser&&this.authTokens)return console.log("AuthService: Session restored from localStorage"),{user:this.currentUser,tokens:this.authTokens};try{const r=await cr(),a=await ur();if(r&&a.tokens){var e,t,n;const i={userId:r.userId,email:(null===(e=r.signInDetails)||void 0===e?void 0:e.loginId)||"",name:r.username,socialProviders:[],lastLogin:(new Date).toISOString()},s={accessToken:(null===(t=a.tokens.accessToken)||void 0===t?void 0:t.toString())||"",idToken:(null===(n=a.tokens.idToken)||void 0===n?void 0:n.toString())||"",refreshToken:"refresh-token-placeholder",expiresIn:3600,tokenType:"Bearer"};return this.currentUser=i,this.authTokens=s,this.storeSession(i,s),console.log("AuthService: Successfully restored AWS Cognito session"),{user:i,tokens:s}}}catch(r){console.log("AuthService: No AWS Cognito session found")}return console.log("AuthService: No existing session found"),null}catch(a){return console.log("AuthService: No existing session or session expired"),null}}async loginWithEmail(e,t){try{console.log("AuthService: Attempting AWS Cognito login for:",e);if((await fi({username:e,password:t})).isSignedIn){var n,r;const t=await cr(),a=await ur();if(!a.tokens)throw new Error("Failed to retrieve authentication tokens");const i={userId:t.userId,email:e,name:t.username,socialProviders:[],lastLogin:(new Date).toISOString()},s={accessToken:(null===(n=a.tokens.accessToken)||void 0===n?void 0:n.toString())||"",idToken:(null===(r=a.tokens.idToken)||void 0===r?void 0:r.toString())||"",refreshToken:"refresh-token-placeholder",expiresIn:3600,tokenType:"Bearer"};return this.currentUser=i,this.authTokens=s,this.storeSession(i,s),console.log("AuthService: AWS Cognito login successful"),{user:i,tokens:s}}throw new Error("Sign in was not completed")}catch(a){throw console.error("AuthService: AWS Cognito login failed:",a),this.handleAuthError(a)}}async registerWithEmail(e,t){try{console.log("AuthService: Attempting AWS Cognito registration for:",e);const n=await Ni({username:e,password:t,options:{userAttributes:{email:e}}});return console.log("AuthService: AWS Cognito registration initiated"),{requiresConfirmation:!n.isSignUpComplete}}catch(n){throw console.error("AuthService: AWS Cognito registration failed:",n),this.handleAuthError(n)}}async confirmEmail(e,t){try{console.log("AuthService: Confirming AWS Cognito email for:",e),await ki({username:e,confirmationCode:t}),console.log("AuthService: AWS Cognito email confirmation successful")}catch(n){throw console.error("AuthService: AWS Cognito email confirmation failed:",n),this.handleAuthError(n)}}async requestPasswordReset(e){try{console.log("AuthService: Requesting AWS Cognito password reset for:",e),await Ci({username:e}),console.log("AuthService: AWS Cognito password reset request sent")}catch(t){throw console.error("AuthService: AWS Cognito password reset request failed:",t),this.handleAuthError(t)}}async confirmPasswordReset(e,t,n){try{console.log("AuthService: Confirming AWS Cognito password reset for:",e),await Ii({username:e,confirmationCode:t,newPassword:n}),console.log("AuthService: AWS Cognito password reset successful")}catch(r){throw console.error("AuthService: AWS Cognito password reset confirmation failed:",r),this.handleAuthError(r)}}getCurrentUser(){return this.currentUser||this.restoreSession(),this.currentUser}getAuthTokens(){return this.authTokens}isAuthenticated(){return this.currentUser&&this.authTokens||this.restoreSession(),null!==this.currentUser&&null!==this.authTokens}async logout(e){try{console.log("AuthService: Logging out from AWS Cognito"),await Li(),this.currentUser=null,this.authTokens=null,this.clearStoredSession(),console.log("AuthService: AWS Cognito logout successful")}catch(t){throw console.error("AuthService: AWS Cognito logout failed:",t),this.currentUser=null,this.authTokens=null,this.clearStoredSession(),this.handleAuthError(t)}}async handleOAuthCallback(){try{console.log("AuthService: Handling OAuth callback");const e=await this.initializeAuth();if(e)return console.log("AuthService: OAuth callback successful"),e;throw new Error("No valid session found after OAuth callback")}catch(e){throw console.error("AuthService: OAuth callback failed:",e),this.handleAuthError(e)}}isTokenExpired(e){try{const t=JSON.parse(atob(e.accessToken.split(".")[1])),n=Math.floor(Date.now()/1e3);return t.exp<n}catch(t){return console.error("AuthService: Error checking token expiration:",t),!0}}async refreshToken(e){try{var t,n;console.log("AuthService: Refreshing AWS Cognito tokens");const e=await ur({forceRefresh:!0});if(!e.tokens)throw new Error("Failed to refresh tokens");const r={accessToken:(null===(t=e.tokens.accessToken)||void 0===t?void 0:t.toString())||"",idToken:(null===(n=e.tokens.idToken)||void 0===n?void 0:n.toString())||"",refreshToken:"refresh-token-placeholder",expiresIn:3600,tokenType:"Bearer"};return this.authTokens=r,this.currentUser&&this.storeSession(this.currentUser,r),console.log("AuthService: AWS Cognito token refresh successful"),r}catch(r){throw console.error("AuthService: AWS Cognito token refresh failed:",r),this.handleAuthError(r)}}async loginWithGoogle(){try{throw console.log("AuthService: Initiating Google login via AWS Cognito"),new Error("Google login requires AWS Cognito social provider configuration")}catch(e){throw console.error("AuthService: Google login failed:",e),this.handleAuthError(e)}}async loginWithFacebook(){try{throw console.log("AuthService: Initiating Facebook login via AWS Cognito"),new Error("Facebook login requires AWS Cognito social provider configuration")}catch(e){throw console.error("AuthService: Facebook login failed:",e),this.handleAuthError(e)}}async loginWithX(){try{throw console.log("AuthService: Initiating X/Twitter login via AWS Cognito"),new Error("X/Twitter login requires AWS Cognito social provider configuration")}catch(e){throw console.error("AuthService: X/Twitter login failed:",e),this.handleAuthError(e)}}handleAuthError(e){const t=new Error(e.message||"Authentication failed");return t.name=e.name||"AuthError",t.code=e.code,t}async validateSession(){try{if(!this.authTokens)return!1;const e=localStorage.getItem(this.SESSION_STORAGE_KEY);if(e){const t=JSON.parse(e);if(t.expiresAt&&new Date(t.expiresAt)<=new Date)return this.clearStoredSession(),this.currentUser=null,this.authTokens=null,!1}return!0}catch(e){return console.error("Session validation failed:",e),this.clearStoredSession(),this.currentUser=null,this.authTokens=null,!1}}async sendHeartbeat(){try{if(!this.authTokens)return;await this.validateSession()}catch(e){console.error("Heartbeat failed:",e)}}getAuthStatus(){return{isAuthenticated:this.isAuthenticated(),user:this.currentUser,hasValidTokens:null!==this.authTokens}}}Di.instance=void 0;const qi=new Di;const Fi=new class{constructor(){this.status={isInitialized:!1,isInitializing:!1,currentStep:null,completedSteps:[],failedSteps:[],errors:[],progress:0},this.config={enableProgressiveLoading:!0,skipNonCriticalOnError:!0,maxRetries:3,retryDelay:1e3},this.listeners=[],this.steps=[],this.setupInitializationSteps()}setupInitializationSteps(){this.steps=[{id:"store-validation",name:"Store Validation",description:"Validating Redux store configuration",required:!0,timeout:5e3,execute:this.validateStore.bind(this)},{id:"network-check",name:"Network Check",description:"Checking network connectivity",required:!1,timeout:3e3,execute:this.checkNetworkConnectivity.bind(this)},{id:"auth-initialization",name:"Authentication",description:"Initializing authentication system",required:!0,timeout:1e4,execute:this.initializeAuthentication.bind(this)},{id:"service-health",name:"Service Health",description:"Checking external service availability",required:!1,timeout:5e3,execute:this.checkServiceHealth.bind(this)},{id:"local-storage",name:"Local Storage",description:"Validating local storage access",required:!0,timeout:2e3,execute:this.validateLocalStorage.bind(this)},{id:"feature-flags",name:"Feature Flags",description:"Loading feature configuration",required:!1,timeout:3e3,execute:this.loadFeatureFlags.bind(this)}]}async initialize(){if(this.status.isInitializing||this.status.isInitialized)return this.status;this.status.isInitializing=!0,this.status.currentStep=null,this.status.completedSteps=[],this.status.failedSteps=[],this.status.errors=[],this.status.progress=0,this.notifyListeners();try{for(let t=0;t<this.steps.length;t++){const n=this.steps[t];this.status.currentStep=n.id,this.status.progress=t/this.steps.length*100,this.notifyListeners();try{await this.executeStepWithRetry(n),this.status.completedSteps.push(n.id)}catch(e){const t=e instanceof Error?e.message:String(e);if(this.status.failedSteps.push(n.id),this.status.errors.push({step:n.id,error:t,timestamp:new Date,recoverable:!n.required}),n.required&&!this.config.skipNonCriticalOnError)throw new Error(`Critical initialization step failed: ${n.name} - ${t}`);console.warn(`Non-critical initialization step failed: ${n.name} - ${t}`)}}this.status.isInitialized=!0,this.status.progress=100}catch(e){const t=e instanceof Error?e.message:String(e);console.error("Application initialization failed:",t),this.status.errors.push({step:"initialization",error:t,timestamp:new Date,recoverable:!1})}finally{this.status.isInitializing=!1,this.status.currentStep=null,this.notifyListeners()}return this.status}async executeStepWithRetry(e){let t=null;for(let r=1;r<=this.config.maxRetries;r++)try{return void(e.timeout?await this.executeWithTimeout(e.execute,e.timeout):await e.execute())}catch(n){t=n instanceof Error?n:new Error(String(n)),r<this.config.maxRetries&&(console.warn(`Step ${e.id} failed (attempt ${r}/${this.config.maxRetries}):`,t.message),await this.delay(this.config.retryDelay*r))}throw t}async executeWithTimeout(e,t){return new Promise((n,r)=>{const a=setTimeout(()=>{r(new Error(`Operation timed out after ${t}ms`))},t);e().then(()=>{clearTimeout(a),n()}).catch(e=>{clearTimeout(a),r(e)})})}delay(e){return new Promise(t=>setTimeout(t,e))}async validateStore(){try{const e=j.getState();if(!e||"object"!==typeof e)throw new Error("Invalid Redux store state");if(!e.auth||!e.game||!e.chat)throw new Error("Missing required Redux slices");console.log("Redux store validation successful")}catch(e){throw new Error(`Store validation failed: ${e}`)}}async checkNetworkConnectivity(){try{if(!navigator.onLine)throw new Error("Device is offline");await fetch("https://www.google.com/favicon.ico",{method:"HEAD",mode:"no-cors",cache:"no-cache"}),console.log("Network connectivity check successful")}catch(e){throw console.warn("Network connectivity check failed, continuing in offline mode"),new Error(`Network connectivity check failed: ${e}`)}}async initializeAuthentication(){try{const e=await qi.initializeAuth();if(e){console.log("Authentication initialized with existing session");const{loginSuccess:t}=await Promise.resolve().then(n.bind(n,9));j.dispatch(t(e)),await this.loadUserCharacter(e.user.userId)}else console.log("Authentication initialized without existing session")}catch(e){throw new Error(`Authentication initialization failed: ${e}`)}}async loadUserCharacter(e){try{const{CharacterService:t}=await Promise.resolve().then(n.bind(n,142)),r=await t.getCharacter(e);if(r){console.log("Character loaded for user:",e);const{setCharacter:t}=await Promise.resolve().then(n.bind(n,421));j.dispatch(t(r))}else{console.log("No character found for user:",e);const{setLoading:t}=await Promise.resolve().then(n.bind(n,421));j.dispatch(t(!1))}}catch(t){console.error("Failed to load character:",t)}}async checkServiceHealth(){try{const e=`${"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod"}/health`;console.log("[InitializationManager] Checking service health at:",e);const t=new AbortController,n=setTimeout(()=>t.abort(),5e3),r=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},signal:t.signal});if(clearTimeout(n),console.log("[InitializationManager] Health check response status:",r.status),console.log("[InitializationManager] Health check response ok:",r.ok),!r.ok)throw new Error(`API health check failed with status: ${r.status}`);const a=await r.json();console.log("[InitializationManager] Health check data:",a),console.log("[InitializationManager] Service health check successful")}catch(e){throw console.error("[InitializationManager] Service health check failed:",e),new Error(`Service health check failed: ${e}`)}}async validateLocalStorage(){try{if("undefined"===typeof window||!window.localStorage)throw new Error("Local storage is not available");const e="__init_test__",t="test";localStorage.setItem(e,t);const n=localStorage.getItem(e);if(localStorage.removeItem(e),n!==t)throw new Error("Local storage read/write test failed");console.log("Local storage validation successful")}catch(e){throw new Error(`Local storage validation failed: ${e}`)}}async loadFeatureFlags(){try{const e={enableOfflineMode:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_ENABLE_OFFLINE_MODE,enableDebugMode:!1,enableMockAuth:!1};"undefined"!==typeof window&&(window.__FEATURE_FLAGS__=e),console.log("Feature flags loaded:",e)}catch(e){throw new Error(`Feature flags loading failed: ${e}`)}}getStatus(){return{...this.status}}isInitialized(){return this.status.isInitialized}isInitializing(){return this.status.isInitializing}hasErrors(){return this.status.errors.length>0}getCriticalErrors(){return this.status.errors.filter(e=>!e.recoverable)}addListener(e){return this.listeners.push(e),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}notifyListeners(){this.listeners.forEach(e=>{try{e({...this.status})}catch(t){console.error("Error in initialization status listener:",t)}})}async retryFailedSteps(){if(this.status.isInitializing)throw new Error("Cannot retry while initialization is in progress");const e=this.steps.filter(e=>this.status.failedSteps.includes(e.id));if(0!==e.length){console.log(`Retrying ${e.length} failed initialization steps`);for(const n of e)try{this.status.currentStep=n.id,this.notifyListeners(),await this.executeStepWithRetry(n);const e=this.status.failedSteps.indexOf(n.id);e>-1&&this.status.failedSteps.splice(e,1),this.status.completedSteps.includes(n.id)||this.status.completedSteps.push(n.id),this.status.errors=this.status.errors.filter(e=>e.step!==n.id)}catch(t){console.error(`Retry failed for step ${n.id}:`,t)}this.status.currentStep=null,this.status.isInitialized=0===this.status.failedSteps.length,this.notifyListeners()}}reset(){this.status={isInitialized:!1,isInitializing:!1,currentStep:null,completedSteps:[],failedSteps:[],errors:[],progress:0},this.notifyListeners()}};var $i=n(414);const Bi=e=>{let{onRecoveryComplete:t,onSkipRecovery:n}=e;const[a,i]=(0,r.useState)(!1),[s,o]=(0,r.useState)("");return a?(0,$i.jsx)("div",{className:"recovery-overlay",children:(0,$i.jsxs)("div",{className:"recovery-content",children:[(0,$i.jsx)("div",{className:"recovery-spinner"}),(0,$i.jsx)("h3",{children:"Recovery in Progress"}),(0,$i.jsx)("p",{children:s})]})}):(0,$i.jsxs)("div",{className:"recovery-options",children:[(0,$i.jsx)("h3",{children:"Recovery Options"}),(0,$i.jsx)("p",{children:"Try these recovery methods to resolve startup issues:"}),(0,$i.jsxs)("div",{className:"recovery-buttons",children:[(0,$i.jsx)("button",{className:"recovery-button safe",onClick:async()=>{i(!0),o("Clearing application cache...");try{if("undefined"!==typeof window&&window.localStorage){const e=["mockUsers","mockAuthSession"];Object.keys(localStorage).forEach(t=>{e.includes(t)||localStorage.removeItem(t)})}if("undefined"!==typeof window&&window.sessionStorage&&sessionStorage.clear(),"caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}o("Cache cleared successfully"),setTimeout(()=>{i(!1),t()},1e3)}catch(e){console.error("Cache clearing failed:",e),o("Cache clearing failed"),setTimeout(()=>{i(!1)},2e3)}},title:"Clear cached data but keep user settings",children:"Clear Cache"}),(0,$i.jsx)("button",{className:"recovery-button moderate",onClick:async()=>{i(!0),o("Resetting initialization state...");try{Fi.reset(),o("Initialization reset complete"),setTimeout(()=>{i(!1),t()},1e3)}catch(e){console.error("Initialization reset failed:",e),o("Reset failed"),setTimeout(()=>{i(!1)},2e3)}},title:"Reset the initialization process",children:"Reset Initialization"}),(0,$i.jsx)("button",{className:"recovery-button reload",onClick:()=>{window.location.reload()},title:"Reload the page",children:"Reload Page"}),(0,$i.jsx)("button",{className:"recovery-button destructive",onClick:async()=>{i(!0),o("Performing full application reset...");try{if("undefined"!==typeof window&&(window.localStorage&&localStorage.clear(),window.sessionStorage&&sessionStorage.clear()),"caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}Fi.reset(),o("Full reset complete - reloading..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){console.error("Full reset failed:",e),o("Full reset failed"),setTimeout(()=>{i(!1)},2e3)}},title:"Clear all data and reset everything",children:"Full Reset"})]}),(0,$i.jsx)("div",{className:"recovery-actions",children:(0,$i.jsx)("button",{className:"skip-button",onClick:n,children:"Skip Recovery & Continue"})}),(0,$i.jsxs)("div",{className:"recovery-info",children:[(0,$i.jsx)("h4",{children:"What each option does:"}),(0,$i.jsxs)("ul",{children:[(0,$i.jsxs)("li",{children:[(0,$i.jsx)("strong",{children:"Clear Cache:"})," Removes cached data but keeps your login and settings"]}),(0,$i.jsxs)("li",{children:[(0,$i.jsx)("strong",{children:"Reset Initialization:"})," Restarts the startup process from the beginning"]}),(0,$i.jsxs)("li",{children:[(0,$i.jsx)("strong",{children:"Reload Page:"})," Refreshes the entire application"]}),(0,$i.jsxs)("li",{children:[(0,$i.jsx)("strong",{children:"Full Reset:"})," Clears all data and returns to a fresh state"]})]})]})]})},zi=e=>{let{onInitializationComplete:t}=e;const[n,a]=(0,r.useState)(Fi.getStatus()),[i,s]=(0,r.useState)(!1),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(0);(0,r.useEffect)(()=>{const e=Fi.addListener(a);return n.isInitializing||n.isInitialized||Fi.initialize().then(e=>{setTimeout(()=>{t(e.isInitialized)},1e3)}),e},[t,n.isInitializing,n.isInitialized]);const d=async()=>{u(e=>e+1);try{await Fi.retryFailedSteps();Fi.getStatus().isInitialized&&setTimeout(()=>{t(!0)},1e3)}catch(e){console.error("Retry failed:",e)}},h=()=>{t(!0)},p=n.errors.filter(e=>!e.recoverable),m=n.errors.some(e=>e.recoverable),f=p.length>0;return n.isInitialized&&0===n.errors.length?(0,$i.jsx)("div",{className:"startup-screen startup-success",children:(0,$i.jsxs)("div",{className:"startup-content",children:[(0,$i.jsx)("div",{className:"startup-icon success",children:"\u2713"}),(0,$i.jsx)("h2",{children:"Ready to Play!"}),(0,$i.jsx)("p",{children:"Application initialized successfully"}),(0,$i.jsx)("div",{className:"progress-bar",children:(0,$i.jsx)("div",{className:"progress-fill",style:{width:"100%"}})})]})}):!n.isInitializing&&f?(0,$i.jsx)("div",{className:"startup-screen startup-error",children:(0,$i.jsxs)("div",{className:"startup-content",children:[(0,$i.jsx)("div",{className:"startup-icon error",children:"\u26a0"}),(0,$i.jsx)("h2",{children:"Startup Failed"}),(0,$i.jsx)("p",{children:"Critical errors prevented the application from starting properly."}),(0,$i.jsx)("div",{className:"error-summary",children:p.map((e,t)=>(0,$i.jsxs)("div",{className:"error-item critical",children:[(0,$i.jsxs)("strong",{children:[e.step,":"]})," ",e.error]},t))}),(0,$i.jsxs)("div",{className:"startup-actions",children:[(0,$i.jsx)("button",{className:"retry-button",onClick:d,disabled:c>=3,children:c>=3?"Max Retries Reached":`Retry (${c}/3)`}),(0,$i.jsx)("button",{className:"details-button",onClick:()=>s(!i),children:i?"Hide Details":"Show Details"}),c>=2&&(0,$i.jsx)("button",{className:"recovery-button",onClick:()=>l(!0),children:"Advanced Recovery"})]}),i&&(0,$i.jsxs)("div",{className:"startup-details",children:[(0,$i.jsx)("h3",{children:"Initialization Steps"}),(0,$i.jsxs)("div",{className:"steps-list",children:[n.completedSteps.map(e=>(0,$i.jsxs)("div",{className:"step-item completed",children:["\u2713 ",e]},e)),n.failedSteps.map(e=>(0,$i.jsxs)("div",{className:"step-item failed",children:["\u2717 ",e]},e))]})]})]})}):!n.isInitializing&&m?(0,$i.jsx)("div",{className:"startup-screen startup-warning",children:(0,$i.jsxs)("div",{className:"startup-content",children:[(0,$i.jsx)("div",{className:"startup-icon warning",children:"\u26a0"}),(0,$i.jsx)("h2",{children:"Partial Initialization"}),(0,$i.jsx)("p",{children:"Some features may not be available, but you can continue using the application."}),(0,$i.jsx)("div",{className:"error-summary",children:n.errors.filter(e=>e.recoverable).map((e,t)=>(0,$i.jsxs)("div",{className:"error-item recoverable",children:[(0,$i.jsxs)("strong",{children:[e.step,":"]})," ",e.error]},t))}),(0,$i.jsxs)("div",{className:"startup-actions",children:[(0,$i.jsx)("button",{className:"continue-button primary",onClick:h,children:"Continue Anyway"}),(0,$i.jsx)("button",{className:"retry-button",onClick:d,disabled:c>=3,children:c>=3?"Max Retries Reached":`Retry Failed Steps (${c}/3)`})]}),i&&(0,$i.jsxs)("div",{className:"startup-details",children:[(0,$i.jsx)("h3",{children:"Initialization Status"}),(0,$i.jsxs)("div",{className:"steps-list",children:[n.completedSteps.map(e=>(0,$i.jsxs)("div",{className:"step-item completed",children:["\u2713 ",e]},e)),n.failedSteps.map(e=>(0,$i.jsxs)("div",{className:"step-item failed",children:["\u2717 ",e]},e))]})]})]})}):(0,$i.jsx)("div",{className:"startup-screen startup-loading",children:(0,$i.jsxs)("div",{className:"startup-content",children:[(0,$i.jsx)("div",{className:"startup-icon loading",children:(0,$i.jsx)("div",{className:"spinner"})}),(0,$i.jsx)("h2",{children:"Starting Steampunk Idle Game"}),(0,$i.jsx)("p",{children:n.currentStep?`${n.currentStep.replace("-"," ").replace(/\b\w/g,e=>e.toUpperCase())}...`:"Preparing application..."}),(0,$i.jsx)("div",{className:"progress-bar",children:(0,$i.jsx)("div",{className:"progress-fill",style:{width:`${Math.round(n.progress)}%`}})}),(0,$i.jsxs)("div",{className:"progress-text",children:[Math.round(n.progress),"%"]}),(0,$i.jsx)("div",{className:"startup-steps",children:(0,$i.jsx)("div",{className:"steps-grid",children:["store-validation","network-check","auth-initialization","service-health","local-storage","feature-flags"].map(e=>{const t=n.completedSteps.includes(e),r=n.currentStep===e,a=n.failedSteps.includes(e);return(0,$i.jsxs)("div",{className:`step-indicator ${t?"completed":""} ${r?"current":""} ${a?"failed":""}`,children:[(0,$i.jsx)("div",{className:"step-icon",children:t?"\u2713":a?"\u2717":r?"\u27f3":"\u25cb"}),(0,$i.jsx)("div",{className:"step-name",children:e.replace("-"," ").replace(/\b\w/g,e=>e.toUpperCase())})]},e)})})}),(0,$i.jsx)("button",{className:"details-button",onClick:()=>s(!i),children:i?"Hide Details":"Show Details"}),i&&(0,$i.jsxs)("div",{className:"startup-details",children:[(0,$i.jsx)("h3",{children:"Initialization Progress"}),(0,$i.jsxs)("div",{className:"steps-list",children:[n.completedSteps.map(e=>(0,$i.jsxs)("div",{className:"step-item completed",children:["\u2713 ",e]},e)),n.currentStep&&(0,$i.jsxs)("div",{className:"step-item current",children:["\u27f3 ",n.currentStep]}),n.failedSteps.map(e=>(0,$i.jsxs)("div",{className:"step-item failed",children:["\u2717 ",e]},e))]}),n.errors.length>0&&(0,$i.jsxs)("div",{className:"error-log",children:[(0,$i.jsx)("h4",{children:"Errors"}),n.errors.map((e,t)=>(0,$i.jsxs)("div",{className:"error-item "+(e.recoverable?"recoverable":"critical"),children:[(0,$i.jsx)("div",{className:"error-step",children:e.step}),(0,$i.jsx)("div",{className:"error-message",children:e.error}),(0,$i.jsx)("div",{className:"error-time",children:e.timestamp.toLocaleTimeString()})]},t))]})]}),o&&(0,$i.jsx)(Bi,{onRecoveryComplete:()=>{l(!1),u(0),Fi.initialize().then(e=>{setTimeout(()=>{t(e.isInitialized)},1e3)})},onSkipRecovery:()=>{l(!1)}})]})})};var Vi=n(538),Hi=n(44),Gi=n(119),Wi=n.t(Gi,2);let Qi=function(e){e()};const Ki=()=>Qi,Yi=Symbol.for("react-redux-context"),Ji="undefined"!==typeof globalThis?globalThis:{};function Xi(){var e;if(!r.createContext)return{};const t=null!=(e=Ji[Yi])?e:Ji[Yi]=new Map;let n=t.get(r.createContext);return n||(n=r.createContext(null),t.set(r.createContext,n)),n}const Zi=Xi();function es(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zi;return function(){return(0,r.useContext)(e)}}const ts=es();let ns=()=>{throw new Error("uSES not initialized!")};const rs=(e,t)=>e===t;function as(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zi;const t=e===Zi?ts:es(e);return function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{equalityFn:a=rs,stabilityCheck:i,noopCheck:s}="function"===typeof n?{equalityFn:n}:n;const{store:o,subscription:l,getServerState:c,stabilityCheck:u,noopCheck:d}=t(),h=((0,r.useRef)(!0),(0,r.useCallback)({[e.name]:t=>e(t)}[e.name],[e,u,i])),p=ns(l.addNestedSub,o.getState,c||o.getState,h,a);return(0,r.useDebugValue)(p),p}}const is=as();n(876),n(863);const ss={notify(){},get:()=>[]};function os(e,t){let n,r=ss,a=0,i=!1;function s(){c.onStateChange&&c.onStateChange()}function o(){a++,n||(n=t?t.addNestedSub(s):e.subscribe(s),r=function(){const e=Ki();let t=null,n=null;return{clear(){t=null,n=null},notify(){e(()=>{let e=t;for(;e;)e.callback(),e=e.next})},get(){let e=[],n=t;for(;n;)e.push(n),n=n.next;return e},subscribe(e){let r=!0,a=n={callback:e,next:null,prev:n};return a.prev?a.prev.next=a:t=a,function(){r&&null!==t&&(r=!1,a.next?a.next.prev=a.prev:n=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}())}function l(){a--,n&&0===a&&(n(),n=void 0,r.clear(),r=ss)}const c={addNestedSub:function(e){o();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),l())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:s,isSubscribed:function(){return i},trySubscribe:function(){i||(i=!0,o())},tryUnsubscribe:function(){i&&(i=!1,l())},getListeners:()=>r};return c}const ls=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement)?r.useLayoutEffect:r.useEffect;let cs=null;const us=function(e){let{store:t,context:n,children:a,serverState:i,stabilityCheck:s="once",noopCheck:o="once"}=e;const l=r.useMemo(()=>{const e=os(t);return{store:t,subscription:e,getServerState:i?()=>i:void 0,stabilityCheck:s,noopCheck:o}},[t,i,s,o]),c=r.useMemo(()=>t.getState(),[t]);ls(()=>{const{subscription:e}=l;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),c!==t.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[l,c]);const u=n||Zi;return r.createElement(u.Provider,{value:l},a)};function ds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zi;const t=e===Zi?ts:es(e);return function(){const{store:e}=t();return e}}const hs=ds();function ps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zi;const t=e===Zi?hs:ds(e);return function(){return t().dispatch}}const ms=ps();var fs,gs,ys;function vs(){return vs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vs.apply(this,arguments)}fs=Hi.useSyncExternalStoreWithSelector,ns=fs,(e=>{cs=e})(Vi.useSyncExternalStore),gs=Gi.unstable_batchedUpdates,Qi=gs,function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(ys||(ys={}));const xs="popstate";function bs(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function Es(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function Ss(e,t){return{usr:e.state,key:e.key,idx:t}}function ws(e,t,n,r){return void 0===n&&(n=null),vs({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?ks(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function Ns(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function ks(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Cs(e,t,n,r){void 0===r&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,s=a.history,o=ys.Pop,l=null,c=u();function u(){return(s.state||{idx:null}).idx}function d(){o=ys.Pop;let e=u(),t=null==e?null:e-c;c=e,l&&l({action:o,location:p.location,delta:t})}function h(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,n="string"===typeof e?e:Ns(e);return n=n.replace(/ $/,"%20"),bs(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==c&&(c=0,s.replaceState(vs({},s.state,{idx:c}),""));let p={get action(){return o},get location(){return e(a,s)},listen(e){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(xs,d),l=e,()=>{a.removeEventListener(xs,d),l=null}},createHref:e=>t(a,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=ys.Push;let r=ws(p.location,e,t);n&&n(r,e),c=u()+1;let d=Ss(r,c),h=p.createHref(r);try{s.pushState(d,"",h)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;a.location.assign(h)}i&&l&&l({action:o,location:p.location,delta:1})},replace:function(e,t){o=ys.Replace;let r=ws(p.location,e,t);n&&n(r,e),c=u();let a=Ss(r,c),d=p.createHref(r);s.replaceState(a,"",d),i&&l&&l({action:o,location:p.location,delta:0})},go:e=>s.go(e)};return p}var Is;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(Is||(Is={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function As(e,t,n){return void 0===n&&(n="/"),Ts(e,t,n,!1)}function Ts(e,t,n,r){let a=zs(("string"===typeof t?ks(t):t).pathname||"/",n);if(null==a)return null;let i=Rs(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o){let e=Bs(a);s=Fs(i[o],e,r)}return s}function Rs(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(e,a,i)=>{let s={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(bs(s.relativePath.startsWith(r),'Absolute route path "'+s.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(r.length));let o=Qs([r,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(bs(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),Rs(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:qs(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of js(e.path))a(e,t,r);else a(e,t)}),t}function js(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return a?[i,""]:[i];let s=js(r.join("/")),o=[];return o.push(...s.map(e=>""===e?i:[i,e].join("/"))),a&&o.push(...s),o.map(t=>e.startsWith("/")&&""===t?"/":t)}const _s=/^:[\w-]+$/,Ps=3,Os=2,Ms=1,Ls=10,Us=-2,Ds=e=>"*"===e;function qs(e,t){let n=e.split("/"),r=n.length;return n.some(Ds)&&(r+=Us),t&&(r+=Os),n.filter(e=>!Ds(e)).reduce((e,t)=>e+(_s.test(t)?Ps:""===t?Ms:Ls),r)}function Fs(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,a={},i="/",s=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=$s({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=$s({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),s.push({params:a,pathname:Qs([i,u.pathname]),pathnameBase:Ks(Qs([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=Qs([i,u.pathnameBase]))}return s}function $s(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);Es("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[n]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:s,pattern:e}}function Bs(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return Es(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function zs(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function Vs(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function Hs(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function Gs(e,t){let n=Hs(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function Ws(e,t,n,r){let a;void 0===r&&(r=!1),"string"===typeof e?a=ks(e):(a=vs({},e),bs(!a.pathname||!a.pathname.includes("?"),Vs("?","pathname","search",a)),bs(!a.pathname||!a.pathname.includes("#"),Vs("#","pathname","hash",a)),bs(!a.search||!a.search.includes("#"),Vs("#","search","hash",a)));let i,s=""===e||""===a.pathname,o=s?"/":a.pathname;if(null==o)i=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:a=""}="string"===typeof e?ks(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:Ys(r),hash:Js(a)}}(a,i),c=o&&"/"!==o&&o.endsWith("/"),u=(s||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const Qs=e=>e.join("/").replace(/\/\/+/g,"/"),Ks=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Ys=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Js=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function Xs(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const Zs=["post","put","patch","delete"],eo=(new Set(Zs),["get",...Zs]);new Set(eo),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function to(){return to=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},to.apply(this,arguments)}const no=r.createContext(null);const ro=r.createContext(null);const ao=r.createContext(null);const io=r.createContext(null);const so=r.createContext({outlet:null,matches:[],isDataRoute:!1});const oo=r.createContext(null);function lo(){return null!=r.useContext(io)}function co(){return lo()||bs(!1),r.useContext(io).location}function uo(e){r.useContext(ao).static||r.useLayoutEffect(e)}function ho(){let{isDataRoute:e}=r.useContext(so);return e?function(){let{router:e}=Eo(xo.UseNavigateStable),t=wo(bo.UseNavigateStable),n=r.useRef(!1);return uo(()=>{n.current=!0}),r.useCallback(function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,to({fromRouteId:t},a)))},[e,t])}():function(){lo()||bs(!1);let e=r.useContext(no),{basename:t,future:n,navigator:a}=r.useContext(ao),{matches:i}=r.useContext(so),{pathname:s}=co(),o=JSON.stringify(Gs(i,n.v7_relativeSplatPath)),l=r.useRef(!1);return uo(()=>{l.current=!0}),r.useCallback(function(n,r){if(void 0===r&&(r={}),!l.current)return;if("number"===typeof n)return void a.go(n);let i=Ws(n,JSON.parse(o),s,"path"===r.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:Qs([t,i.pathname])),(r.replace?a.replace:a.push)(i,r.state,r)},[t,a,o,s,e])}()}function po(e,t,n,a){lo()||bs(!1);let{navigator:i}=r.useContext(ao),{matches:s}=r.useContext(so),o=s[s.length-1],l=o?o.params:{},c=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let u,d=co();if(t){var h;let e="string"===typeof t?ks(t):t;"/"===c||(null==(h=e.pathname)?void 0:h.startsWith(c))||bs(!1),u=e}else u=d;let p=u.pathname||"/",m=p;if("/"!==c){let e=c.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let f=As(e,{pathname:m});let g=vo(f&&f.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:Qs([c,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:Qs([c,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),s,n,a);return t&&g?r.createElement(io.Provider,{value:{location:to({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:ys.Pop}},g):g}function mo(){let e=function(){var e;let t=r.useContext(oo),n=So(bo.UseRouteError),a=wo(bo.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[a]}(),t=Xs(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:i},n):null,null)}const fo=r.createElement(mo,null);class go extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(so.Provider,{value:this.props.routeContext},r.createElement(oo.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function yo(e){let{routeContext:t,match:n,children:a}=e,i=r.useContext(no);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(so.Provider,{value:t},a)}function vo(e,t,n,a){var i;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===a&&(a=null),null==e){var s;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(s=a)&&s.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(i=n)?void 0:i.errors;if(null!=l){let e=o.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||bs(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,u=-1;if(n&&a&&a.v7_partialHydration)for(let r=0;r<o.length;r++){let e=o[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=r),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){c=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight((e,a,i)=>{let s,d=!1,h=null,p=null;var m;n&&(s=l&&a.route.id?l[a.route.id]:void 0,h=a.route.errorElement||fo,c&&(u<0&&0===i?(m="route-fallback",!1||No[m]||(No[m]=!0),d=!0,p=null):u===i&&(d=!0,p=a.route.hydrateFallbackElement||null)));let f=t.concat(o.slice(0,i+1)),g=()=>{let t;return t=s?h:d?p:a.route.Component?r.createElement(a.route.Component,null):a.route.element?a.route.element:e,r.createElement(yo,{match:a,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(a.route.ErrorBoundary||a.route.errorElement||0===i)?r.createElement(go,{location:n.location,revalidation:n.revalidation,component:h,error:s,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()},null)}var xo=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(xo||{}),bo=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(bo||{});function Eo(e){let t=r.useContext(no);return t||bs(!1),t}function So(e){let t=r.useContext(ro);return t||bs(!1),t}function wo(e){let t=function(){let e=r.useContext(so);return e||bs(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||bs(!1),n.route.id}const No={};function ko(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}a.startTransition;function Co(e){bs(!1)}function Io(e){let{basename:t="/",children:n=null,location:a,navigationType:i=ys.Pop,navigator:s,static:o=!1,future:l}=e;lo()&&bs(!1);let c=t.replace(/^\/*/,"/"),u=r.useMemo(()=>({basename:c,navigator:s,static:o,future:to({v7_relativeSplatPath:!1},l)}),[c,l,s,o]);"string"===typeof a&&(a=ks(a));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:f="default"}=a,g=r.useMemo(()=>{let e=zs(d,c);return null==e?null:{location:{pathname:e,search:h,hash:p,state:m,key:f},navigationType:i}},[c,d,h,p,m,f,i]);return null==g?null:r.createElement(ao.Provider,{value:u},r.createElement(io.Provider,{children:n,value:g}))}function Ao(e){let{children:t,location:n}=e;return po(To(t),n)}new Promise(()=>{});r.Component;function To(e,t){void 0===t&&(t=[]);let n=[];return r.Children.forEach(e,(e,a)=>{if(!r.isValidElement(e))return;let i=[...t,a];if(e.type===r.Fragment)return void n.push.apply(n,To(e.props.children,i));e.type!==Co&&bs(!1),e.props.index&&e.props.children&&bs(!1);let s={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=To(e.props.children,i)),n.push(s)}),n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(Ql){}new Map;const Ro=a.startTransition;Wi.flushSync,a.useId;function jo(e){let{basename:t,children:n,future:a,window:i}=e,s=r.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:i,v5Compat:!0})&&(o={}),Cs(function(e,t){let{pathname:n,search:r,hash:a}=e.location;return ws("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:Ns(t)},null,o)));let l=s.current,[c,u]=r.useState({action:l.action,location:l.location}),{v7_startTransition:d}=a||{},h=r.useCallback(e=>{d&&Ro?Ro(()=>u(e)):u(e)},[u,d]);return r.useLayoutEffect(()=>l.listen(h),[l,h]),r.useEffect(()=>ko(a),[a]),r.createElement(Io,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:a})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var _o,Po;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(_o||(_o={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Po||(Po={}));var Oo=n(142);const Mo=e=>{let{children:t}=e;const n=ms(),{tokens:a,isAuthenticated:i,user:s}=is(e=>e.auth);(0,r.useEffect)(()=>{(async()=>{try{const e=await qi.initializeAuth();e&&n((0,o.loginSuccess)(e))}catch(e){console.log("Failed to initialize authentication:",e)}})();const e=()=>{if(console.log("Window gained focus - checking session"),qi.isAuthenticated()){const e=qi.getCurrentUser(),t=qi.getAuthTokens();e&&t&&!i&&(console.log("Restoring session from localStorage"),n((0,o.loginSuccess)({user:e,tokens:t})))}},t=()=>{console.log("Window lost focus - maintaining session")};return window.addEventListener("focus",e),window.addEventListener("blur",t),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",t)}},[n,i]);const c=(0,r.useCallback)(async()=>{if(a&&i&&qi.isTokenExpired(a))try{const e=await qi.refreshToken(a.refreshToken);n((0,o.O3)(e))}catch(e){console.error("Token refresh failed:",e),n((0,o.ri)())}},[a,i,n]);return(0,r.useEffect)(()=>{if(!i||!a)return;const e=setInterval(c,3e5),t=setInterval(async()=>{try{await qi.validateSession()?await qi.sendHeartbeat():(console.log("Session expired, logging out"),n((0,o.ri)()))}catch(e){console.error("Session validation failed:",e)}},3e5);return qi.sendHeartbeat().catch(e=>{console.error("Initial heartbeat failed:",e)}),()=>{clearInterval(e),clearInterval(t)}},[i,a,c,n]),(0,r.useEffect)(()=>{const e=()=>{i&&a&&c()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[i,a,c]),(0,r.useEffect)(()=>{(async()=>{if(i&&s){n((0,l.oU)(!0));try{const e=await Oo.CharacterService.getCharacter(s.userId);e?(n((0,l.setCharacter)(e)),n((0,l.S8)(!0)),console.log("AuthProvider: Character loaded, using simple activity system")):n((0,l.S8)(!1))}catch(e){console.error("AuthProvider: Failed to initialize game state:",e),n((0,l.S8)(!1)),console.error("AuthProvider: Character loading failed. Please try refreshing the page.")}finally{n((0,l.oU)(!1))}}else{n((0,l.S8)(null)),n((0,l.$V)());try{console.log("AuthProvider: User logged out, task queue callbacks should be cleaned up")}catch(e){console.warn("AuthProvider: Error during logout cleanup:",e)}}})()},[i,s,n]),(0,$i.jsx)($i.Fragment,{children:t})};class Lo{static initialize(){this.config=this.detectEnvironmentConfig()}static isStaging(){return"staging"===this.getEnvironment()}static isProduction(){return"production"===this.getEnvironment()}static getEnvironment(){return"staging"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_AWS_ENVIRONMENT?"staging":"production"}static hasBackendAPI(){return!!this.getConfig().apiBaseUrl}static getEnvironmentInfo(){const e=this.getEnvironment();return{environment:e,isStaging:"staging"===e,isProduction:"production"===e,hasBackendAPI:this.hasBackendAPI(),enableDebugMode:this.getConfig().enableDebugMode}}static getConfig(){return this.config||this.initialize(),this.config}static detectEnvironmentConfig(){return{apiBaseUrl:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",enableDebugMode:"staging"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_AWS_ENVIRONMENT||!1,enableOfflineMode:!1}}static getApiBaseUrl(){const e=this.getConfig();if(!e.apiBaseUrl)throw new Error("API base URL is not configured. Please set REACT_APP_API_URL or REACT_APP_AWS_API_URL environment variable.");return e.apiBaseUrl}static getWebSocketUrl(){const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_WS_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_AWS_WS_URL;if(!e)throw new Error("WebSocket URL is not configured. Please set REACT_APP_WS_URL or REACT_APP_AWS_WS_URL environment variable.");return e}static getAwsRegion(){return"us-west-2"}static isDebugMode(){return this.getConfig().enableDebugMode}static getEnvironmentSpecificConfig(){switch(this.getEnvironment()){case"production":default:return{logLevel:"error",enableMetrics:!0,enableTracing:!0};case"staging":return{logLevel:"info",enableMetrics:!0,enableTracing:!0};case"test":return{logLevel:"warn",enableMetrics:!1,enableTracing:!1}}}}Lo.config=null,Lo.initialize();const Uo=new class{constructor(){this.config={enabled:!0,logToConsole:!0,logToRemote:!1,logToLocalStorage:!0,maxBreadcrumbs:50,maxLocalStorageEntries:100},this.breadcrumbs=[],this.errorReports=[],this.sessionId=this.generateSessionId()}initialize(e){e&&(this.config={...this.config,...e}),"undefined"!==typeof window&&(window.addEventListener("error",this.handleGlobalError.bind(this)),window.addEventListener("unhandledrejection",this.handleUnhandledRejection.bind(this))),this.addBreadcrumb("info","system","ErrorLoggingService initialized"),console.log("[ErrorLoggingService] Initialized with config:",this.config)}configure(e){this.config={...this.config,...e}}getConfig(){return{...this.config}}async logError(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"medium";if(!this.config.enabled)return"";const r=this.generateErrorId(),a=Date.now(),i=this.generateFingerprint(e),s={id:r,name:e.name||"Error",message:e.message,stack:e.stack,timestamp:a,severity:n,category:this.categorizeError(e,t),context:t,breadcrumbs:[...this.breadcrumbs],userAgent:"undefined"!==typeof navigator?navigator.userAgent:"Unknown",url:"undefined"!==typeof window?window.location.href:"Unknown",userId:null===t||void 0===t?void 0:t.userId,sessionId:this.sessionId,occurrences:1,firstSeen:a,lastSeen:a,fingerprint:i};if(this.errorReports.push(s),this.config.logToConsole&&console.error("[ErrorLoggingService]",{id:r,message:e.message,severity:n,context:t,stack:e.stack}),this.config.logToLocalStorage&&this.saveToLocalStorage(s),this.config.logToRemote&&this.config.remoteEndpoint)try{await this.sendToRemote(s)}catch(o){console.warn("[ErrorLoggingService] Failed to send error to remote endpoint:",o)}return r}addBreadcrumb(e,t,n,r){const a={timestamp:Date.now(),category:t,message:n,level:e,data:r};this.breadcrumbs.push(a),this.breadcrumbs.length>this.config.maxBreadcrumbs&&this.breadcrumbs.shift()}getBreadcrumbs(){return[...this.breadcrumbs]}getErrorReports(){return[...this.errorReports]}getErrorStatistics(){const e=Date.now()-36e5,t=this.errorReports.reduce((e,t)=>(e[t.severity]=(e[t.severity]||0)+1,e),{}),n=this.errorReports.filter(t=>t.timestamp>e).length;return{total:this.errorReports.length,bySeverity:t,recent:n}}clearErrorReports(){this.errorReports=[],"undefined"!==typeof localStorage&&localStorage.removeItem("errorLoggingService_errors")}clearBreadcrumbs(){this.breadcrumbs=[]}handleGlobalError(e){const t=new Error(e.message);t.stack=`${e.filename}:${e.lineno}:${e.colno}`,this.logError(t,{component:"global",action:"unhandled-error",additionalData:{filename:e.filename,lineno:e.lineno,colno:e.colno}},"high")}handleUnhandledRejection(e){const t=e.reason instanceof Error?e.reason:new Error(String(e.reason));this.logError(t,{component:"global",action:"unhandled-rejection",additionalData:{reason:e.reason}},"high")}saveToLocalStorage(e){if("undefined"!==typeof localStorage)try{const t="errorLoggingService_errors",n=localStorage.getItem(t),r=n?JSON.parse(n):[];r.push(e),r.length>this.config.maxLocalStorageEntries&&r.splice(0,r.length-this.config.maxLocalStorageEntries),localStorage.setItem(t,JSON.stringify(r))}catch(t){console.warn("[ErrorLoggingService] Failed to save to localStorage:",t)}}async sendToRemote(e){if(!this.config.remoteEndpoint)return;const t={...e,environment:Lo.getEnvironment(),buildVersion:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_VERSION||"unknown"},n=await fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json",...this.config.apiKey&&{Authorization:`Bearer ${this.config.apiKey}`}},body:JSON.stringify(t)});if(!n.ok)throw new Error(`Remote logging failed: ${n.status} ${n.statusText}`)}generateErrorId(){return`error-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}categorizeError(e,t){return"NetworkError"===e.name||e.message.includes("fetch")||e.message.includes("network")?"network":e.message.includes("auth")||e.message.includes("unauthorized")||e.message.includes("token")?"auth":null!==t&&void 0!==t&&t.component?"ui":e.message.includes("JSON")||e.message.includes("parse")||e.message.includes("data")?"data":"TypeError"===e.name||"ReferenceError"===e.name||"SyntaxError"===e.name?"javascript":"unknown"}generateFingerprint(e){const t=e.message||"",n=`${e.name||""}:${t}:${(e.stack||"").split("\n")[1]||""}`;let r=0;for(let a=0;a<n.length;a++){r=(r<<5)-r+n.charCodeAt(a),r&=r}return Math.abs(r).toString(16)}generateSessionId(){return`session-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}};class Do extends r.Component{constructor(e){super(e),this.retryTimeoutId=null,this.handleRetry=()=>{this.state.retryCount>=3?console.warn("[EnhancedErrorBoundary] Maximum retry attempts reached"):(this.setState({isRecovering:!0}),Uo.addBreadcrumb("info","error-boundary",`Retry attempt ${this.state.retryCount+1}`),this.retryTimeoutId=setTimeout(()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:null,retryCount:this.state.retryCount+1,isRecovering:!1})},1e3))},this.handleReload=()=>{Uo.addBreadcrumb("info","error-boundary","User initiated page reload"),window.location.reload()},this.handleReportError=async()=>{if(this.state.error&&this.props.enableReporting)try{await Uo.logError(this.state.error,{additionalData:{userInitiated:!0}},"medium"),console.log("[EnhancedErrorBoundary] Error reported by user")}catch(e){console.error("[EnhancedErrorBoundary] Failed to report error:",e)}},this.toggleDetails=()=>{this.setState({showDetails:!this.state.showDetails})},this.handleGoHome=()=>{Uo.addBreadcrumb("info","error-boundary","User navigated to home"),window.location.href="/"},this.state={hasError:!1,error:null,errorInfo:null,errorId:null,retryCount:0,isRecovering:!1,showDetails:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}async componentDidCatch(e,t){console.error("[EnhancedErrorBoundary] Caught error:",e),console.error("[EnhancedErrorBoundary] Error info:",t);const n={component:this.props.componentName||"EnhancedErrorBoundary",additionalData:{level:this.props.level||"component",retryCount:this.state.retryCount,props:this.sanitizeProps(this.props),componentStack:t.componentStack}},r=await Uo.logError(e,n,"high");Uo.addBreadcrumb("error","error-boundary",`Error caught in ${this.props.componentName||"component"}`,{errorMessage:e.message,componentStack:t.componentStack}),this.setState({errorInfo:t,errorId:r}),this.props.onError&&this.props.onError(e,t)}componentWillUnmount(){this.retryTimeoutId&&clearTimeout(this.retryTimeoutId)}sanitizeProps(e){const t={};return Object.keys(e).forEach(n=>{const r=e[n];t[n]="string"===typeof r||"number"===typeof r||"boolean"===typeof r||null===r||void 0===r?r:"[Complex Object]"}),t}renderErrorDetails(){var e;return this.state.showDetails&&this.state.error?(0,$i.jsxs)("div",{className:"error-details",children:[(0,$i.jsx)("h4",{children:"Technical Details"}),(0,$i.jsxs)("div",{className:"error-info",children:[(0,$i.jsxs)("div",{className:"error-field",children:[(0,$i.jsx)("strong",{children:"Error ID:"})," ",this.state.errorId||"N/A"]}),(0,$i.jsxs)("div",{className:"error-field",children:[(0,$i.jsx)("strong",{children:"Error Type:"})," ",this.state.error.name]}),(0,$i.jsxs)("div",{className:"error-field",children:[(0,$i.jsx)("strong",{children:"Message:"})," ",this.state.error.message]}),(0,$i.jsxs)("div",{className:"error-field",children:[(0,$i.jsx)("strong",{children:"Component:"})," ",this.props.componentName||"Unknown"]}),(0,$i.jsxs)("div",{className:"error-field",children:[(0,$i.jsx)("strong",{children:"Level:"})," ",this.props.level||"component"]}),(0,$i.jsxs)("div",{className:"error-field",children:[(0,$i.jsx)("strong",{children:"Retry Count:"})," ",this.state.retryCount]}),this.state.error.stack&&(0,$i.jsxs)("div",{className:"error-field",children:[(0,$i.jsx)("strong",{children:"Stack Trace:"}),(0,$i.jsx)("pre",{className:"stack-trace",children:this.state.error.stack})]}),(null===(e=this.state.errorInfo)||void 0===e?void 0:e.componentStack)&&(0,$i.jsxs)("div",{className:"error-field",children:[(0,$i.jsx)("strong",{children:"Component Stack:"}),(0,$i.jsx)("pre",{className:"component-stack",children:this.state.errorInfo.componentStack})]})]})]}):null}renderRecoveryActions(){const{enableRecovery:e=!0,enableReporting:t=!0}=this.props,n=this.state.retryCount<3;return(0,$i.jsxs)("div",{className:"error-actions",children:[e&&n&&(0,$i.jsx)("button",{className:"error-button error-button-primary",onClick:this.handleRetry,disabled:this.state.isRecovering,children:this.state.isRecovering?"Retrying...":"Try Again"}),(0,$i.jsx)("button",{className:"error-button error-button-secondary",onClick:this.handleReload,children:"Reload Page"}),(0,$i.jsx)("button",{className:"error-button error-button-secondary",onClick:this.handleGoHome,children:"Go Home"}),t&&(0,$i.jsx)("button",{className:"error-button error-button-tertiary",onClick:this.handleReportError,children:"Report Issue"}),(0,$i.jsx)("button",{className:"error-button error-button-tertiary",onClick:this.toggleDetails,children:this.state.showDetails?"Hide Details":"Show Details"})]})}renderErrorMessage(){const{level:e="component"}=this.props,t={page:{title:"Page Error",description:"This page encountered an unexpected error and cannot be displayed."},section:{title:"Section Error",description:"This section encountered an error and cannot be displayed."},component:{title:"Component Error",description:"A component on this page encountered an error."}}[e];return(0,$i.jsxs)("div",{className:"error-message",children:[(0,$i.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,$i.jsxs)("div",{className:"error-content",children:[(0,$i.jsx)("h3",{children:t.title}),(0,$i.jsx)("p",{children:t.description}),this.state.error&&(0,$i.jsxs)("p",{className:"error-summary",children:[(0,$i.jsx)("strong",{children:"Error:"})," ",this.state.error.message]})]})]})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,$i.jsx)("div",{className:`enhanced-error-boundary enhanced-error-boundary--${this.props.level||"component"}`,children:(0,$i.jsxs)("div",{className:"error-container",children:[this.renderErrorMessage(),this.renderRecoveryActions(),this.renderErrorDetails()]})}):this.props.children}}const qo=e=>{let{children:t,fallback:n,onError:r}=e;return(0,$i.jsx)(Do,{fallback:n,onError:r,enableRecovery:!0,enableReporting:!0,componentName:"ErrorBoundary",level:"component",children:t})},Fo=e=>{let{isOpen:t,onClose:n,title:a,children:i,size:s="medium"}=e;return(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&t&&n()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,n]),t?(0,$i.jsx)("div",{className:"feature-modal-overlay",onClick:n,children:(0,$i.jsxs)("div",{className:`feature-modal feature-modal--${s}`,onClick:e=>e.stopPropagation(),children:[(0,$i.jsxs)("div",{className:"feature-modal__header",children:[(0,$i.jsx)("h2",{className:"feature-modal__title",children:a}),(0,$i.jsx)("button",{className:"feature-modal__close",onClick:n,"aria-label":"Close modal",children:"\u2715"})]}),(0,$i.jsx)("div",{className:"feature-modal__content",children:i})]})}):null},$o=e=>{let{items:t,activeItem:n,className:a=""}=e;const[i,s]=(0,r.useState)(!1),[,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=()=>{o(window.innerWidth<1024)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{const e=e=>{e.target.closest(".responsive-navigation")||s(!1)};if(i)return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[i]);const l=e=>{e.onClick(),s(!1)},c=()=>{s(!i)};return(0,$i.jsxs)("nav",{className:`responsive-navigation ${a}`,children:[(0,$i.jsx)("div",{className:"desktop-nav",children:(0,$i.jsx)("ul",{className:"nav-list horizontal",children:t.map(e=>(0,$i.jsx)("li",{className:"nav-item",children:(0,$i.jsxs)("button",{className:"nav-button "+(n===e.id?"active":""),onClick:()=>l(e),title:e.label,children:[(0,$i.jsx)("span",{className:"nav-icon",children:e.icon}),(0,$i.jsx)("span",{className:"nav-label",children:e.label}),e.badge&&e.badge>0&&(0,$i.jsx)("span",{className:"nav-badge",children:e.badge})]})},e.id))})}),(0,$i.jsxs)("div",{className:"mobile-nav",children:[(0,$i.jsxs)("button",{className:"hamburger-button "+(i?"open":""),onClick:c,"aria-label":"Toggle navigation menu",children:[(0,$i.jsx)("span",{className:"hamburger-line"}),(0,$i.jsx)("span",{className:"hamburger-line"}),(0,$i.jsx)("span",{className:"hamburger-line"})]}),(0,$i.jsx)("div",{className:"mobile-menu-overlay "+(i?"open":""),children:(0,$i.jsxs)("div",{className:"mobile-menu",children:[(0,$i.jsxs)("div",{className:"mobile-menu-header",children:[(0,$i.jsx)("h3",{children:"Navigation"}),(0,$i.jsx)("button",{className:"close-button",onClick:()=>s(!1),"aria-label":"Close menu",children:"\u2715"})]}),(0,$i.jsx)("ul",{className:"nav-list vertical",children:t.map(e=>(0,$i.jsx)("li",{className:"nav-item",children:(0,$i.jsxs)("button",{className:"nav-button "+(n===e.id?"active":""),onClick:()=>l(e),children:[(0,$i.jsx)("span",{className:"nav-icon",children:e.icon}),(0,$i.jsx)("span",{className:"nav-label",children:e.label}),e.badge&&e.badge>0&&(0,$i.jsx)("span",{className:"nav-badge",children:e.badge})]})},e.id))})]})}),(0,$i.jsx)("div",{className:"bottom-nav",children:(0,$i.jsxs)("ul",{className:"nav-list bottom",children:[t.slice(0,5).map(e=>(0,$i.jsx)("li",{className:"nav-item",children:(0,$i.jsxs)("button",{className:"nav-button "+(n===e.id?"active":""),onClick:()=>l(e),title:e.label,children:[(0,$i.jsx)("span",{className:"nav-icon",children:e.icon}),(0,$i.jsx)("span",{className:"nav-label",children:e.label}),e.badge&&e.badge>0&&(0,$i.jsx)("span",{className:"nav-badge",children:e.badge})]})},e.id)),t.length>5&&(0,$i.jsx)("li",{className:"nav-item",children:(0,$i.jsxs)("button",{className:"nav-button more-button",onClick:c,title:"More options",children:[(0,$i.jsx)("span",{className:"nav-icon",children:"\u22ef"}),(0,$i.jsx)("span",{className:"nav-label",children:"More"})]})})]})})]})]})},Bo=e=>{let{children:t,sidebar:n,navigation:a,className:i=""}=e;const[s,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth,t=e<768,n=e>=768&&e<1024;o(t),c(n),d(!(!t&&!n))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);return(0,$i.jsxs)("div",{className:`responsive-layout ${i} ${s?"mobile":l?"tablet":"desktop"}`,children:[a&&(0,$i.jsx)("div",{className:"layout-navigation",children:(0,$i.jsx)($o,{items:a.items,activeItem:a.activeItem})}),(0,$i.jsxs)("div",{className:"layout-container",children:[n&&(0,$i.jsxs)($i.Fragment,{children:[(s||l)&&(0,$i.jsx)("button",{className:"sidebar-toggle",onClick:()=>{d(!u)},"aria-label":u?"Open sidebar":"Close sidebar",children:(0,$i.jsx)("span",{className:"toggle-icon",children:u?"\u2630":"\u2715"})}),s&&!u&&(0,$i.jsx)("div",{className:"sidebar-overlay",onClick:()=>d(!0)}),(0,$i.jsx)("aside",{className:"layout-sidebar "+(u?"collapsed":"expanded"),children:(0,$i.jsx)("div",{className:"sidebar-content",children:n})})]}),(0,$i.jsx)("main",{className:`layout-main ${n?"with-sidebar":"full-width"} ${u?"sidebar-collapsed":"sidebar-expanded"}`,children:(0,$i.jsx)("div",{className:"main-content",children:t})})]}),s&&(0,$i.jsx)("div",{className:"mobile-nav-spacer"})]})},zo=()=>{const{character:e}=is(e=>e.game),[t,n]=(0,r.useState)("global"),[a,i]=(0,r.useState)([]),[s,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),m=(0,r.useRef)(null),f=(0,r.useRef)(null),g=(0,r.useRef)(0),y=(0,r.useRef)(0);(0,r.useEffect)(()=>{const e=()=>{const e=window.innerWidth,t=e<768,n=e>=1024;d(t),p(n),t&&!l&&c(!0)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[l]);(0,r.useEffect)(()=>{i((()=>{const e=[],t=Date.now();return[{messages:[{sender:"System",content:"Welcome to the Steam Telegraph Network!",type:"system",time:18e5},{sender:"VictorianEngineer",content:"Good morning, fellow inventors!",type:"user",time:174e4},{sender:"SteamMaster",content:"Has anyone tried the new boiler designs?",type:"user",time:168e4},{sender:"ClockworkTinker",content:"Yes! The efficiency is remarkable",type:"user",time:162e4},{sender:"BrassFoundry",content:"I can supply materials if anyone needs them",type:"user",time:156e4},{sender:"System",content:"ClockworkTinker reached level 15!",type:"achievement",time:15e5},{sender:"GearMaster",content:"Anyone know where to find Steam Crystals?",type:"user",time:144e4},{sender:"ClockworkQueen",content:"Try the mining zones in the eastern districts!",type:"user",time:138e4}],channel:"global"},{messages:[{sender:"BrassBuilder",content:"WTS: Clockwork Gears x10 - 50 coins each",type:"user",time:15e5},{sender:"SteamTrader",content:"WTB: Steam Crystals - paying premium",type:"user",time:12e5},{sender:"GearMerchant",content:"Selling rare mechanical parts, PM me",type:"user",time:9e5}],channel:"trade"},{messages:[{sender:"GuildLeader",content:"Welcome to the Clockwork Collective!",type:"user",time:18e5},{sender:"GuildOfficer",content:"Remember to contribute to guild projects",type:"user",time:12e5},{sender:"GuildMember1",content:"Working on the steam engine upgrade",type:"user",time:6e5}],channel:"guild"},{messages:[{sender:"Helper",content:"Welcome! Ask any questions here",type:"user",time:18e5},{sender:"Newbie",content:"How do I start harvesting?",type:"user",time:12e5},{sender:"Veteran",content:"Click Resource Harvesting in the left sidebar",type:"user",time:11e5}],channel:"help"}].forEach(n=>{let{messages:r,channel:a}=n;r.forEach((n,r)=>{e.push({id:`${a}-${r}`,sender:n.sender,content:n.content,timestamp:new Date(t-n.time),channel:a,type:n.type})})}),e})())},[]),(0,r.useEffect)(()=>{var e;l||(null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))},[a,l]);const v=(0,r.useCallback)(e=>{g.current=e.touches[0].clientX,y.current=e.touches[0].clientY},[]),x=(0,r.useCallback)(e=>{if(!g.current||!y.current)return;const r=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY,i=g.current-r,s=y.current-a;if(Math.abs(i)>Math.abs(s)&&Math.abs(i)>50){const e=["global","guild","trade","help"],r=e.indexOf(t);i>0&&r<e.length-1?n(e[r+1]):i<0&&r>0&&n(e[r-1])}g.current=0,y.current=0},[t]),b=()=>{if(!s.trim()||!e)return;const n={id:Date.now().toString(),sender:e.name,content:s.trim(),timestamp:new Date,channel:t,type:"user"};i(e=>[...e,n]),o("")},E=a.filter(e=>e.channel===t),S=e=>({global:{name:"Global",icon:"\ud83c\udf0d",color:"#4a7c59"},guild:{name:"Guild",icon:"\ud83c\udff0",color:"#8b4513"},trade:{name:"Trade",icon:"\ud83d\udcbc",color:"#b8860b"},help:{name:"Help",icon:"\u2753",color:"#6495ed"}}[e]);return(0,$i.jsxs)("div",{ref:f,className:`responsive-chat-interface ${l?"collapsed":"expanded"} ${u?"mobile":h?"desktop sidebar-expanded":"tablet"}`,onTouchStart:v,onTouchEnd:x,children:[(0,$i.jsxs)("button",{className:"chat-toggle-button",onClick:()=>{c(!l)},"aria-label":l?"Expand chat":"Collapse chat",children:[(0,$i.jsx)("span",{className:"toggle-icon",children:l?"\u2b06\ufe0f":"\u2b07\ufe0f"}),(0,$i.jsx)("span",{className:"toggle-text",children:l?"Show Chat":"Hide Chat"})]}),(0,$i.jsxs)("div",{className:"chat-content",children:[(0,$i.jsxs)("div",{className:"chat-header",children:[(0,$i.jsxs)("div",{className:"chat-title",children:[(0,$i.jsx)("span",{className:"chat-icon",children:"\ud83d\udcac"}),(0,$i.jsx)("span",{className:"title-text",children:"Steam Telegraph"})]}),(0,$i.jsx)("div",{className:"channel-tabs",children:["global","guild","trade","help"].map(e=>{const r=S(e);return(0,$i.jsxs)("button",{className:"channel-tab "+(t===e?"active":""),onClick:()=>n(e),style:{"--channel-color":r.color},title:r.name,children:[(0,$i.jsx)("span",{className:"channel-icon",children:r.icon}),!u&&(0,$i.jsx)("span",{className:"channel-name",children:r.name})]},e)})})]}),(0,$i.jsxs)("div",{className:"chat-messages",children:[E.map(e=>{return(0,$i.jsx)("div",{className:`chat-message ${e.type}`,children:(0,$i.jsxs)("div",{className:"message-line",children:[(0,$i.jsx)("span",{className:"message-time",children:(t=e.timestamp,t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",...u?{}:{second:"2-digit"}}))}),(0,$i.jsxs)("span",{className:"message-sender",children:[e.sender,":"]}),(0,$i.jsx)("span",{className:"message-content",children:e.content})]})},e.id);var t}),(0,$i.jsx)("div",{ref:m})]}),(0,$i.jsxs)("div",{className:"chat-input-area",children:[(0,$i.jsxs)("div",{className:"input-container",children:[(0,$i.jsx)("input",{type:"text",value:s,onChange:e=>o(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),b())},placeholder:`Message ${S(t).name}...`,className:"chat-input",maxLength:200}),(0,$i.jsx)("button",{onClick:b,disabled:!s.trim(),className:"send-button","aria-label":"Send message",children:"\ud83d\udce4"})]}),!u&&(0,$i.jsxs)("div",{className:"input-info",children:[(0,$i.jsxs)("span",{className:"char-count",children:[s.length,"/200"]}),(0,$i.jsx)("span",{className:"input-hint",children:"Press Enter to send \u2022 Swipe to change channels"})]}),u&&(0,$i.jsx)("div",{className:"mobile-input-info",children:(0,$i.jsx)("span",{className:"swipe-hint",children:"\u2190 Swipe to change channels \u2192"})})]})]})]})},Vo=()=>{const e=ms(),{loading:t,error:n}=is(e=>e.auth),[a,i]=(0,r.useState)(null),[s,l]=(0,r.useState)("login"),[c,u]=(0,r.useState)(""),[d,h]=(0,r.useState)(""),[p,m]=(0,r.useState)(""),[f,g]=(0,r.useState)(""),[y,v]=(0,r.useState)(!1),x=async t=>{e((0,o.AU)()),i(t);try{let n;switch(t){case"google":n=await qi.loginWithGoogle();break;case"facebook":n=await qi.loginWithFacebook();break;case"x":n=await qi.loginWithX();break;default:throw new Error("Invalid provider")}e((0,o.loginSuccess)(n))}catch(n){const r=n instanceof Error?n.message:"Login failed";r.includes("Redirect to")||e((0,o.ie)(r))}finally{i(null)}},b=async t=>{if(t.preventDefault(),c&&d){e((0,o.AU)());try{const t=await qi.loginWithEmail(c,d);e((0,o.loginSuccess)(t))}catch(n){const r=n instanceof Error?n.message:"Login failed";e((0,o.ie)(r))}}},E=async t=>{if(t.preventDefault(),c&&d&&p)if(d===p){e((0,o.AU)());try{if((await qi.registerWithEmail(c,d)).requiresConfirmation)l("confirm"),e((0,o.ie)("Please check your email for a verification code"));else{const t=await qi.loginWithEmail(c,d);e((0,o.loginSuccess)(t))}}catch(n){const r=n instanceof Error?n.message:"Registration failed";e((0,o.ie)(r))}}else e((0,o.ie)("Passwords do not match"))},S=async t=>{if(t.preventDefault(),c&&f){e((0,o.AU)());try{await qi.confirmEmail(c,f);const t=await qi.loginWithEmail(c,d);e((0,o.loginSuccess)(t))}catch(n){const r=n instanceof Error?n.message:"Email confirmation failed";e((0,o.ie)(r))}}},w=async t=>{if(t.preventDefault(),c){e((0,o.AU)());try{await qi.requestPasswordReset(c),l("reset"),e((0,o.ie)("Please check your email for a password reset code"))}catch(n){const r=n instanceof Error?n.message:"Password reset request failed";e((0,o.ie)(r))}}},N=async t=>{if(t.preventDefault(),c&&f&&d&&p)if(d===p){e((0,o.AU)());try{await qi.confirmPasswordReset(c,f,d),l("login"),g(""),h(""),m(""),e((0,o.ie)("Password reset successful. Please log in with your new password."))}catch(n){const r=n instanceof Error?n.message:"Password reset failed";e((0,o.ie)(r))}}else e((0,o.ie)("Passwords do not match"))},k=t=>{l(t),u(""),h(""),m(""),g(""),e((0,o.ie)(""))};return(0,$i.jsx)("div",{className:"login-component",children:(0,$i.jsxs)("div",{className:"login-container",children:[(0,$i.jsxs)("div",{className:"login-header",children:[(0,$i.jsx)("h2",{children:"Welcome to Steampunk Idle Game"}),(0,$i.jsx)("p",{children:"Choose your preferred login method to start your adventure"})]}),n&&(0,$i.jsxs)("div",{className:"error-message "+(n.includes("successful")||n.includes("check your email")?"success-message":""),children:[(0,$i.jsx)("span",{className:"error-icon",children:n.includes("successful")||n.includes("check your email")?"\u2705":"\u26a0\ufe0f"}),n]}),(0,$i.jsxs)("div",{className:"email-auth-section",children:[(0,$i.jsx)("div",{className:"auth-mode-header",children:(0,$i.jsxs)("h3",{children:["login"===s&&"Sign In","register"===s&&"Create Account","confirm"===s&&"Verify Email","forgot"===s&&"Reset Password","reset"===s&&"Set New Password"]})}),(()=>{switch(s){case"login":return(0,$i.jsxs)("form",{onSubmit:b,className:"email-form",children:[(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,$i.jsx)("input",{type:"email",id:"email",value:c,onChange:e=>u(e.target.value),placeholder:"Enter your email",required:!0,disabled:t})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"password",children:"Password"}),(0,$i.jsxs)("div",{className:"password-input",children:[(0,$i.jsx)("input",{type:y?"text":"password",id:"password",value:d,onChange:e=>h(e.target.value),placeholder:"Enter your password",required:!0,disabled:t}),(0,$i.jsx)("button",{type:"button",className:"password-toggle",onClick:()=>v(!y),disabled:t,children:y?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]})]}),(0,$i.jsx)("button",{type:"submit",className:"email-submit-btn",disabled:t||!c||!d,children:t?"Signing In...":"Sign In with Email"}),(0,$i.jsxs)("div",{className:"form-links",children:[(0,$i.jsx)("button",{type:"button",onClick:()=>k("register"),className:"link-btn",children:"Don't have an account? Register"}),(0,$i.jsx)("button",{type:"button",onClick:()=>k("forgot"),className:"link-btn",children:"Forgot your password?"})]})]});case"register":return(0,$i.jsxs)("form",{onSubmit:E,className:"email-form",children:[(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,$i.jsx)("input",{type:"email",id:"email",value:c,onChange:e=>u(e.target.value),placeholder:"Enter your email",required:!0,disabled:t})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"password",children:"Password"}),(0,$i.jsxs)("div",{className:"password-input",children:[(0,$i.jsx)("input",{type:y?"text":"password",id:"password",value:d,onChange:e=>h(e.target.value),placeholder:"At least 8 characters with uppercase, lowercase, and numbers",required:!0,disabled:t}),(0,$i.jsx)("button",{type:"button",className:"password-toggle",onClick:()=>v(!y),disabled:t,children:y?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),(0,$i.jsx)("input",{type:y?"text":"password",id:"confirmPassword",value:p,onChange:e=>m(e.target.value),placeholder:"Confirm your password",required:!0,disabled:t})]}),(0,$i.jsx)("button",{type:"submit",className:"email-submit-btn",disabled:t||!c||!d||!p,children:t?"Creating Account...":"Create Account"}),(0,$i.jsx)("div",{className:"form-links",children:(0,$i.jsx)("button",{type:"button",onClick:()=>k("login"),className:"link-btn",children:"Already have an account? Sign In"})})]});case"confirm":return(0,$i.jsxs)("form",{onSubmit:S,className:"email-form",children:[(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,$i.jsx)("input",{type:"email",id:"email",value:c,onChange:e=>u(e.target.value),placeholder:"Enter your email",required:!0,disabled:t})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"confirmationCode",children:"Verification Code"}),(0,$i.jsx)("input",{type:"text",id:"confirmationCode",value:f,onChange:e=>g(e.target.value),placeholder:"Enter the code from your email",required:!0,disabled:t})]}),(0,$i.jsx)("button",{type:"submit",className:"email-submit-btn",disabled:t||!c||!f,children:t?"Verifying...":"Verify Email"}),(0,$i.jsx)("div",{className:"form-links",children:(0,$i.jsx)("button",{type:"button",onClick:()=>k("login"),className:"link-btn",children:"Back to Sign In"})})]});case"forgot":return(0,$i.jsxs)("form",{onSubmit:w,className:"email-form",children:[(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,$i.jsx)("input",{type:"email",id:"email",value:c,onChange:e=>u(e.target.value),placeholder:"Enter your email",required:!0,disabled:t})]}),(0,$i.jsx)("button",{type:"submit",className:"email-submit-btn",disabled:t||!c,children:t?"Sending Reset Code...":"Send Reset Code"}),(0,$i.jsx)("div",{className:"form-links",children:(0,$i.jsx)("button",{type:"button",onClick:()=>k("login"),className:"link-btn",children:"Back to Sign In"})})]});case"reset":return(0,$i.jsxs)("form",{onSubmit:N,className:"email-form",children:[(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,$i.jsx)("input",{type:"email",id:"email",value:c,onChange:e=>u(e.target.value),placeholder:"Enter your email",required:!0,disabled:t})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"confirmationCode",children:"Reset Code"}),(0,$i.jsx)("input",{type:"text",id:"confirmationCode",value:f,onChange:e=>g(e.target.value),placeholder:"Enter the code from your email",required:!0,disabled:t})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"password",children:"New Password"}),(0,$i.jsxs)("div",{className:"password-input",children:[(0,$i.jsx)("input",{type:y?"text":"password",id:"password",value:d,onChange:e=>h(e.target.value),placeholder:"At least 8 characters with uppercase, lowercase, and numbers",required:!0,disabled:t}),(0,$i.jsx)("button",{type:"button",className:"password-toggle",onClick:()=>v(!y),disabled:t,children:y?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,$i.jsx)("input",{type:y?"text":"password",id:"confirmPassword",value:p,onChange:e=>m(e.target.value),placeholder:"Confirm your new password",required:!0,disabled:t})]}),(0,$i.jsx)("button",{type:"submit",className:"email-submit-btn",disabled:t||!c||!f||!d||!p,children:t?"Resetting Password...":"Reset Password"}),(0,$i.jsx)("div",{className:"form-links",children:(0,$i.jsx)("button",{type:"button",onClick:()=>k("login"),className:"link-btn",children:"Back to Sign In"})})]});default:return null}})()]}),(0,$i.jsx)("div",{className:"auth-divider",children:(0,$i.jsx)("span",{children:"or continue with"})}),(0,$i.jsxs)("div",{className:"social-login-buttons",children:[(0,$i.jsx)("button",{className:"social-login-btn google-btn "+("google"===a?"loading":""),onClick:()=>x("google"),disabled:t,children:(0,$i.jsxs)("div",{className:"btn-content",children:[(0,$i.jsx)("span",{className:"social-icon",children:"\ud83d\udd0d"}),(0,$i.jsx)("span",{className:"btn-text",children:"google"===a&&t?"Connecting...":"Continue with Google"})]})}),(0,$i.jsx)("button",{className:"social-login-btn facebook-btn "+("facebook"===a?"loading":""),onClick:()=>x("facebook"),disabled:t,children:(0,$i.jsxs)("div",{className:"btn-content",children:[(0,$i.jsx)("span",{className:"social-icon",children:"\ud83d\udcd8"}),(0,$i.jsx)("span",{className:"btn-text",children:"facebook"===a&&t?"Connecting...":"Continue with Facebook"})]})}),(0,$i.jsx)("button",{className:"social-login-btn x-btn "+("x"===a?"loading":""),onClick:()=>x("x"),disabled:t,children:(0,$i.jsxs)("div",{className:"btn-content",children:[(0,$i.jsx)("span",{className:"social-icon",children:"\ud83d\udc26"}),(0,$i.jsx)("span",{className:"btn-text",children:"x"===a&&t?"Connecting...":"Continue with X"})]})})]}),(0,$i.jsx)("div",{className:"dev-bypass-section",children:(0,$i.jsx)("button",{className:"bypass-btn",onClick:()=>{const t={userId:"dev-user-123",email:"dev@example.com",name:"Dev User",socialProviders:[],lastLogin:(new Date).toISOString()},n={accessToken:`dev-access-token-${Date.now()}`,idToken:`dev-id-token-${Date.now()}`,refreshToken:`dev-refresh-token-${Date.now()}`,expiresIn:604800,tokenType:"Bearer"};localStorage.setItem("mockAuthSession",JSON.stringify({user:t,tokens:n}));const r={tokens:n,expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("steampunk_idle_session",JSON.stringify(r)),localStorage.setItem("steampunk_idle_user",JSON.stringify(t)),e((0,o.loginSuccess)({user:t,tokens:n}))},disabled:t,children:"\ud83d\ude80 Skip Login (Dev Mode)"})}),(0,$i.jsx)("div",{className:"login-footer",children:(0,$i.jsx)("p",{className:"steampunk-flavor",children:'"In the age of steam and gears, every adventurer needs proper credentials!"'})})]})})},Ho=()=>{const e=ms(),{user:t,tokens:n}=is(e=>e.auth),[a,i]=(0,r.useState)(!1),[s,l]=(0,r.useState)(!1),c=e=>{switch(e.toLowerCase()){case"google":return"\ud83d\udd0d";case"facebook":return"\ud83d\udcd8";case"x":case"twitter":return"\ud83d\udc26";case"cognito":return"\ud83d\udd10";default:return"\ud83d\udd17"}};return t?(0,$i.jsxs)("div",{className:"user-profile",children:[(0,$i.jsxs)("div",{className:"profile-header",children:[(0,$i.jsx)("div",{className:"user-avatar",children:(0,$i.jsx)("span",{className:"avatar-icon",children:"\u2699\ufe0f"})}),(0,$i.jsxs)("div",{className:"user-info",children:[(0,$i.jsx)("h3",{className:"user-name",children:t.name||t.email}),(0,$i.jsx)("p",{className:"user-email",children:t.email})]}),(0,$i.jsx)("button",{className:"profile-toggle",onClick:()=>l(!s),title:s?"Hide details":"Show details",children:s?"\u25b2":"\u25bc"})]}),s&&(0,$i.jsxs)("div",{className:"profile-details",children:[(0,$i.jsxs)("div",{className:"detail-section",children:[(0,$i.jsx)("h4",{children:"Account Information"}),(0,$i.jsxs)("div",{className:"detail-item",children:[(0,$i.jsx)("span",{className:"detail-label",children:"User ID:"}),(0,$i.jsx)("span",{className:"detail-value",children:t.userId})]}),(0,$i.jsxs)("div",{className:"detail-item",children:[(0,$i.jsx)("span",{className:"detail-label",children:"Last Login:"}),(0,$i.jsx)("span",{className:"detail-value",children:(u=t.lastLogin,new Date(u).toLocaleString())})]})]}),(0,$i.jsxs)("div",{className:"detail-section",children:[(0,$i.jsx)("h4",{children:"Connected Accounts"}),(0,$i.jsx)("div",{className:"social-providers",children:t.socialProviders.map((e,t)=>(0,$i.jsxs)("div",{className:"provider-item",children:[(0,$i.jsx)("span",{className:"provider-icon",children:c(e)}),(0,$i.jsx)("span",{className:"provider-name",children:e.charAt(0).toUpperCase()+e.slice(1)})]},t))})]}),(0,$i.jsx)("div",{className:"profile-actions",children:(0,$i.jsx)("button",{className:"logout-btn",onClick:async()=>{if(n){i(!0);try{await qi.logout(n.accessToken),e((0,o.ri)())}catch(t){console.error("Logout error:",t),e((0,o.ri)())}finally{i(!1)}}},disabled:a,children:a?(0,$i.jsxs)($i.Fragment,{children:[(0,$i.jsx)("span",{className:"loading-spinner",children:"\u2699\ufe0f"}),"Logging out..."]}):(0,$i.jsxs)($i.Fragment,{children:[(0,$i.jsx)("span",{className:"logout-icon",children:"\ud83d\udeaa"}),"Logout"]})})})]})]}):null;var u};class Go{static async validateCharacterName(e){try{return console.log("[AdaptiveCharacterService] Validating character name using AWS CharacterService"),await Oo.CharacterService.validateCharacterName(e)}catch(t){throw console.error("[AdaptiveCharacterService] Failed to validate character name:",t),t}}static async createCharacter(e){try{return console.log("[AdaptiveCharacterService] Creating character using AWS CharacterService"),await Oo.CharacterService.createCharacter(e)}catch(t){throw console.error("[AdaptiveCharacterService] Failed to create character:",t),t}}static async getCharacter(e){try{return console.log("[AdaptiveCharacterService] Getting character using AWS CharacterService"),await Oo.CharacterService.getCharacter(e)}catch(t){throw console.error("[AdaptiveCharacterService] Failed to get character:",t),t}}static async updateCharacter(e,t){try{return console.log("[AdaptiveCharacterService] Updating character using AWS CharacterService"),await Oo.CharacterService.updateCharacter(e,t)}catch(n){throw console.error("[AdaptiveCharacterService] Failed to update character:",n),n}}static async deleteCharacter(e){try{console.log("[AdaptiveCharacterService] Deleting character using AWS CharacterService"),await Oo.CharacterService.deleteCharacter(e)}catch(t){throw console.error("[AdaptiveCharacterService] Failed to delete character:",t),t}}static async addExperience(e,t){try{return console.log("[AdaptiveCharacterService] Adding experience using AWS CharacterService"),await Oo.CharacterService.addExperience(e,t)}catch(n){throw console.error("[AdaptiveCharacterService] Failed to add experience:",n),n}}static async addSkillExperience(e,t,n,r){try{return console.log("[AdaptiveCharacterService] Adding skill experience using AWS CharacterService"),await Oo.CharacterService.addSkillExperience(e,t,n,r)}catch(a){throw console.error("[AdaptiveCharacterService] Failed to add skill experience:",a),a}}static async addStatPoints(e,t){try{return console.log("[AdaptiveCharacterService] Adding stat points using AWS CharacterService"),await Oo.CharacterService.addStatPoints(e,t)}catch(n){throw console.error("[AdaptiveCharacterService] Failed to add stat points:",n),n}}static getServiceStatus(){return{usingAwsService:!0,serviceHealth:"healthy"}}}var Wo=n(609);const Qo=e=>{let{showInProduction:t=!1,onRetry:n}=e;const[a,i]=(0,r.useState)({isOnline:navigator.onLine,lastChecked:new Date,usingMockServices:!1}),[s,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l();const e=()=>{i(e=>({...e,isOnline:!0})),l()},t=()=>{i(e=>({...e,isOnline:!1,error:"Device is offline",lastChecked:new Date}))};window.addEventListener("online",e),window.addEventListener("offline",t);const n=setInterval(l,3e4);return()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t),clearInterval(n)}},[]);const l=async()=>{if(!s){o(!0);try{const e=await Wo._b.testConnectivity();i({isOnline:e.isOnline,latency:e.latency,error:e.error,lastChecked:new Date,usingMockServices:!1})}catch(e){i(t=>({...t,isOnline:!1,error:e.message,lastChecked:new Date}))}finally{o(!1)}}},c=()=>a.usingMockServices?"Mock Mode":a.isOnline?"Online":"Offline";return(0,$i.jsxs)("div",{className:"network-status-indicator",children:[(0,$i.jsxs)("div",{className:"network-status-compact",children:[(0,$i.jsx)("div",{className:"status-dot",style:{backgroundColor:a.usingMockServices?"#FF9800":a.isOnline?"#4CAF50":"#F44336"},title:`Network Status: ${c()}`,children:(0,$i.jsx)("span",{className:"status-icon",children:a.usingMockServices?"\ud83d\udd27":a.isOnline?"\ud83d\udfe2":"\ud83d\udd34"})}),(0,$i.jsxs)("div",{className:"status-info",children:[(0,$i.jsx)("span",{className:"status-text",children:c()}),a.latency&&(0,$i.jsxs)("span",{className:"latency-text",children:[a.latency,"ms"]})]})]}),(!a.isOnline||a.error)&&(0,$i.jsxs)("div",{className:"network-error-panel",children:[(0,$i.jsx)("div",{className:"error-message",children:a.error||"Network connection lost"}),(0,$i.jsxs)("div",{className:"error-actions",children:[(0,$i.jsx)("button",{onClick:async()=>{await l(),n&&n()},disabled:s,className:"retry-button",children:s?"Checking...":"Retry Connection"}),a.usingMockServices&&(0,$i.jsx)("div",{className:"mock-mode-info",children:(0,$i.jsx)("span",{children:"Using offline mode with mock data"})})]}),(0,$i.jsxs)("div",{className:"network-tips",children:[(0,$i.jsx)("h4",{children:"Troubleshooting Tips:"}),(0,$i.jsxs)("ul",{children:[(0,$i.jsx)("li",{children:"Check your internet connection"}),(0,$i.jsx)("li",{children:"Ensure the backend server is running"}),(0,$i.jsx)("li",{children:"Try refreshing the page"}),(0,$i.jsx)("li",{children:"Mock mode will be used automatically if the server is unavailable"})]})]})]}),(0,$i.jsxs)("div",{className:"last-checked",children:["Last checked: ",a.lastChecked.toLocaleTimeString()]})]})},Ko=e=>{let{onCharacterCreated:t}=e;const n=ms(),{user:a}=is(e=>e.auth),{loading:i,error:s}=is(e=>e.game),[o,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),[m,f]=(0,r.useState)(null),[g,y]=(0,r.useState)(0),[v,x]=(0,r.useState)(null),b=e=>e.length<3?(d("Character name must be at least 3 characters long"),!1):e.length>20?(d("Character name must be no more than 20 characters long"),!1):!!/^[a-zA-Z0-9_-]+$/.test(e)||(d("Character name can only contain letters, numbers, underscores, and hyphens"),!1),E=async e=>{if(e.preventDefault(),a)if(b(o)&&!0===m){n((0,l.setLoading)(!0)),n((0,l.Nh)(null));try{const e=await Go.createCharacter({userId:a.userId,name:o});n((0,l.setCharacter)(e)),t&&t()}catch(s){const t=s instanceof Error?s.message:"Failed to create character";console.error("[CharacterCreation] Character creation failed:",t),n((0,l.Nh)(t))}finally{n((0,l.setLoading)(!1))}}else!1===m&&d("Character name is already taken. Please choose a different name.");else n((0,l.Nh)("User not authenticated"))};return(0,r.useEffect)(()=>()=>{v&&clearTimeout(v)},[v]),(0,$i.jsxs)("div",{className:"character-creation",children:[(0,$i.jsx)(Qo,{onRetry:()=>{n((0,l.Nh)(null)),y(0)}}),(0,$i.jsxs)("div",{className:"character-creation-container",children:[(0,$i.jsx)("h2",{className:"character-creation-title",children:"Create Your Steampunk Character"}),(0,$i.jsx)("p",{className:"character-creation-description",children:"Welcome to the world of steam and gears! Create your character to begin your idle adventure."}),(0,$i.jsxs)("form",{onSubmit:E,className:"character-creation-form",children:[(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"characterName",className:"form-label",children:"Character Name"}),(0,$i.jsxs)("div",{className:"name-input-container",children:[(0,$i.jsx)("input",{type:"text",id:"characterName",value:o,onChange:e=>{const t=e.target.value;if(c(t),f(null),v&&clearTimeout(v),t){if(b(t)){d("");const e=setTimeout(()=>{(async e=>{if(b(e)){p(!0),d(""),f(null);try{const t=await Go.validateCharacterName(e);f(t.available),t.available||d(t.message)}catch(s){console.error("Name validation error:",s),d("Unable to validate name. Please try again."),f(null)}finally{p(!1)}}else f(null)})(t)},500);x(e)}}else d(""),p(!1)},className:"form-input "+(u?"form-input-error":!0===m?"form-input-success":""),placeholder:"Enter your character name",disabled:i,maxLength:20}),h&&(0,$i.jsxs)("div",{className:"name-validation-indicator",children:[(0,$i.jsx)("span",{className:"validation-spinner",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{children:"Checking availability..."})]}),!0===m&&!h&&(0,$i.jsxs)("div",{className:"name-validation-success",children:[(0,$i.jsx)("span",{className:"validation-check",children:"\u2705"}),(0,$i.jsx)("span",{children:"Name is available!"})]})]}),u&&(0,$i.jsx)("span",{className:"form-error",children:u})]}),(0,$i.jsxs)("div",{className:"character-preview",children:[(0,$i.jsx)("h3",{children:"Starting Stats"}),(0,$i.jsxs)("div",{className:"stats-grid",children:[(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-name",children:"Strength"}),(0,$i.jsx)("span",{className:"stat-value",children:"10"})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-name",children:"Dexterity"}),(0,$i.jsx)("span",{className:"stat-value",children:"10"})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-name",children:"Intelligence"}),(0,$i.jsx)("span",{className:"stat-value",children:"10"})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-name",children:"Vitality"}),(0,$i.jsx)("span",{className:"stat-value",children:"10"})]})]}),(0,$i.jsx)("h3",{children:"Starting Skills"}),(0,$i.jsxs)("div",{className:"skills-grid",children:[(0,$i.jsxs)("div",{className:"skill-category",children:[(0,$i.jsx)("h4",{children:"Crafting Skills"}),(0,$i.jsx)("div",{className:"skill-item",children:"Clockmaking: Level 1"}),(0,$i.jsx)("div",{className:"skill-item",children:"Engineering: Level 1"}),(0,$i.jsx)("div",{className:"skill-item",children:"Alchemy: Level 1"}),(0,$i.jsx)("div",{className:"skill-item",children:"Steamcraft: Level 1"})]}),(0,$i.jsxs)("div",{className:"skill-category",children:[(0,$i.jsx)("h4",{children:"Other Skills"}),(0,$i.jsx)("div",{className:"skill-item",children:"Harvesting: Level 1"}),(0,$i.jsx)("div",{className:"skill-item",children:"Combat: Level 1"})]})]})]}),s&&(0,$i.jsxs)("div",{className:"error-message",children:[(0,$i.jsx)("div",{className:"error-text",children:s}),g<3&&(0,$i.jsx)("button",{type:"button",onClick:()=>{y(e=>e+1),n((0,l.Nh)(null)),E(new Event("submit"))},className:"retry-button",disabled:i,children:"Try Again"}),g>=3&&(0,$i.jsxs)("div",{className:"error-help",children:[(0,$i.jsx)("p",{children:"Having trouble? The app is now using offline mode with mock data."}),(0,$i.jsx)("p",{children:"You can still create a character and play the game!"})]})]}),(0,$i.jsx)("button",{type:"submit",className:"create-character-button",disabled:i||!o||!!u||h||!0!==m,children:i?"Creating Character...":"Create Character"})]})]})]})};class Yo{static async createAuction(e){try{const t=await fetch("/api/auction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to create auction")}return(await t.json()).listing}catch(t){throw console.error("Error creating auction:",t),t}}static async searchAuctions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams;e.itemType&&t.append("itemType",e.itemType),e.rarity&&t.append("rarity",e.rarity),e.minPrice&&t.append("minPrice",e.minPrice.toString()),e.maxPrice&&t.append("maxPrice",e.maxPrice.toString()),e.sellerName&&t.append("sellerName",e.sellerName),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder),e.limit&&t.append("limit",e.limit.toString()),e.offset&&t.append("offset",e.offset.toString());const n=await fetch(`/api/auction/search?${t}`);if(!n.ok){const e=await n.json();throw new Error(e.error||"Failed to search auctions")}return(await n.json()).result}catch(t){throw console.error("Error searching auctions:",t),t}}static async getAuction(e){try{const t=await fetch(`/api/auction/${e}`);if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to get auction")}return await t.json()}catch(t){throw console.error("Error getting auction:",t),t}}static async placeBid(e){try{const t=await fetch("/api/auction/bid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to place bid")}return await t.json()}catch(t){throw console.error("Error placing bid:",t),t}}static async buyoutAuction(e){try{const t=await fetch("/api/auction/buyout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to buyout auction")}return await t.json()}catch(t){throw console.error("Error buying out auction:",t),t}}static async getUserAuctions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";try{const n=new URLSearchParams;"all"!==t&&n.append("type",t);const r=await fetch(`/api/auction/user/${e}?${n}`);if(!r.ok){const e=await r.json();throw new Error(e.error||"Failed to get user auctions")}return await r.json()}catch(n){throw console.error("Error getting user auctions:",n),n}}static async cancelAuction(e,t){try{const n=await fetch(`/api/auction/${e}/cancel?userId=${t}`,{method:"DELETE"});if(!n.ok){const e=await n.json();throw new Error(e.error||"Failed to cancel auction")}return await n.json()}catch(n){throw console.error("Error cancelling auction:",n),n}}static calculateListingFee(e){return Math.max(1,Math.floor(.05*e))}static calculateSuccessFee(e){return Math.floor(.1*e)}static calculateTotalFees(e,t){const n=this.calculateListingFee(e),r=t?this.calculateSuccessFee(t):0;return{listingFee:n,successFee:r,totalFees:n+r}}static formatTimeRemaining(e){if(e<=0)return"Expired";const t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60),a=Math.floor(r/24);return a>0?`${a}d ${r%24}h`:r>0?`${r}h ${n%60}m`:n>0?`${n}m ${t%60}s`:`${t}s`}static getStatusDisplayText(e){return{active:"Active",sold:"Sold",expired:"Expired",cancelled:"Cancelled"}[e]||e}static getAuctionTypeDisplayText(e){return{auction:"Auction Only",buyout:"Buyout Only",both:"Auction & Buyout"}[e]||e}static getRarityColor(e){return{common:"#9d9d9d",uncommon:"#1eff00",rare:"#0070dd",epic:"#a335ee",legendary:"#ff8000"}[e]||"#9d9d9d"}static validateCreateAuctionRequest(e){const t=[];return e.sellerId||t.push("Seller ID is required"),e.itemId||t.push("Item ID is required"),(!e.quantity||e.quantity<1)&&t.push("Quantity must be at least 1"),(!e.startingPrice||e.startingPrice<1)&&t.push("Starting price must be at least 1"),e.startingPrice>999999&&t.push("Starting price cannot exceed 999,999"),e.buyoutPrice&&e.buyoutPrice<=e.startingPrice&&t.push("Buyout price must be higher than starting price"),(!e.duration||e.duration<1||e.duration>168)&&t.push("Duration must be between 1 and 168 hours"),["auction","buyout","both"].includes(e.auctionType)||t.push("Invalid auction type"),{isValid:0===t.length,errors:t}}static getSuggestedStartingPrice(e){return{common:10,uncommon:25,rare:50,epic:100,legendary:250}[e]||10}static getSuggestedBuyoutMultiplier(){return 2}static canAffordListing(e,t){return e>=this.calculateListingFee(t)}static canAffordBid(e,t){return e>=t}static getSearchSuggestions(){return{itemTypes:["weapon","armor","trinket","material","consumable","tool"],rarities:["common","uncommon","rare","epic","legendary"],sortOptions:[{value:"timeLeft",label:"Time Remaining"},{value:"price",label:"Price"},{value:"rarity",label:"Rarity"},{value:"name",label:"Name"}]}}}const Jo=e=>{let{auction:t,currentUserId:n,onClose:a,onBidSuccess:i,onBuyoutSuccess:s}=e;const[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(null),{character:f}=is(e=>e.game),g=t.currentBid||t.startingPrice,y=g+1,v=(null===f||void 0===f?void 0:f.currency)||0,x=t.buyoutPrice&&"auction"!==t.auctionType,b=!!o&&Yo.canAffordBid(v,parseInt(o,10)),E=!!x&&Yo.canAffordBid(v,t.buyoutPrice);return(0,$i.jsx)("div",{className:"bidding-interface-overlay",children:(0,$i.jsxs)("div",{className:"bidding-interface",children:[(0,$i.jsxs)("div",{className:"bidding-header",children:[(0,$i.jsxs)("h3",{children:["\ud83d\udcb0 Bid on ",t.itemName]}),(0,$i.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,$i.jsxs)("div",{className:"auction-summary",children:[(0,$i.jsxs)("div",{className:"item-info",children:[(0,$i.jsx)("span",{className:"item-name",children:t.itemName}),(0,$i.jsx)("span",{className:"item-rarity",style:{color:Yo.getRarityColor(t.itemRarity)},children:t.itemRarity.charAt(0).toUpperCase()+t.itemRarity.slice(1)})]}),(0,$i.jsxs)("div",{className:"price-summary",children:[(0,$i.jsxs)("div",{className:"current-price",children:[(0,$i.jsx)("span",{children:"Current Price: "}),(0,$i.jsxs)("strong",{children:["\ud83d\udcb0 ",g]})]}),t.buyoutPrice&&(0,$i.jsxs)("div",{className:"buyout-price",children:[(0,$i.jsx)("span",{children:"Buyout Price: "}),(0,$i.jsxs)("strong",{children:["\ud83d\udcb0 ",t.buyoutPrice]})]})]}),(0,$i.jsxs)("div",{className:"user-currency",children:[(0,$i.jsx)("span",{children:"Your Currency: "}),(0,$i.jsxs)("strong",{children:["\ud83d\udcb0 ",v]})]})]}),d&&(0,$i.jsx)("div",{className:"error-message",children:(0,$i.jsxs)("span",{children:["\u274c ",d]})}),p&&(0,$i.jsx)("div",{className:"success-message",children:(0,$i.jsxs)("span",{children:["\u2705 ",p]})}),!p&&(0,$i.jsxs)("div",{className:"bidding-actions",children:[(0,$i.jsxs)("div",{className:"bid-section",children:[(0,$i.jsx)("h4",{children:"Place Bid"}),(0,$i.jsxs)("div",{className:"bid-input-group",children:[(0,$i.jsxs)("label",{htmlFor:"bidAmount",children:["Bid Amount (minimum: ",y,")"]}),(0,$i.jsx)("input",{id:"bidAmount",type:"number",min:y,max:Math.min(v,999999),value:o,onChange:e=>{var t;(""===(t=e.target.value)||/^\d+$/.test(t)&&parseInt(t,10)>=0)&&(l(t),h(null))},placeholder:`Enter amount (min: ${y})`,disabled:c})]}),(0,$i.jsx)("button",{className:"place-bid-button",onClick:async()=>{if(!o)return;const e=parseInt(o,10),r=(e=>e<y?`Bid must be at least ${y} (current price + 1)`:e>v?`Insufficient funds. You have ${v} Steam Coins`:e>999999?"Bid cannot exceed 999,999 Steam Coins":null)(e);if(r)h(r);else{u(!0),h(null),m(null);try{await Yo.placeBid({listingId:t.listingId,bidderId:n,bidAmount:e}),m(`Bid placed successfully for ${e} Steam Coins!`),setTimeout(()=>{i()},1500)}catch(a){h(a instanceof Error?a.message:"Failed to place bid")}finally{u(!1)}}},disabled:c||!o||!b,children:c?"Placing Bid...":`Place Bid (${o||"0"})`}),o&&!b&&(0,$i.jsx)("div",{className:"insufficient-funds-warning",children:"\u26a0\ufe0f Insufficient funds for this bid"})]}),x&&(0,$i.jsxs)("div",{className:"buyout-section",children:[(0,$i.jsx)("h4",{children:"Buy Now"}),(0,$i.jsxs)("p",{children:["Purchase immediately for ",t.buyoutPrice," Steam Coins"]}),(0,$i.jsx)("button",{className:"buyout-button",onClick:async()=>{if(x&&t.buyoutPrice)if(E){u(!0),h(null),m(null);try{await Yo.buyoutAuction({listingId:t.listingId,buyerId:n}),m(`Item purchased successfully for ${t.buyoutPrice} Steam Coins!`),setTimeout(()=>{s()},1500)}catch(e){h(e instanceof Error?e.message:"Failed to buy item")}finally{u(!1)}}else h(`Insufficient funds. You need ${t.buyoutPrice} Steam Coins`)},disabled:c||!E,children:c?"Processing...":`Buy Now (${t.buyoutPrice})`}),!E&&(0,$i.jsx)("div",{className:"insufficient-funds-warning",children:"\u26a0\ufe0f Insufficient funds for buyout"})]})]}),(0,$i.jsx)("div",{className:"bidding-footer",children:(0,$i.jsx)("button",{className:"cancel-button",onClick:a,disabled:c,children:"Cancel"})})]})})},Xo=e=>{let{auction:t,currentUserId:n,onAuctionUpdate:a}=e;const[i,s]=(0,r.useState)(0),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=()=>{const e=(new Date).getTime(),n=new Date(t.expiresAt).getTime()-e;s(n),u(n<=0)};e();const n=setInterval(e,1e3);return()=>clearInterval(n)},[t.expiresAt]);const d=t.sellerId===n,h=!d&&!c&&"active"===t.status,p=h&&t.buyoutPrice&&"auction"!==t.auctionType,m=t.currentBid||t.startingPrice,f=Yo.getRarityColor(t.itemRarity);return(0,$i.jsxs)("div",{className:`auction-card ${t.status} ${c?"expired":""}`,children:[(0,$i.jsxs)("div",{className:"auction-header",children:[(0,$i.jsxs)("div",{className:"item-info",children:[(0,$i.jsx)("h4",{className:"item-name",style:{color:f},children:t.itemName}),(0,$i.jsxs)("div",{className:"item-details",children:[(0,$i.jsx)("span",{className:"item-rarity",style:{color:f},children:t.itemRarity.charAt(0).toUpperCase()+t.itemRarity.slice(1)}),t.quantity>1&&(0,$i.jsxs)("span",{className:"item-quantity",children:["x",t.quantity]})]})]}),(0,$i.jsx)("div",{className:"auction-status",children:(0,$i.jsx)("span",{className:`status-badge ${t.status}`,children:Yo.getStatusDisplayText(t.status)})})]}),(0,$i.jsxs)("div",{className:"auction-body",children:[(0,$i.jsxs)("div",{className:"seller-info",children:[(0,$i.jsx)("span",{className:"seller-label",children:"Seller:"}),(0,$i.jsx)("span",{className:"seller-name",children:t.sellerName})]}),(0,$i.jsxs)("div",{className:"price-info",children:[(0,$i.jsxs)("div",{className:"current-price",children:[(0,$i.jsx)("span",{className:"price-label",children:"Current Price:"}),(0,$i.jsxs)("span",{className:"price-value",children:["\ud83d\udcb0 ",m]})]}),t.buyoutPrice&&(0,$i.jsxs)("div",{className:"buyout-price",children:[(0,$i.jsx)("span",{className:"price-label",children:"Buyout:"}),(0,$i.jsxs)("span",{className:"price-value",children:["\ud83d\udcb0 ",t.buyoutPrice]})]})]}),(0,$i.jsxs)("div",{className:"time-info",children:[(0,$i.jsx)("span",{className:"time-label",children:c?"Expired":"Time Remaining:"}),(0,$i.jsx)("span",{className:"time-value "+(c?"expired":""),children:Yo.formatTimeRemaining(i)})]}),t.currentBidderName&&(0,$i.jsxs)("div",{className:"current-bidder",children:[(0,$i.jsx)("span",{className:"bidder-label",children:"Current Bidder:"}),(0,$i.jsx)("span",{className:"bidder-name",children:t.currentBidderName})]})]}),(0,$i.jsxs)("div",{className:"auction-actions",children:[d&&(0,$i.jsx)("div",{className:"own-auction-notice",children:(0,$i.jsx)("span",{children:"\ud83d\udcdd Your Auction"})}),h&&(0,$i.jsxs)("div",{className:"bid-actions",children:[(0,$i.jsx)("button",{className:"bid-button",onClick:()=>l(!0),children:"\ud83d\udcb0 Place Bid"}),p&&(0,$i.jsx)("button",{className:"buyout-button",onClick:()=>{l(!0)},children:"\u26a1 Buy Now"})]}),c&&"active"===t.status&&(0,$i.jsx)("div",{className:"expired-notice",children:(0,$i.jsx)("span",{children:"\u23f0 Auction Expired"})}),"sold"===t.status&&(0,$i.jsx)("div",{className:"sold-notice",children:(0,$i.jsx)("span",{children:"\u2705 Sold"})})]}),o&&(0,$i.jsx)(Jo,{auction:t,currentUserId:n,onClose:()=>l(!1),onBidSuccess:()=>{l(!1),a()},onBuyoutSuccess:()=>{a()}})]})},Zo=e=>{let{filters:t,onFilterChange:n,loading:r}=e;const a=Yo.getSearchSuggestions(),i=(e,t)=>{n({[e]:t})},s=(e,t)=>{const r=""===t?void 0:parseInt(t,10);(""===t||!isNaN(r)&&r>=0)&&n({[e]:r})},o=!!(t.itemType||t.rarity||t.minPrice||t.maxPrice||t.sellerName);return(0,$i.jsxs)("div",{className:"search-filters",children:[(0,$i.jsxs)("div",{className:"filters-header",children:[(0,$i.jsx)("h3",{children:"\ud83d\udd0d Search Filters"}),o&&(0,$i.jsx)("button",{className:"clear-filters-button",onClick:()=>{n({itemType:void 0,rarity:void 0,minPrice:void 0,maxPrice:void 0,sellerName:void 0,sortBy:"timeLeft",sortOrder:"asc"})},disabled:r,children:"Clear All"})]}),(0,$i.jsxs)("div",{className:"filters-grid",children:[(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"itemType",children:"Item Type"}),(0,$i.jsxs)("select",{id:"itemType",value:t.itemType||"",onChange:e=>i("itemType",e.target.value||void 0),disabled:r,children:[(0,$i.jsx)("option",{value:"",children:"All Types"}),a.itemTypes.map(e=>(0,$i.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})]}),(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"rarity",children:"Rarity"}),(0,$i.jsxs)("select",{id:"rarity",value:t.rarity||"",onChange:e=>i("rarity",e.target.value||void 0),disabled:r,children:[(0,$i.jsx)("option",{value:"",children:"All Rarities"}),a.rarities.map(e=>(0,$i.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})]}),(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"minPrice",children:"Min Price"}),(0,$i.jsx)("input",{id:"minPrice",type:"number",min:"0",placeholder:"0",value:t.minPrice||"",onChange:e=>s("minPrice",e.target.value),disabled:r})]}),(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"maxPrice",children:"Max Price"}),(0,$i.jsx)("input",{id:"maxPrice",type:"number",min:"0",placeholder:"No limit",value:t.maxPrice||"",onChange:e=>s("maxPrice",e.target.value),disabled:r})]}),(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"sellerName",children:"Seller Name"}),(0,$i.jsx)("input",{id:"sellerName",type:"text",placeholder:"Enter seller name",value:t.sellerName||"",onChange:e=>i("sellerName",e.target.value||void 0),disabled:r})]}),(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"sortBy",children:"Sort By"}),(0,$i.jsx)("select",{id:"sortBy",value:t.sortBy||"timeLeft",onChange:e=>i("sortBy",e.target.value),disabled:r,children:a.sortOptions.map(e=>(0,$i.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"sortOrder",children:"Order"}),(0,$i.jsxs)("select",{id:"sortOrder",value:t.sortOrder||"asc",onChange:e=>i("sortOrder",e.target.value),disabled:r,children:[(0,$i.jsx)("option",{value:"asc",children:"Ascending"}),(0,$i.jsx)("option",{value:"desc",children:"Descending"})]})]})]}),o&&(0,$i.jsxs)("div",{className:"active-filters",children:[(0,$i.jsx)("span",{className:"active-filters-label",children:"Active filters:"}),(0,$i.jsxs)("div",{className:"filter-tags",children:[t.itemType&&(0,$i.jsxs)("span",{className:"filter-tag",children:["Type: ",t.itemType,(0,$i.jsx)("button",{onClick:()=>i("itemType",void 0),children:"\xd7"})]}),t.rarity&&(0,$i.jsxs)("span",{className:"filter-tag",children:["Rarity: ",t.rarity,(0,$i.jsx)("button",{onClick:()=>i("rarity",void 0),children:"\xd7"})]}),t.minPrice&&(0,$i.jsxs)("span",{className:"filter-tag",children:["Min: ",t.minPrice,(0,$i.jsx)("button",{onClick:()=>i("minPrice",void 0),children:"\xd7"})]}),t.maxPrice&&(0,$i.jsxs)("span",{className:"filter-tag",children:["Max: ",t.maxPrice,(0,$i.jsx)("button",{onClick:()=>i("maxPrice",void 0),children:"\xd7"})]}),t.sellerName&&(0,$i.jsxs)("span",{className:"filter-tag",children:["Seller: ",t.sellerName,(0,$i.jsx)("button",{onClick:()=>i("sellerName",void 0),children:"\xd7"})]})]})]})]})},el=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!1),[i,s]=(0,r.useState)(null),[o,l]=(0,r.useState)({sortBy:"timeLeft",sortOrder:"asc",limit:20,offset:0}),[c,u]=(0,r.useState)(0),[d,h]=(0,r.useState)(!1),{character:p}=is(e=>e.game),m=(0,r.useCallback)(async function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(p){a(!0),s(null);try{const r=await Yo.searchAuctions(e);t(n?e=>[...e,...r.listings]:r.listings),u(r.totalCount),h(r.hasMore)}catch(r){s(r instanceof Error?r.message:"Failed to load auctions"),console.error("Error searching auctions:",r)}finally{a(!1)}}},[p]);(0,r.useEffect)(()=>{m(o)},[m,o]);const f=()=>{m({...o,offset:0})};return p?(0,$i.jsxs)("div",{className:"auction-browser",children:[(0,$i.jsx)("div",{className:"browser-header",children:(0,$i.jsxs)("div",{className:"results-info",children:[(0,$i.jsx)("span",{className:"results-count",children:c>0?`${c} auctions found`:"No auctions found"}),(0,$i.jsx)("button",{className:"refresh-button",onClick:f,disabled:n,children:"\ud83d\udd04 Refresh"})]})}),(0,$i.jsx)(Zo,{filters:o,onFilterChange:e=>{const t={...o,...e,offset:0};l(t)},loading:n}),i&&(0,$i.jsxs)("div",{className:"browser-error",children:[(0,$i.jsxs)("p",{children:["\u274c ",i]}),(0,$i.jsx)("button",{onClick:f,children:"Try Again"})]}),(0,$i.jsx)("div",{className:"auction-grid",children:e.map(e=>(0,$i.jsx)(Xo,{auction:e,currentUserId:p.userId,onAuctionUpdate:()=>f()},e.listingId))}),n&&(0,$i.jsxs)("div",{className:"loading-indicator",children:[(0,$i.jsx)("div",{className:"spinner"}),(0,$i.jsx)("p",{children:"Loading auctions..."})]}),d&&!n&&(0,$i.jsx)("div",{className:"load-more-section",children:(0,$i.jsx)("button",{className:"load-more-button",onClick:()=>{if(d&&!n){const t={...o,offset:e.length};l(t),m(t,!0)}},children:"Load More Auctions"})}),0===e.length&&!n&&!i&&(0,$i.jsxs)("div",{className:"no-auctions",children:[(0,$i.jsx)("div",{className:"no-auctions-icon",children:"\ud83c\udfea"}),(0,$i.jsx)("h3",{children:"No Auctions Found"}),(0,$i.jsx)("p",{children:"Try adjusting your search filters or check back later."})]})]}):(0,$i.jsx)("div",{className:"auction-browser",children:(0,$i.jsx)("div",{className:"browser-error",children:(0,$i.jsx)("p",{children:"Character required to browse auctions."})})})},tl=()=>{const[e,t]=(0,r.useState)(null),[n,a]=(0,r.useState)([]),[i,s]=(0,r.useState)({quantity:1,startingPrice:10,duration:24,auctionType:"both"}),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(!0),{character:f}=is(e=>e.game);(0,r.useEffect)(()=>{g()},[f]);const g=async()=>{if(f){m(!0);try{const e=[{userId:f.userId,itemId:"brass-gear-1",quantity:5,acquiredAt:new Date},{userId:f.userId,itemId:"steam-crystal-1",quantity:2,acquiredAt:new Date},{userId:f.userId,itemId:"copper-wrench-1",quantity:1,acquiredAt:new Date}];a(e)}catch(e){u("Failed to load inventory")}finally{m(!1)}}},y=(e,t)=>{if(s(n=>({...n,[e]:t})),u(null),"startingPrice"===e&&"number"===typeof t){const e=Math.floor(t*Yo.getSuggestedBuyoutMultiplier());s(t=>({...t,buyoutPrice:e}))}},v=i.startingPrice?Yo.calculateTotalFees(i.startingPrice,i.buyoutPrice):{listingFee:0,successFee:0,totalFees:0};return f?(0,$i.jsxs)("div",{className:"create-auction-form",children:[(0,$i.jsxs)("div",{className:"form-header",children:[(0,$i.jsx)("h3",{children:"\ud83d\udcdd Create New Auction"}),(0,$i.jsxs)("div",{className:"user-currency",children:["Your Currency: ",(0,$i.jsxs)("strong",{children:["\ud83d\udcb0 ",f.currency||0]})]})]}),c&&(0,$i.jsx)("div",{className:"error-message",children:(0,$i.jsxs)("span",{children:["\u274c ",c]})}),d&&(0,$i.jsx)("div",{className:"success-message",children:(0,$i.jsxs)("span",{children:["\u2705 ",d]})}),(0,$i.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),!f||!e)return;const r=(()=>{if(!f)return"Character required";if(!e)return"Please select an item to auction";if(!i.quantity||i.quantity<1)return"Quantity must be at least 1";if(i.quantity>e.quantity)return"Cannot auction more than you own";if(!i.startingPrice||i.startingPrice<1)return"Starting price must be at least 1";if(!i.duration||i.duration<1||i.duration>168)return"Duration must be between 1 and 168 hours";if(i.buyoutPrice&&i.buyoutPrice<=i.startingPrice)return"Buyout price must be higher than starting price";const t=Yo.calculateListingFee(i.startingPrice);return Yo.canAffordListing(f.currency||0,i.startingPrice)?null:`Insufficient funds for listing fee (${t} Steam Coins)`})();if(r)return void u(r);const a={sellerId:f.userId,itemId:e.itemId,quantity:i.quantity,startingPrice:i.startingPrice,buyoutPrice:i.buyoutPrice,duration:i.duration,auctionType:i.auctionType},o=Yo.validateCreateAuctionRequest(a);if(o.isValid){l(!0),u(null),h(null);try{await Yo.createAuction(a),h("Auction created successfully!"),t(null),s({quantity:1,startingPrice:10,duration:24,auctionType:"both"}),g()}catch(c){u(c instanceof Error?c.message:"Failed to create auction")}finally{l(!1)}}else u(o.errors.join(", "))},children:[(0,$i.jsxs)("div",{className:"form-section",children:[(0,$i.jsx)("h4",{children:"Select Item"}),p?(0,$i.jsx)("div",{className:"loading-inventory",children:"Loading inventory..."}):0===n.length?(0,$i.jsxs)("div",{className:"no-items",children:[(0,$i.jsx)("p",{children:"No items available for auction."}),(0,$i.jsx)("p",{children:"Craft or find items through activities to list them here."})]}):(0,$i.jsx)("div",{className:"inventory-grid",children:n.map(n=>(0,$i.jsxs)("div",{className:"inventory-item "+((null===e||void 0===e?void 0:e.itemId)===n.itemId?"selected":""),onClick:()=>(e=>{t(e),s(t=>({...t,itemId:e.itemId,quantity:1,startingPrice:Yo.getSuggestedStartingPrice("common")})),u(null)})(n),children:[(0,$i.jsx)("div",{className:"item-name",children:n.itemId.replace(/-/g," ")}),(0,$i.jsxs)("div",{className:"item-quantity",children:["x",n.quantity]})]},n.itemId))})]}),e&&(0,$i.jsxs)($i.Fragment,{children:[(0,$i.jsxs)("div",{className:"form-section",children:[(0,$i.jsx)("h4",{children:"Auction Details"}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsxs)("label",{htmlFor:"quantity",children:["Quantity (max: ",e.quantity,")"]}),(0,$i.jsx)("input",{id:"quantity",type:"number",min:"1",max:e.quantity,value:i.quantity||1,onChange:e=>y("quantity",parseInt(e.target.value,10)),disabled:o})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"startingPrice",children:"Starting Price"}),(0,$i.jsx)("input",{id:"startingPrice",type:"number",min:"1",max:"999999",value:i.startingPrice||"",onChange:e=>y("startingPrice",parseInt(e.target.value,10)),disabled:o})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"buyoutPrice",children:"Buyout Price (optional)"}),(0,$i.jsx)("input",{id:"buyoutPrice",type:"number",min:i.startingPrice?i.startingPrice+1:2,max:"999999",value:i.buyoutPrice||"",onChange:e=>y("buyoutPrice",e.target.value?parseInt(e.target.value,10):void 0),disabled:o})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"duration",children:"Duration (hours)"}),(0,$i.jsxs)("select",{id:"duration",value:i.duration||24,onChange:e=>y("duration",parseInt(e.target.value,10)),disabled:o,children:[(0,$i.jsx)("option",{value:1,children:"1 hour"}),(0,$i.jsx)("option",{value:6,children:"6 hours"}),(0,$i.jsx)("option",{value:12,children:"12 hours"}),(0,$i.jsx)("option",{value:24,children:"24 hours"}),(0,$i.jsx)("option",{value:48,children:"48 hours"}),(0,$i.jsx)("option",{value:72,children:"72 hours"}),(0,$i.jsx)("option",{value:168,children:"1 week"})]})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"auctionType",children:"Auction Type"}),(0,$i.jsxs)("select",{id:"auctionType",value:i.auctionType||"both",onChange:e=>y("auctionType",e.target.value),disabled:o,children:[(0,$i.jsx)("option",{value:"auction",children:"Auction Only"}),(0,$i.jsx)("option",{value:"buyout",children:"Buyout Only"}),(0,$i.jsx)("option",{value:"both",children:"Auction & Buyout"})]})]})]}),(0,$i.jsxs)("div",{className:"form-section",children:[(0,$i.jsx)("h4",{children:"Fee Summary"}),(0,$i.jsxs)("div",{className:"fee-breakdown",children:[(0,$i.jsxs)("div",{className:"fee-item",children:[(0,$i.jsx)("span",{children:"Listing Fee (5%):"}),(0,$i.jsxs)("span",{children:["\ud83d\udcb0 ",v.listingFee]})]}),(0,$i.jsxs)("div",{className:"fee-item",children:[(0,$i.jsx)("span",{children:"Success Fee (10% if sold):"}),(0,$i.jsxs)("span",{children:["\ud83d\udcb0 ",v.successFee]})]}),(0,$i.jsxs)("div",{className:"fee-total",children:[(0,$i.jsx)("span",{children:"Total Upfront Cost:"}),(0,$i.jsxs)("span",{children:["\ud83d\udcb0 ",v.listingFee]})]})]})]}),(0,$i.jsx)("div",{className:"form-actions",children:(0,$i.jsx)("button",{type:"submit",className:"create-auction-button",disabled:o||!e,children:o?"Creating Auction...":"Create Auction"})})]})]})]}):(0,$i.jsx)("div",{className:"create-auction-form",children:(0,$i.jsx)("div",{className:"form-error",children:(0,$i.jsx)("p",{children:"Character required to create auctions."})})})},nl=e=>{let{auction:t,currentUserId:n,category:a,onAuctionUpdate:i}=e;const[s,o]=(0,r.useState)(0),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=()=>{const e=(new Date).getTime(),n=new Date(t.expiresAt).getTime()-e;o(n),c(n<=0)};e();const n=setInterval(e,1e3);return()=>clearInterval(n)},[t.expiresAt]);const m=t.currentBid||t.startingPrice,f=Yo.getRarityColor(t.itemRarity),g=t.sellerId===n,y=g&&"active"===t.status&&!t.currentBid;return(0,$i.jsxs)("div",{className:`auction-management-card ${t.status} ${a}`,children:[(0,$i.jsxs)("div",{className:"card-header",children:[(0,$i.jsxs)("div",{className:"item-info",children:[(0,$i.jsx)("h4",{className:"item-name",style:{color:f},children:t.itemName}),(0,$i.jsxs)("div",{className:"item-details",children:[(0,$i.jsx)("span",{className:"item-rarity",style:{color:f},children:t.itemRarity.charAt(0).toUpperCase()+t.itemRarity.slice(1)}),t.quantity>1&&(0,$i.jsxs)("span",{className:"item-quantity",children:["x",t.quantity]})]})]}),(0,$i.jsxs)("div",{className:"status-info",children:[(0,$i.jsxs)("span",{className:`status-badge ${t.status}`,children:[(v=t.status,{active:"\ud83d\udfe2",sold:"\u2705",expired:"\u23f0",cancelled:"\u274c"}[v]||"\u2753")," ",Yo.getStatusDisplayText(t.status)]}),(0,$i.jsx)("span",{className:"action-type",children:"selling"===a?g?"Your Listing":"Selling":t.currentBidderId===n?"Your Bid":"Bidding"})]})]}),(0,$i.jsxs)("div",{className:"card-body",children:[(0,$i.jsxs)("div",{className:"auction-details",children:[(0,$i.jsxs)("div",{className:"detail-row",children:[(0,$i.jsx)("span",{className:"detail-label",children:"selling"===a?"Buyer:":"Seller:"}),(0,$i.jsx)("span",{className:"detail-value",children:"selling"===a?t.currentBidderName||"No bids yet":t.sellerName})]}),(0,$i.jsxs)("div",{className:"detail-row",children:[(0,$i.jsx)("span",{className:"detail-label",children:"Starting Price:"}),(0,$i.jsxs)("span",{className:"detail-value",children:["\ud83d\udcb0 ",t.startingPrice]})]}),(0,$i.jsxs)("div",{className:"detail-row",children:[(0,$i.jsx)("span",{className:"detail-label",children:"Current Price:"}),(0,$i.jsxs)("span",{className:"detail-value",children:["\ud83d\udcb0 ",m]})]}),t.buyoutPrice&&(0,$i.jsxs)("div",{className:"detail-row",children:[(0,$i.jsx)("span",{className:"detail-label",children:"Buyout Price:"}),(0,$i.jsxs)("span",{className:"detail-value",children:["\ud83d\udcb0 ",t.buyoutPrice]})]}),(0,$i.jsxs)("div",{className:"detail-row",children:[(0,$i.jsx)("span",{className:"detail-label",children:l?"Expired:":"Time Remaining:"}),(0,$i.jsx)("span",{className:"detail-value "+(l?"expired":""),children:Yo.formatTimeRemaining(s)})]}),t.bidHistory.length>0&&(0,$i.jsxs)("div",{className:"detail-row",children:[(0,$i.jsx)("span",{className:"detail-label",children:"Total Bids:"}),(0,$i.jsx)("span",{className:"detail-value",children:t.bidHistory.length})]})]}),"selling"===a&&"sold"===t.status&&(0,$i.jsxs)("div",{className:"sale-summary",children:[(0,$i.jsxs)("div",{className:"sale-info",children:[(0,$i.jsx)("span",{className:"sale-label",children:"Final Sale:"}),(0,$i.jsxs)("span",{className:"sale-value",children:["\ud83d\udcb0 ",m]})]}),(0,$i.jsxs)("div",{className:"fee-info",children:[(0,$i.jsx)("span",{className:"fee-label",children:"Fees:"}),(0,$i.jsxs)("span",{className:"fee-value",children:["\ud83d\udcb0 ",t.fees.totalFees]})]}),(0,$i.jsxs)("div",{className:"profit-info",children:[(0,$i.jsx)("span",{className:"profit-label",children:"Net Profit:"}),(0,$i.jsxs)("span",{className:"profit-value",children:["\ud83d\udcb0 ",m-t.fees.totalFees]})]})]}),"bidding"===a&&t.currentBidderId===n&&(0,$i.jsxs)("div",{className:"bid-status",children:[(0,$i.jsxs)("div",{className:"current-bid-info",children:[(0,$i.jsx)("span",{className:"bid-label",children:"Your Bid:"}),(0,$i.jsxs)("span",{className:"bid-value",children:["\ud83d\udcb0 ",t.currentBid]})]}),"active"===t.status&&(0,$i.jsx)("div",{className:"bid-status-text",children:l?"\u23f0 Auction ended":"\ud83c\udfaf You are the highest bidder"})]})]}),(0,$i.jsxs)("div",{className:"card-actions",children:[h&&(0,$i.jsx)("div",{className:"action-error",children:(0,$i.jsxs)("span",{children:["\u274c ",h]})}),y&&(0,$i.jsx)("button",{className:"cancel-auction-button",onClick:async()=>{if(window.confirm("Are you sure you want to cancel this auction?")){d(!0),p(null);try{await Yo.cancelAuction(t.listingId,n),i()}catch(e){p(e instanceof Error?e.message:"Failed to cancel auction")}finally{d(!1)}}},disabled:u,children:u?"Cancelling...":"\u274c Cancel Auction"}),"active"===t.status&&!y&&g&&t.currentBid&&(0,$i.jsx)("div",{className:"cannot-cancel-notice",children:(0,$i.jsx)("span",{children:"\u26a0\ufe0f Cannot cancel - auction has bids"})}),(0,$i.jsxs)("div",{className:"auction-metadata",children:[(0,$i.jsxs)("span",{className:"created-date",children:["Created: ",new Date(t.createdAt).toLocaleDateString()]}),t.completedAt&&(0,$i.jsxs)("span",{className:"completed-date",children:["Completed: ",new Date(t.completedAt).toLocaleDateString()]})]})]})]});var v},rl=()=>{const[e,t]=(0,r.useState)(null),[n,a]=(0,r.useState)(!1),[i,s]=(0,r.useState)(null),[o,l]=(0,r.useState)("selling"),[c,u]=(0,r.useState)("all"),{character:d}=is(e=>e.game);(0,r.useEffect)(()=>{d&&h()},[d]);const h=async()=>{if(d){a(!0),s(null);try{const e=await Yo.getUserAuctions(d.userId);t(e)}catch(e){s(e instanceof Error?e.message:"Failed to load auctions"),console.error("Error loading user auctions:",e)}finally{a(!1)}}},p=()=>{h()},m=(()=>{if(!e)return[];const t=e[o];return"all"===c?[...t.active,...t.sold,...t.expired,...t.cancelled]:t[c]||[]})();return d?(0,$i.jsxs)("div",{className:"my-auctions",children:[(0,$i.jsxs)("div",{className:"auctions-header",children:[(0,$i.jsx)("h3",{children:"\ud83d\udcca My Auctions"}),(0,$i.jsx)("button",{className:"refresh-button",onClick:h,disabled:n,children:"\ud83d\udd04 Refresh"})]}),e&&(0,$i.jsx)("div",{className:"auctions-summary",children:(0,$i.jsxs)("div",{className:"summary-stats",children:[(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Selling:"}),(0,$i.jsxs)("span",{className:"stat-value",children:[e.summary.activeSelling," active / ",e.summary.totalSelling," total"]})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Bidding:"}),(0,$i.jsxs)("span",{className:"stat-value",children:[e.summary.activeBidding," active / ",e.summary.totalBidding," total"]})]})]})}),(0,$i.jsxs)("div",{className:"auctions-controls",children:[(0,$i.jsxs)("div",{className:"category-tabs",children:[(0,$i.jsx)("button",{className:"category-tab "+("selling"===o?"active":""),onClick:()=>l("selling"),children:"\ud83d\udce4 Selling"}),(0,$i.jsx)("button",{className:"category-tab "+("bidding"===o?"active":""),onClick:()=>l("bidding"),children:"\ud83d\udce5 Bidding"})]}),(0,$i.jsxs)("div",{className:"filter-tabs",children:[(0,$i.jsx)("button",{className:"filter-tab "+("all"===c?"active":""),onClick:()=>u("all"),children:"All"}),(0,$i.jsx)("button",{className:"filter-tab "+("active"===c?"active":""),onClick:()=>u("active"),children:"Active"}),(0,$i.jsx)("button",{className:"filter-tab "+("sold"===c?"active":""),onClick:()=>u("sold"),children:"Sold"}),(0,$i.jsx)("button",{className:"filter-tab "+("expired"===c?"active":""),onClick:()=>u("expired"),children:"Expired"}),(0,$i.jsx)("button",{className:"filter-tab "+("cancelled"===c?"active":""),onClick:()=>u("cancelled"),children:"Cancelled"})]})]}),i&&(0,$i.jsxs)("div",{className:"auctions-error",children:[(0,$i.jsxs)("p",{children:["\u274c ",i]}),(0,$i.jsx)("button",{onClick:h,children:"Try Again"})]}),n&&(0,$i.jsxs)("div",{className:"loading-indicator",children:[(0,$i.jsx)("div",{className:"spinner"}),(0,$i.jsx)("p",{children:"Loading your auctions..."})]}),(0,$i.jsxs)("div",{className:"auctions-list",children:[0===m.length&&!n&&!i&&(0,$i.jsxs)("div",{className:"no-auctions",children:[(0,$i.jsx)("div",{className:"no-auctions-icon",children:"selling"===o?"\ud83d\udce4":"\ud83d\udce5"}),(0,$i.jsxs)("h4",{children:["No ",o," auctions found"]}),(0,$i.jsx)("p",{children:"selling"===o?"Create your first auction to start selling items!":"Start bidding on items to see them here!"})]}),m.map(e=>(0,$i.jsx)(nl,{auction:e,currentUserId:d.userId,category:o,onAuctionUpdate:p},e.listingId))]})]}):(0,$i.jsx)("div",{className:"my-auctions",children:(0,$i.jsx)("div",{className:"auctions-error",children:(0,$i.jsx)("p",{children:"Character required to view auctions."})})})},al=()=>{const[e,t]=(0,r.useState)("browse"),{character:n}=is(e=>e.game);return n?(0,$i.jsxs)("div",{className:"marketplace-hub",children:[(0,$i.jsxs)("div",{className:"marketplace-header",children:[(0,$i.jsx)("h2",{children:"\ud83c\udfea Steampunk Marketplace"}),(0,$i.jsx)("div",{className:"currency-display",children:(0,$i.jsxs)("span",{className:"currency-amount",children:["\ud83d\udcb0 ",n.currency||0," Steam Coins"]})})]}),(0,$i.jsxs)("div",{className:"marketplace-tabs",children:[(0,$i.jsx)("button",{className:"tab-button "+("browse"===e?"active":""),onClick:()=>t("browse"),children:"\ud83d\udd0d Browse Auctions"}),(0,$i.jsx)("button",{className:"tab-button "+("create"===e?"active":""),onClick:()=>t("create"),children:"\ud83d\udcdd Create Auction"}),(0,$i.jsx)("button",{className:"tab-button "+("manage"===e?"active":""),onClick:()=>t("manage"),children:"\ud83d\udcca My Auctions"})]}),(0,$i.jsxs)("div",{className:"marketplace-content",children:["browse"===e&&(0,$i.jsx)(el,{}),"create"===e&&(0,$i.jsx)(tl,{}),"manage"===e&&(0,$i.jsx)(rl,{})]})]}):(0,$i.jsx)("div",{className:"marketplace-hub",children:(0,$i.jsxs)("div",{className:"marketplace-error",children:[(0,$i.jsx)("h3",{children:"Marketplace Unavailable"}),(0,$i.jsx)("p",{children:"You need a character to access the marketplace."})]})})},il=()=>{const{character:e}=is(e=>e.game),[t,n]=(0,r.useState)("level"),[a,i]=(0,r.useState)([]),[s,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{o(!0),setTimeout(()=>{const n=(t=>{const n=[{username:"GearMaster",level:25,experience:62500,currency:1250,guildName:"Steam Engineers"},{username:"ClockworkQueen",level:23,experience:52900,currency:980,guildName:"Brass Inventors"},{username:"SteamPunk87",level:22,experience:48400,currency:1100},{username:"CogWheeler",level:21,experience:44100,currency:850,guildName:"Steam Engineers"},{username:"BrassBuilder",level:20,experience:4e4,currency:750},{username:"MechMaster",level:19,experience:36100,currency:920,guildName:"Iron Works"},{username:"SteamSmith",level:18,experience:32400,currency:680},{username:"GearGrinder",level:17,experience:28900,currency:590},{username:"ClockTinkerer",level:16,experience:25600,currency:520,guildName:"Brass Inventors"},{username:"SteamSage",level:15,experience:22500,currency:450}];return e&&n.push({username:e.name,level:e.level,experience:e.experience,currency:e.currency,guildName:void 0}),n.sort((e,n)=>{switch(t){case"level":return n.level-e.level||n.experience-e.experience;case"experience":return n.experience-e.experience;case"currency":return n.currency-e.currency;default:return 0}}).map((e,t)=>({...e,userId:`user-${t}`,rank:t+1}))})(t);if(i(n),e){const t=n.find(t=>t.username===e.name);c((null===t||void 0===t?void 0:t.rank)||null)}o(!1)},500)},[t,e]);const u=e=>e.toLocaleString(),d=e=>{switch(e){case 1:return"\ud83e\udd47";case 2:return"\ud83e\udd48";case 3:return"\ud83e\udd49";default:return`#${e}`}},h=(e,t)=>{switch(t){case"level":return`Level ${e.level}`;case"experience":return`${u(e.experience)} XP`;case"currency":return`${u(e.currency)} Coins`;default:return""}};return(0,$i.jsxs)("div",{className:"leaderboard-hub",children:[(0,$i.jsxs)("div",{className:"leaderboard-header",children:[(0,$i.jsx)("h2",{children:"\ud83c\udfc6 Hall of Renowned Inventors"}),(0,$i.jsx)("p",{children:"See how you rank among the greatest engineers in the realm!"})]}),(0,$i.jsxs)("div",{className:"leaderboard-tabs",children:[(0,$i.jsx)("button",{className:"tab-button "+("level"===t?"active":""),onClick:()=>n("level"),children:"\ud83d\udcca Level Rankings"}),(0,$i.jsx)("button",{className:"tab-button "+("experience"===t?"active":""),onClick:()=>n("experience"),children:"\u2b50 Experience Points"}),(0,$i.jsx)("button",{className:"tab-button "+("currency"===t?"active":""),onClick:()=>n("currency"),children:"\ud83d\udcb0 Wealth Rankings"})]}),e&&l&&(0,$i.jsxs)("div",{className:"player-rank-card",children:[(0,$i.jsxs)("div",{className:"rank-info",children:[(0,$i.jsx)("span",{className:"rank-position",children:d(l)}),(0,$i.jsxs)("div",{className:"rank-details",children:[(0,$i.jsx)("strong",{children:e.name}),(0,$i.jsx)("span",{className:"rank-stat",children:h({userId:e.userId,username:e.name,level:e.level,experience:e.experience,currency:e.currency,rank:l},t)})]})]}),(0,$i.jsx)("div",{className:"rank-badge",children:"Your Rank"})]}),(0,$i.jsx)("div",{className:"leaderboard-content",children:s?(0,$i.jsxs)("div",{className:"loading-state",children:[(0,$i.jsx)("div",{className:"loading-spinner",children:"\u2699\ufe0f"}),(0,$i.jsx)("p",{children:"Loading rankings..."})]}):(0,$i.jsx)("div",{className:"leaderboard-list",children:a.map(n=>(0,$i.jsxs)("div",{className:"leaderboard-entry "+(e&&n.username===e.name?"player-entry":""),children:[(0,$i.jsx)("div",{className:"entry-rank",children:d(n.rank)}),(0,$i.jsxs)("div",{className:"entry-info",children:[(0,$i.jsxs)("div",{className:"entry-name",children:[(0,$i.jsx)("strong",{children:n.username}),n.guildName&&(0,$i.jsxs)("span",{className:"guild-tag",children:["[",n.guildName,"]"]})]}),(0,$i.jsxs)("div",{className:"entry-stats",children:[(0,$i.jsx)("span",{className:"primary-stat",children:h(n,t)}),(0,$i.jsxs)("span",{className:"secondary-stats",children:["Level ",n.level," \u2022 ",u(n.experience)," XP \u2022 ",u(n.currency)," Coins"]})]})]}),(0,$i.jsx)("div",{className:"entry-actions",children:e&&n.username!==e.name&&(0,$i.jsx)("button",{className:"view-profile-btn",children:"\ud83d\udc64 View Profile"})})]},n.userId))})}),(0,$i.jsx)("div",{className:"leaderboard-footer",children:(0,$i.jsx)("p",{children:(0,$i.jsx)("em",{children:"Rankings update every hour. Compete with fellow inventors to claim the top spots!"})})})]})},sl=()=>{const{character:e}=is(e=>e.game),[t,n]=(0,r.useState)("attributes"),[a,i]=(0,r.useState)("all"),s=(0,r.useMemo)(()=>[{id:"1",name:"Clockwork Gear",quantity:15,type:"material",rarity:"common",description:"Essential component for mechanical devices"},{id:"2",name:"Steam Crystal",quantity:3,type:"material",rarity:"rare",description:"Crystallized steam energy, highly valuable"},{id:"3",name:"Copper Ore",quantity:28,type:"material",rarity:"common",description:"Raw copper extracted from mines"},{id:"4",name:"Iron Ingot",quantity:12,type:"material",rarity:"uncommon",description:"Refined iron ready for crafting"},{id:"5",name:"Brass Wrench",quantity:1,type:"tool",rarity:"uncommon",description:"Precision tool for mechanical work",stats:{dexterity:2,intelligence:1}},{id:"6",name:"Steam Engine Blueprint",quantity:1,type:"material",rarity:"rare",description:"Detailed plans for constructing steam engines"},{id:"7",name:"Healing Potion",quantity:5,type:"consumable",rarity:"common",description:"Restores health when consumed"},{id:"8",name:"Pocket Watch",quantity:1,type:"trinket",rarity:"epic",description:"Masterwork timepiece with mystical properties",stats:{intelligence:5,vitality:3}},{id:"9",name:"Steam-Powered Gauntlets",quantity:1,type:"armor",rarity:"legendary",description:"Legendary gauntlets powered by compressed steam",stats:{strength:8,dexterity:4}},{id:"10",name:"Cogwheel Blade",quantity:1,type:"weapon",rarity:"epic",description:"A sword with rotating cogwheel edges",stats:{strength:6,dexterity:2}},{id:"11",name:"Aether Essence",quantity:2,type:"material",rarity:"legendary",description:"Pure essence of the ethereal plane"},{id:"12",name:"Mechanical Spider",quantity:1,type:"trinket",rarity:"rare",description:"A clockwork companion that assists in crafting",stats:{intelligence:3,dexterity:2}}],[]),o=(0,r.useMemo)(()=>{if("all"===a)return s;const e={all:[],materials:["material"],tools:["tool"],equipment:["weapon","armor","trinket"],consumables:["consumable"]}[a];return s.filter(t=>e.includes(t.type))},[s,a]);if(!e)return(0,$i.jsx)("div",{className:"character-panel",children:(0,$i.jsxs)("div",{className:"loading-state",children:[(0,$i.jsx)("div",{className:"loading-spinner","data-testid":"loading-spinner",children:"\u2699\ufe0f"}),(0,$i.jsx)("p",{children:"Loading character data..."})]})});const l=100*Math.pow(e.level,2),c=100*Math.pow(e.level-1,2),u=(e.experience-c)/(l-c)*100,d={tank:"Steam-Powered Guardian",healer:"Clockwork Medic",dps:"Gear-Strike Specialist"},h=e=>({common:"#9ca3af",uncommon:"#10b981",rare:"#3b82f6",epic:"#8b5cf6",legendary:"#f59e0b"}[e]),p=e=>({tank:"\ud83d\udee1\ufe0f",healer:"\u2695\ufe0f",dps:"\u2694\ufe0f"}[e]);return(0,$i.jsxs)("div",{className:"character-panel",children:[(0,$i.jsxs)("div",{className:"character-tabs",children:[(0,$i.jsx)("button",{className:"tab-button "+("attributes"===t?"active":""),onClick:()=>n("attributes"),children:"\ud83d\udcca Attributes"}),(0,$i.jsx)("button",{className:"tab-button "+("inventory"===t?"active":""),onClick:()=>n("inventory"),children:"\ud83c\udf92 Inventory"}),(0,$i.jsx)("button",{className:"tab-button "+("skills"===t?"active":""),onClick:()=>n("skills"),children:"\u26a1 Skills"}),(0,$i.jsx)("button",{className:"tab-button "+("specialization"===t?"active":""),onClick:()=>n("specialization"),children:"\ud83c\udfaf Specialization"})]}),(0,$i.jsxs)("div",{className:"character-content",children:["attributes"===t&&(()=>{var t;return(0,$i.jsxs)("div",{className:"attributes-tab",children:[(0,$i.jsxs)("div",{className:"character-overview",children:[(0,$i.jsxs)("div",{className:"character-avatar",children:[(0,$i.jsx)("div",{className:"avatar-placeholder",children:"\ud83d\udc64"}),(0,$i.jsx)("div",{className:"character-name",children:e.name})]}),(0,$i.jsxs)("div",{className:"character-basic-info",children:[(0,$i.jsxs)("div",{className:"info-item",children:[(0,$i.jsx)("span",{className:"label",children:"Level:"}),(0,$i.jsx)("span",{className:"value",children:e.level})]}),(0,$i.jsxs)("div",{className:"info-item",children:[(0,$i.jsx)("span",{className:"label",children:"Currency:"}),(0,$i.jsxs)("span",{className:"value",children:[e.currency.toLocaleString()," Steam Coins"]})]}),(0,$i.jsxs)("div",{className:"info-item",children:[(0,$i.jsx)("span",{className:"label",children:"Current Activity:"}),(0,$i.jsx)("span",{className:"value",children:(null===(t=e.currentActivity)||void 0===t?void 0:t.type)||"None"})]})]})]}),(0,$i.jsxs)("div",{className:"experience-section",children:[(0,$i.jsxs)("div",{className:"exp-header",children:[(0,$i.jsxs)("span",{children:["Experience: ",e.experience.toLocaleString()]}),(0,$i.jsxs)("span",{children:["Next Level: ",l.toLocaleString()]})]}),(0,$i.jsx)("div",{className:"exp-bar",children:(0,$i.jsx)("div",{className:"exp-fill",style:{width:`${Math.min(u,100)}%`}})}),(0,$i.jsxs)("div",{className:"exp-percentage",children:[Math.floor(u),"%"]})]}),(0,$i.jsxs)("div",{className:"attributes-grid",children:[(0,$i.jsxs)("div",{className:"attribute-card",children:[(0,$i.jsx)("div",{className:"attribute-icon",children:"\ud83d\udcaa"}),(0,$i.jsxs)("div",{className:"attribute-info",children:[(0,$i.jsx)("div",{className:"attribute-name",children:"Strength"}),(0,$i.jsx)("div",{className:"attribute-value",children:e.stats.strength})]})]}),(0,$i.jsxs)("div",{className:"attribute-card",children:[(0,$i.jsx)("div",{className:"attribute-icon",children:"\ud83c\udfaf"}),(0,$i.jsxs)("div",{className:"attribute-info",children:[(0,$i.jsx)("div",{className:"attribute-name",children:"Dexterity"}),(0,$i.jsx)("div",{className:"attribute-value",children:e.stats.dexterity})]})]}),(0,$i.jsxs)("div",{className:"attribute-card",children:[(0,$i.jsx)("div",{className:"attribute-icon",children:"\ud83e\udde0"}),(0,$i.jsxs)("div",{className:"attribute-info",children:[(0,$i.jsx)("div",{className:"attribute-name",children:"Intelligence"}),(0,$i.jsx)("div",{className:"attribute-value",children:e.stats.intelligence})]})]}),(0,$i.jsxs)("div",{className:"attribute-card",children:[(0,$i.jsx)("div",{className:"attribute-icon",children:"\u2764\ufe0f"}),(0,$i.jsxs)("div",{className:"attribute-info",children:[(0,$i.jsx)("div",{className:"attribute-name",children:"Vitality"}),(0,$i.jsx)("div",{className:"attribute-value",children:e.stats.vitality})]})]})]})]})})(),"inventory"===t&&(0,$i.jsxs)("div",{className:"inventory-tab",children:[(0,$i.jsxs)("div",{className:"inventory-header",children:[(0,$i.jsxs)("div",{className:"inventory-title",children:[(0,$i.jsxs)("h4",{children:["Inventory (",o.length,"/",s.length,")"]}),(0,$i.jsxs)("div",{className:"inventory-capacity",children:[(0,$i.jsxs)("span",{className:"capacity-text",children:["Capacity: ",s.length,"/50"]}),(0,$i.jsx)("div",{className:"capacity-bar",children:(0,$i.jsx)("div",{className:"capacity-fill",style:{width:s.length/50*100+"%"}})})]})]}),(0,$i.jsxs)("div",{className:"inventory-filters",children:[(0,$i.jsx)("button",{className:"filter-btn "+("all"===a?"active":""),onClick:()=>i("all"),children:"All"}),(0,$i.jsx)("button",{className:"filter-btn "+("materials"===a?"active":""),onClick:()=>i("materials"),children:"Materials"}),(0,$i.jsx)("button",{className:"filter-btn "+("tools"===a?"active":""),onClick:()=>i("tools"),children:"Tools"}),(0,$i.jsx)("button",{className:"filter-btn "+("equipment"===a?"active":""),onClick:()=>i("equipment"),children:"Equipment"}),(0,$i.jsx)("button",{className:"filter-btn "+("consumables"===a?"active":""),onClick:()=>i("consumables"),children:"Consumables"})]})]}),(0,$i.jsx)("div",{className:"inventory-grid",children:o.map(e=>{return(0,$i.jsxs)("div",{className:`inventory-item rarity-${e.rarity}`,title:e.description,children:[(0,$i.jsxs)("div",{className:"item-header",children:[(0,$i.jsx)("div",{className:"item-icon",style:{color:h(e.rarity),textShadow:(n=e.rarity,{common:"none",uncommon:"0 0 5px #10b981",rare:"0 0 8px #3b82f6",epic:"0 0 12px #8b5cf6",legendary:"0 0 15px #f59e0b"}[n])},children:(t=e.type,{material:"\ud83d\udd29",tool:"\ud83d\udd27",consumable:"\ud83e\uddea",weapon:"\u2694\ufe0f",armor:"\ud83d\udee1\ufe0f",trinket:"\ud83d\udc8e"}[t])}),(0,$i.jsxs)("div",{className:"item-quantity",children:["x",e.quantity]})]}),(0,$i.jsxs)("div",{className:"item-info",children:[(0,$i.jsx)("div",{className:"item-name",style:{color:h(e.rarity)},children:e.name}),(0,$i.jsx)("div",{className:"item-type",children:e.type}),e.stats&&(0,$i.jsx)("div",{className:"item-stats",children:Object.entries(e.stats).map(e=>{let[t,n]=e;return(0,$i.jsxs)("span",{className:"stat-bonus",children:["+",n," ",t.charAt(0).toUpperCase()+t.slice(1)]},t)})})]})]},e.id);var t,n})}),0===o.length&&(0,$i.jsxs)("div",{className:"empty-inventory",children:[(0,$i.jsx)("div",{className:"empty-icon",children:"\ud83d\udce6"}),(0,$i.jsx)("p",{children:"No items found in this category"})]})]}),"skills"===t&&(0,$i.jsxs)("div",{className:"skills-tab",children:[(0,$i.jsxs)("div",{className:"skill-category",children:[(0,$i.jsxs)("h4",{children:["\ud83d\udd27 Crafting Skills (Level ",e.stats.craftingSkills.level,")"]}),(0,$i.jsxs)("div",{className:"skills-grid",children:[(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Clockmaking"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.craftingSkills.clockmaking})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Engineering"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.craftingSkills.engineering})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Alchemy"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.craftingSkills.alchemy})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Steamcraft"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.craftingSkills.steamcraft})]})]})]}),(0,$i.jsxs)("div",{className:"skill-category",children:[(0,$i.jsxs)("h4",{children:["\u26cf\ufe0f Harvesting Skills (Level ",e.stats.harvestingSkills.level,")"]}),(0,$i.jsxs)("div",{className:"skills-grid",children:[(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Mining"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.harvestingSkills.mining})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Foraging"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.harvestingSkills.foraging})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Salvaging"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.harvestingSkills.salvaging})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Crystal Extraction"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.harvestingSkills.crystal_extraction})]})]})]}),(0,$i.jsxs)("div",{className:"skill-category",children:[(0,$i.jsxs)("h4",{children:["\u2694\ufe0f Combat Skills (Level ",e.stats.combatSkills.level,")"]}),(0,$i.jsxs)("div",{className:"skills-grid",children:[(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Melee"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.combatSkills.melee})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Ranged"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.combatSkills.ranged})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Defense"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.combatSkills.defense})]}),(0,$i.jsxs)("div",{className:"skill-item",children:[(0,$i.jsx)("span",{className:"skill-name",children:"Tactics"}),(0,$i.jsx)("span",{className:"skill-value",children:e.stats.combatSkills.tactics})]})]})]})]}),"specialization"===t&&(0,$i.jsxs)("div",{className:"specialization-tab",children:[(0,$i.jsxs)("div",{className:"specialization-overview",children:[(0,$i.jsx)("h4",{children:"\u2699\ufe0f Steampunk Specialization"}),(0,$i.jsx)("p",{children:"Your character's mechanical mastery and role progression"})]}),(0,$i.jsxs)("div",{className:"specialization-progress",children:[(0,$i.jsxs)("div",{className:"spec-role tank-role",children:[(0,$i.jsxs)("div",{className:"role-header",children:[(0,$i.jsxs)("div",{className:"role-icon-container",children:[(0,$i.jsx)("span",{className:"role-icon",children:p("tank")}),(0,$i.jsx)("div",{className:"steam-effect"})]}),(0,$i.jsxs)("div",{className:"role-info",children:[(0,$i.jsx)("span",{className:"role-name",children:d.tank}),(0,$i.jsx)("span",{className:"role-subtitle",children:"Defensive Specialist"})]}),(0,$i.jsxs)("span",{className:"role-progress",children:[e.specialization.tankProgress,"%"]})]}),(0,$i.jsxs)("div",{className:"progress-bar",children:[(0,$i.jsx)("div",{className:"progress-fill tank",style:{width:`${e.specialization.tankProgress}%`}}),(0,$i.jsxs)("div",{className:"progress-gears",children:[(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"})]})]}),(0,$i.jsx)("div",{className:"role-description",children:"Master of steam-powered shields and mechanical fortifications"})]}),(0,$i.jsxs)("div",{className:"spec-role healer-role",children:[(0,$i.jsxs)("div",{className:"role-header",children:[(0,$i.jsxs)("div",{className:"role-icon-container",children:[(0,$i.jsx)("span",{className:"role-icon",children:p("healer")}),(0,$i.jsx)("div",{className:"steam-effect"})]}),(0,$i.jsxs)("div",{className:"role-info",children:[(0,$i.jsx)("span",{className:"role-name",children:d.healer}),(0,$i.jsx)("span",{className:"role-subtitle",children:"Support Specialist"})]}),(0,$i.jsxs)("span",{className:"role-progress",children:[e.specialization.healerProgress,"%"]})]}),(0,$i.jsxs)("div",{className:"progress-bar",children:[(0,$i.jsx)("div",{className:"progress-fill healer",style:{width:`${e.specialization.healerProgress}%`}}),(0,$i.jsxs)("div",{className:"progress-gears",children:[(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"})]})]}),(0,$i.jsx)("div",{className:"role-description",children:"Expert in clockwork medical devices and steam-powered restoration"})]}),(0,$i.jsxs)("div",{className:"spec-role dps-role",children:[(0,$i.jsxs)("div",{className:"role-header",children:[(0,$i.jsxs)("div",{className:"role-icon-container",children:[(0,$i.jsx)("span",{className:"role-icon",children:p("dps")}),(0,$i.jsx)("div",{className:"steam-effect"})]}),(0,$i.jsxs)("div",{className:"role-info",children:[(0,$i.jsx)("span",{className:"role-name",children:d.dps}),(0,$i.jsx)("span",{className:"role-subtitle",children:"Offensive Specialist"})]}),(0,$i.jsxs)("span",{className:"role-progress",children:[e.specialization.dpsProgress,"%"]})]}),(0,$i.jsxs)("div",{className:"progress-bar",children:[(0,$i.jsx)("div",{className:"progress-fill dps",style:{width:`${e.specialization.dpsProgress}%`}}),(0,$i.jsxs)("div",{className:"progress-gears",children:[(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{className:"gear",children:"\u2699\ufe0f"})]})]}),(0,$i.jsx)("div",{className:"role-description",children:"Wielder of precision clockwork weapons and steam-powered artillery"})]})]}),(0,$i.jsxs)("div",{className:"current-roles",children:[(0,$i.jsxs)("div",{className:"role-assignment primary",children:[(0,$i.jsx)("span",{className:"label",children:"\ud83c\udfaf Primary Specialization:"}),(0,$i.jsx)("span",{className:"value",children:e.specialization.primaryRole?d[e.specialization.primaryRole]:"Developing..."})]}),(0,$i.jsxs)("div",{className:"role-assignment secondary",children:[(0,$i.jsx)("span",{className:"label",children:"\u26a1 Secondary Focus:"}),(0,$i.jsx)("span",{className:"value",children:e.specialization.secondaryRole?d[e.specialization.secondaryRole]:"None"})]})]}),(0,$i.jsxs)("div",{className:"specialization-bonuses",children:[(0,$i.jsx)("h5",{children:"\ud83d\udd27 Active Bonuses"}),(0,$i.jsxs)("div",{className:"bonus-grid",children:[e.specialization.primaryRole&&(0,$i.jsxs)("div",{className:"bonus-item",children:[(0,$i.jsx)("span",{className:"bonus-icon",children:"\u2699\ufe0f"}),(0,$i.jsxs)("span",{className:"bonus-text",children:["tank"===e.specialization.primaryRole&&"+15% Defense from Steam Armor","healer"===e.specialization.primaryRole&&"+20% Healing from Clockwork Precision","dps"===e.specialization.primaryRole&&"+10% Damage from Gear Optimization"]})]}),(0,$i.jsxs)("div",{className:"bonus-item",children:[(0,$i.jsx)("span",{className:"bonus-icon",children:"\ud83d\udd29"}),(0,$i.jsx)("span",{className:"bonus-text",children:"+5% Crafting Speed from Mechanical Expertise"})]}),(0,$i.jsxs)("div",{className:"bonus-item",children:[(0,$i.jsx)("span",{className:"bonus-icon",children:"\ud83d\udca8"}),(0,$i.jsx)("span",{className:"bonus-text",children:"Steam-Powered Efficiency: +3% All Activities"})]})]})]})]})]})]})};var ol=n(360);const ll=[{id:"read_jules_verne",name:"Reading Jules Verne Novels",description:"Immerse yourself in the adventures of Captain Nemo and Phileas Fogg. Chance to discover rare book pages and literary treasures.",category:ol.HarvestingCategory.LITERARY,icon:"\ud83d\udcda",baseTime:300,energyCost:10,requiredLevel:1,statBonuses:{intelligence:2,experience:15},dropTable:{guaranteed:[{itemId:"book_page",minQuantity:1,maxQuantity:3,dropRate:1}],common:[{itemId:"ink_vial",minQuantity:1,maxQuantity:2,dropRate:.4},{itemId:"parchment",minQuantity:1,maxQuantity:1,dropRate:.3}],uncommon:[{itemId:"vintage_bookmark",minQuantity:1,maxQuantity:1,dropRate:.15},{itemId:"nautilus_sketch",minQuantity:1,maxQuantity:1,dropRate:.1}],rare:[{itemId:"complete_novel",minQuantity:1,maxQuantity:1,dropRate:.05},{itemId:"authors_notes",minQuantity:1,maxQuantity:1,dropRate:.03}],legendary:[{itemId:"original_manuscript",minQuantity:1,maxQuantity:1,dropRate:.01}]}},{id:"study_technical_manuals",name:"Studying Technical Manuals",description:"Pore over intricate engineering diagrams and mechanical blueprints. Gain knowledge and discover technical components.",category:ol.HarvestingCategory.LITERARY,icon:"\ud83d\udcd6",baseTime:240,energyCost:12,requiredLevel:3,requiredStats:{intelligence:15},statBonuses:{intelligence:3,perception:1,experience:20},dropTable:{guaranteed:[{itemId:"technical_diagram",minQuantity:1,maxQuantity:2,dropRate:1}],common:[{itemId:"blueprint_fragment",minQuantity:1,maxQuantity:3,dropRate:.5},{itemId:"calculation_notes",minQuantity:1,maxQuantity:2,dropRate:.3}],uncommon:[{itemId:"engineering_formula",minQuantity:1,maxQuantity:1,dropRate:.2},{itemId:"patent_document",minQuantity:1,maxQuantity:1,dropRate:.12}],rare:[{itemId:"complete_blueprint",minQuantity:1,maxQuantity:1,dropRate:.06},{itemId:"inventors_journal",minQuantity:1,maxQuantity:1,dropRate:.04}],legendary:[{itemId:"master_schematic",minQuantity:1,maxQuantity:1,dropRate:.015}]}},{id:"tinker_clockwork",name:"Tinkering with Clockwork",description:"Disassemble and examine intricate clockwork mechanisms. Salvage gears, springs, and precision components.",category:ol.HarvestingCategory.MECHANICAL,icon:"\u2699\ufe0f",baseTime:180,energyCost:15,requiredLevel:2,statBonuses:{dexterity:2,intelligence:1,experience:18},dropTable:{guaranteed:[{itemId:"brass_gear",minQuantity:2,maxQuantity:4,dropRate:1}],common:[{itemId:"steel_spring",minQuantity:1,maxQuantity:3,dropRate:.6},{itemId:"copper_wire",minQuantity:2,maxQuantity:5,dropRate:.4}],uncommon:[{itemId:"precision_bearing",minQuantity:1,maxQuantity:2,dropRate:.18},{itemId:"clockwork_escapement",minQuantity:1,maxQuantity:1,dropRate:.12}],rare:[{itemId:"chronometer_core",minQuantity:1,maxQuantity:1,dropRate:.05},{itemId:"master_gear",minQuantity:1,maxQuantity:1,dropRate:.03}],legendary:[{itemId:"temporal_mechanism",minQuantity:1,maxQuantity:1,dropRate:.008}]}},{id:"salvage_steam_engines",name:"Salvaging Steam Engines",description:"Carefully dismantle old steam engines to recover valuable boiler parts, pistons, and pressure gauges.",category:ol.HarvestingCategory.MECHANICAL,icon:"\ud83d\ude82",baseTime:420,energyCost:25,requiredLevel:5,requiredStats:{strength:20,dexterity:15},statBonuses:{strength:2,dexterity:2,experience:30},dropTable:{guaranteed:[{itemId:"iron_pipe",minQuantity:3,maxQuantity:6,dropRate:1}],common:[{itemId:"steam_valve",minQuantity:1,maxQuantity:2,dropRate:.5},{itemId:"pressure_gauge",minQuantity:1,maxQuantity:1,dropRate:.4},{itemId:"boiler_plate",minQuantity:2,maxQuantity:4,dropRate:.6}],uncommon:[{itemId:"piston_assembly",minQuantity:1,maxQuantity:1,dropRate:.15},{itemId:"steam_regulator",minQuantity:1,maxQuantity:1,dropRate:.12}],rare:[{itemId:"master_cylinder",minQuantity:1,maxQuantity:1,dropRate:.06},{itemId:"precision_boiler",minQuantity:1,maxQuantity:1,dropRate:.04}],legendary:[{itemId:"perpetual_engine_core",minQuantity:1,maxQuantity:1,dropRate:.01}]}},{id:"gather_rare_herbs",name:"Gathering Rare Herbs",description:"Search Victorian gardens and greenhouses for exotic plants with alchemical properties.",category:ol.HarvestingCategory.ALCHEMICAL,icon:"\ud83c\udf3f",baseTime:200,energyCost:12,requiredLevel:2,statBonuses:{perception:2,intelligence:1,experience:16},dropTable:{guaranteed:[{itemId:"common_herb",minQuantity:2,maxQuantity:5,dropRate:1}],common:[{itemId:"medicinal_root",minQuantity:1,maxQuantity:3,dropRate:.4},{itemId:"aromatic_leaf",minQuantity:2,maxQuantity:4,dropRate:.5}],uncommon:[{itemId:"luminous_moss",minQuantity:1,maxQuantity:2,dropRate:.16},{itemId:"ethereal_flower",minQuantity:1,maxQuantity:1,dropRate:.12}],rare:[{itemId:"philosophers_sage",minQuantity:1,maxQuantity:1,dropRate:.05},{itemId:"temporal_vine",minQuantity:1,maxQuantity:1,dropRate:.03}],legendary:[{itemId:"elixir_bloom",minQuantity:1,maxQuantity:1,dropRate:.008}]}},{id:"distill_essences",name:"Distilling Essences",description:"Use elaborate alchemical apparatus to extract pure essences from various materials.",category:ol.HarvestingCategory.ALCHEMICAL,icon:"\u2697\ufe0f",baseTime:360,energyCost:20,requiredLevel:4,requiredStats:{intelligence:25,perception:15},statBonuses:{intelligence:3,perception:2,experience:25},dropTable:{guaranteed:[{itemId:"basic_essence",minQuantity:1,maxQuantity:3,dropRate:1}],common:[{itemId:"purified_water",minQuantity:2,maxQuantity:4,dropRate:.6},{itemId:"alchemical_salt",minQuantity:1,maxQuantity:2,dropRate:.4}],uncommon:[{itemId:"concentrated_essence",minQuantity:1,maxQuantity:1,dropRate:.18},{itemId:"volatile_compound",minQuantity:1,maxQuantity:1,dropRate:.14}],rare:[{itemId:"philosophers_mercury",minQuantity:1,maxQuantity:1,dropRate:.06},{itemId:"quintessence",minQuantity:1,maxQuantity:1,dropRate:.04}],legendary:[{itemId:"universal_solvent",minQuantity:1,maxQuantity:1,dropRate:.012}]}},{id:"excavate_ruins",name:"Excavating Ancient Ruins",description:"Carefully dig through Victorian-era archaeological sites to uncover lost artifacts and treasures.",category:ol.HarvestingCategory.ARCHAEOLOGICAL,icon:"\ud83c\udfdb\ufe0f",baseTime:480,energyCost:30,requiredLevel:6,requiredStats:{strength:25,perception:20},statBonuses:{strength:2,perception:3,experience:35},dropTable:{guaranteed:[{itemId:"pottery_shard",minQuantity:3,maxQuantity:7,dropRate:1}],common:[{itemId:"ancient_coin",minQuantity:1,maxQuantity:4,dropRate:.5},{itemId:"carved_stone",minQuantity:1,maxQuantity:2,dropRate:.3}],uncommon:[{itemId:"ornate_jewelry",minQuantity:1,maxQuantity:1,dropRate:.15},{itemId:"ceremonial_dagger",minQuantity:1,maxQuantity:1,dropRate:.1}],rare:[{itemId:"golden_idol",minQuantity:1,maxQuantity:1,dropRate:.05},{itemId:"ancient_tome",minQuantity:1,maxQuantity:1,dropRate:.03}],legendary:[{itemId:"atlantean_artifact",minQuantity:1,maxQuantity:1,dropRate:.008}]}},{id:"harvest_lightning",name:"Harvesting Lightning",description:"Use Tesla coils and lightning rods to capture and store electrical energy during storms.",category:ol.HarvestingCategory.ELECTRICAL,icon:"\u26a1",baseTime:600,energyCost:35,requiredLevel:8,requiredStats:{intelligence:35,dexterity:25},statBonuses:{intelligence:4,dexterity:2,experience:40},dropTable:{guaranteed:[{itemId:"electrical_charge",minQuantity:5,maxQuantity:10,dropRate:1}],common:[{itemId:"copper_conductor",minQuantity:2,maxQuantity:4,dropRate:.6},{itemId:"insulation_material",minQuantity:1,maxQuantity:3,dropRate:.4}],uncommon:[{itemId:"tesla_coil_fragment",minQuantity:1,maxQuantity:1,dropRate:.16},{itemId:"static_crystal",minQuantity:1,maxQuantity:2,dropRate:.12}],rare:[{itemId:"lightning_essence",minQuantity:1,maxQuantity:1,dropRate:.06},{itemId:"storm_core",minQuantity:1,maxQuantity:1,dropRate:.04}],legendary:[{itemId:"zeus_fragment",minQuantity:1,maxQuantity:1,dropRate:.01}]}},{id:"balloon_expedition",name:"Hot Air Balloon Expeditions",description:"Embark on aerial adventures to collect rare atmospheric specimens and sky-bound treasures.",category:ol.HarvestingCategory.AERONAUTICAL,icon:"\ud83c\udf88",baseTime:720,energyCost:40,requiredLevel:10,requiredStats:{perception:30,dexterity:25},statBonuses:{perception:4,dexterity:2,experience:50},dropTable:{guaranteed:[{itemId:"cloud_essence",minQuantity:2,maxQuantity:5,dropRate:1}],common:[{itemId:"wind_crystal",minQuantity:1,maxQuantity:3,dropRate:.5},{itemId:"atmospheric_sample",minQuantity:2,maxQuantity:4,dropRate:.4}],uncommon:[{itemId:"sky_silk",minQuantity:1,maxQuantity:2,dropRate:.18},{itemId:"floating_stone",minQuantity:1,maxQuantity:1,dropRate:.14}],rare:[{itemId:"celestial_compass",minQuantity:1,maxQuantity:1,dropRate:.06},{itemId:"star_fragment",minQuantity:1,maxQuantity:1,dropRate:.04}],legendary:[{itemId:"phoenix_feather",minQuantity:1,maxQuantity:1,dropRate:.01}]}},{id:"mine_rare_metals",name:"Mining Rare Metals",description:"Delve deep into Victorian-era mines to extract precious metals and unusual alloys.",category:ol.HarvestingCategory.METALLURGICAL,icon:"\u26cf\ufe0f",baseTime:300,energyCost:25,requiredLevel:3,requiredStats:{strength:20},statBonuses:{strength:3,experience:22},dropTable:{guaranteed:[{itemId:"iron_ore",minQuantity:3,maxQuantity:6,dropRate:1}],common:[{itemId:"copper_ore",minQuantity:2,maxQuantity:4,dropRate:.6},{itemId:"coal_chunk",minQuantity:2,maxQuantity:5,dropRate:.7}],uncommon:[{itemId:"silver_nugget",minQuantity:1,maxQuantity:2,dropRate:.15},{itemId:"brass_alloy",minQuantity:1,maxQuantity:1,dropRate:.12}],rare:[{itemId:"gold_vein",minQuantity:1,maxQuantity:1,dropRate:.05},{itemId:"platinum_ore",minQuantity:1,maxQuantity:1,dropRate:.03}],legendary:[{itemId:"adamantine_crystal",minQuantity:1,maxQuantity:1,dropRate:.008}]}}],cl=[{id:"book_page",name:"Book Page",description:"A yellowed page from a classic novel, filled with adventure and wonder.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udcc4",value:5,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"ink_vial",name:"Ink Vial",description:"A small vial of rich, dark ink used by Victorian writers.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udd8b\ufe0f",value:8,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"parchment",name:"Quality Parchment",description:"Fine parchment suitable for important documents and contracts.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udcdc",value:12,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"vintage_bookmark",name:"Vintage Bookmark",description:"An ornate bookmark made of silver and leather, marking important passages.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\ud83d\udd16",value:35,stackable:!0,maxStack:25,craftingMaterial:!0,sellable:!0},{id:"nautilus_sketch",name:"Nautilus Sketch",description:"A detailed sketch of Captain Nemo's submarine, complete with technical annotations.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\ud83d\udea2",value:50,stackable:!0,maxStack:10,craftingMaterial:!0,sellable:!0},{id:"complete_novel",name:"Complete Novel",description:"A pristine copy of a Jules Verne adventure, bound in leather.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.RARE,icon:"\ud83d\udcda",value:150,stackable:!0,maxStack:5,craftingMaterial:!0,sellable:!0},{id:"authors_notes",name:"Author's Notes",description:"Personal notes and ideas from a famous Victorian author.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.RARE,icon:"\ud83d\udcdd",value:200,stackable:!0,maxStack:5,craftingMaterial:!0,sellable:!0},{id:"original_manuscript",name:"Original Manuscript",description:"An original handwritten manuscript by a legendary author. Priceless!",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83d\udccb",value:1e3,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"technical_diagram",name:"Technical Diagram",description:"A detailed engineering diagram showing mechanical principles.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udcd0",value:10,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"blueprint_fragment",name:"Blueprint Fragment",description:"A torn piece of a larger blueprint, showing partial mechanical designs.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\uddde\ufe0f",value:7,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"complete_blueprint",name:"Complete Blueprint",description:"A full set of blueprints for a complex mechanical device.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.RARE,icon:"\ud83d\udccb",value:180,stackable:!0,maxStack:5,craftingMaterial:!0,sellable:!0},{id:"master_schematic",name:"Master Schematic",description:"The ultimate blueprint containing secrets of advanced engineering.",category:ol.ResourceCategory.LITERARY_MATERIALS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83d\uddc2\ufe0f",value:1200,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"brass_gear",name:"Brass Gear",description:"A precisely crafted brass gear, essential for clockwork mechanisms.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.COMMON,icon:"\u2699\ufe0f",value:15,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"steel_spring",name:"Steel Spring",description:"A coiled steel spring that stores mechanical energy.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83c\udf00",value:12,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"copper_wire",name:"Copper Wire",description:"Flexible copper wire used in electrical and mechanical applications.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udd17",value:8,stackable:!0,maxStack:200,craftingMaterial:!0,sellable:!0},{id:"precision_bearing",name:"Precision Bearing",description:"A perfectly smooth bearing that reduces friction in moving parts.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\u2b55",value:45,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"clockwork_escapement",name:"Clockwork Escapement",description:"The heart of any timepiece, regulating the release of energy.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\ud83d\udd70\ufe0f",value:60,stackable:!0,maxStack:25,craftingMaterial:!0,sellable:!0},{id:"chronometer_core",name:"Chronometer Core",description:"The precise timing mechanism from a master chronometer.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.RARE,icon:"\u23f0",value:200,stackable:!0,maxStack:10,craftingMaterial:!0,sellable:!0},{id:"temporal_mechanism",name:"Temporal Mechanism",description:"A mysterious device that seems to bend the flow of time itself.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\u23f3",value:1500,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"iron_pipe",name:"Iron Pipe",description:"Sturdy iron piping used in steam systems and plumbing.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udd27",value:10,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"steam_valve",name:"Steam Valve",description:"A valve that controls the flow of pressurized steam.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udeb0",value:25,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"pressure_gauge",name:"Pressure Gauge",description:"An instrument that measures steam pressure in boilers.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udcca",value:30,stackable:!0,maxStack:25,craftingMaterial:!0,sellable:!0},{id:"boiler_plate",name:"Boiler Plate",description:"Thick steel plating used to construct steam boilers.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udee1\ufe0f",value:18,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"perpetual_engine_core",name:"Perpetual Engine Core",description:"A legendary engine component that generates endless energy.",category:ol.ResourceCategory.MECHANICAL_PARTS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83d\udd25",value:2e3,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"common_herb",name:"Common Herb",description:"A basic medicinal herb found in most gardens.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83c\udf3f",value:3,stackable:!0,maxStack:200,craftingMaterial:!0,sellable:!0},{id:"medicinal_root",name:"Medicinal Root",description:"A healing root with potent restorative properties.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83e\udd55",value:8,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"luminous_moss",name:"Luminous Moss",description:"A glowing moss that emits a soft, ethereal light.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\u2728",value:40,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"philosophers_sage",name:"Philosopher's Sage",description:"A rare herb said to grant wisdom and extend life.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.RARE,icon:"\ud83e\uddd9",value:180,stackable:!0,maxStack:10,craftingMaterial:!0,sellable:!0},{id:"elixir_bloom",name:"Elixir Bloom",description:"A legendary flower that blooms once a century, key to immortality.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83c\udf3a",value:2500,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"basic_essence",name:"Basic Essence",description:"A simple alchemical essence extracted from common materials.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83e\uddea",value:15,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"concentrated_essence",name:"Concentrated Essence",description:"A potent essence created through careful distillation.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\u2697\ufe0f",value:55,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"quintessence",name:"Quintessence",description:"The fifth element, the pure essence of all matter.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.RARE,icon:"\ud83d\udcab",value:300,stackable:!0,maxStack:5,craftingMaterial:!0,sellable:!0},{id:"universal_solvent",name:"Universal Solvent",description:"A legendary substance that can dissolve anything.",category:ol.ResourceCategory.ALCHEMICAL_REAGENTS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83c\udf0a",value:1800,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"pottery_shard",name:"Pottery Shard",description:"A fragment of ancient pottery with mysterious markings.",category:ol.ResourceCategory.ARCHAEOLOGICAL_ARTIFACTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83c\udffa",value:6,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"ancient_coin",name:"Ancient Coin",description:"A tarnished coin from a long-lost civilization.",category:ol.ResourceCategory.ARCHAEOLOGICAL_ARTIFACTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83e\ude99",value:20,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"ornate_jewelry",name:"Ornate Jewelry",description:"Elaborate jewelry crafted by ancient artisans.",category:ol.ResourceCategory.ARCHAEOLOGICAL_ARTIFACTS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\ud83d\udc8d",value:80,stackable:!0,maxStack:25,craftingMaterial:!0,sellable:!0},{id:"golden_idol",name:"Golden Idol",description:"A small golden statue depicting an unknown deity.",category:ol.ResourceCategory.ARCHAEOLOGICAL_ARTIFACTS,rarity:ol.ResourceRarity.RARE,icon:"\ud83d\uddff",value:400,stackable:!0,maxStack:5,craftingMaterial:!0,sellable:!0},{id:"atlantean_artifact",name:"Atlantean Artifact",description:"A mysterious device from the lost city of Atlantis.",category:ol.ResourceCategory.ARCHAEOLOGICAL_ARTIFACTS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83d\udd31",value:3e3,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"electrical_charge",name:"Electrical Charge",description:"Stored electrical energy captured from lightning.",category:ol.ResourceCategory.ELECTRICAL_COMPONENTS,rarity:ol.ResourceRarity.COMMON,icon:"\u26a1",value:12,stackable:!0,maxStack:200,craftingMaterial:!0,sellable:!0},{id:"tesla_coil_fragment",name:"Tesla Coil Fragment",description:"A piece of Nikola Tesla's revolutionary electrical device.",category:ol.ResourceCategory.ELECTRICAL_COMPONENTS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\ud83d\udd0c",value:70,stackable:!0,maxStack:25,craftingMaterial:!0,sellable:!0},{id:"lightning_essence",name:"Lightning Essence",description:"Pure electrical energy condensed into physical form.",category:ol.ResourceCategory.ELECTRICAL_COMPONENTS,rarity:ol.ResourceRarity.RARE,icon:"\u26a1",value:250,stackable:!0,maxStack:10,craftingMaterial:!0,sellable:!0},{id:"zeus_fragment",name:"Zeus Fragment",description:"A shard of divine lightning, crackling with godly power.",category:ol.ResourceCategory.ELECTRICAL_COMPONENTS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83c\udf29\ufe0f",value:2200,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"cloud_essence",name:"Cloud Essence",description:"The ethereal substance of clouds, light as air.",category:ol.ResourceCategory.AERONAUTICAL_PARTS,rarity:ol.ResourceRarity.COMMON,icon:"\u2601\ufe0f",value:18,stackable:!0,maxStack:100,craftingMaterial:!0,sellable:!0},{id:"sky_silk",name:"Sky Silk",description:"Silk spun by creatures that live high in the atmosphere.",category:ol.ResourceCategory.AERONAUTICAL_PARTS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\ud83d\udd78\ufe0f",value:90,stackable:!0,maxStack:25,craftingMaterial:!0,sellable:!0},{id:"star_fragment",name:"Star Fragment",description:"A piece of a fallen star, still warm with celestial energy.",category:ol.ResourceCategory.AERONAUTICAL_PARTS,rarity:ol.ResourceRarity.RARE,icon:"\u2b50",value:350,stackable:!0,maxStack:5,craftingMaterial:!0,sellable:!0},{id:"phoenix_feather",name:"Phoenix Feather",description:"A feather from the legendary phoenix, granting the power of flight.",category:ol.ResourceCategory.AERONAUTICAL_PARTS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83e\udeb6",value:2800,stackable:!1,craftingMaterial:!0,sellable:!0},{id:"iron_ore",name:"Iron Ore",description:"Raw iron ore ready to be smelted into useful metal.",category:ol.ResourceCategory.METAL_INGOTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83e\udea8",value:8,stackable:!0,maxStack:200,craftingMaterial:!0,sellable:!0},{id:"copper_ore",name:"Copper Ore",description:"Reddish copper ore with excellent conductive properties.",category:ol.ResourceCategory.METAL_INGOTS,rarity:ol.ResourceRarity.COMMON,icon:"\ud83d\udfeb",value:12,stackable:!0,maxStack:150,craftingMaterial:!0,sellable:!0},{id:"silver_nugget",name:"Silver Nugget",description:"A pure silver nugget with a brilliant shine.",category:ol.ResourceCategory.METAL_INGOTS,rarity:ol.ResourceRarity.UNCOMMON,icon:"\u26aa",value:60,stackable:!0,maxStack:50,craftingMaterial:!0,sellable:!0},{id:"gold_vein",name:"Gold Vein",description:"A rich vein of pure gold, highly valuable.",category:ol.ResourceCategory.METAL_INGOTS,rarity:ol.ResourceRarity.RARE,icon:"\ud83d\udfe1",value:200,stackable:!0,maxStack:25,craftingMaterial:!0,sellable:!0},{id:"adamantine_crystal",name:"Adamantine Crystal",description:"The hardest substance known, unbreakable and eternal.",category:ol.ResourceCategory.METAL_INGOTS,rarity:ol.ResourceRarity.LEGENDARY,icon:"\ud83d\udc8e",value:3500,stackable:!1,craftingMaterial:!0,sellable:!0}],ul=[{id:"legendary_tome",name:"Legendary Tome of Forbidden Knowledge",description:"An ancient book containing secrets that were meant to be forgotten. Its pages whisper with otherworldly wisdom.",icon:"\ud83d\udcdc",rarity:"legendary",category:ol.HarvestingCategory.LITERARY,baseDropRate:.003,value:2500},{id:"ancient_scroll",name:"Ancient Scroll of Power",description:"A mystical scroll inscribed with runes that glow faintly in moonlight.",icon:"\ud83d\uddde\ufe0f",rarity:"epic",category:ol.HarvestingCategory.LITERARY,baseDropRate:.005,value:1200},{id:"forbidden_knowledge",name:"Fragment of Forbidden Knowledge",description:"A piece of knowledge so dangerous it was hidden away from the world.",icon:"\ud83e\udde0",rarity:"rare",category:ol.HarvestingCategory.LITERARY,baseDropRate:.008,value:600},{id:"perpetual_motion_device",name:"Perpetual Motion Device",description:"A miraculous machine that defies the laws of physics, running forever without fuel.",icon:"\u2699\ufe0f",rarity:"legendary",category:ol.HarvestingCategory.MECHANICAL,baseDropRate:.002,value:3e3},{id:"master_clockwork",name:"Master Clockwork Heart",description:"The beating heart of a legendary automaton, still pulsing with mechanical life.",icon:"\ud83d\udc93",rarity:"epic",category:ol.HarvestingCategory.MECHANICAL,baseDropRate:.004,value:1500},{id:"steam_core",name:"Eternal Steam Core",description:"A core that generates infinite steam pressure, the dream of every engineer.",icon:"\ud83d\udd25",rarity:"rare",category:ol.HarvestingCategory.MECHANICAL,baseDropRate:.007,value:800},{id:"philosophers_stone_fragment",name:"Philosopher's Stone Fragment",description:"A small piece of the legendary stone that can transmute base metals into gold.",icon:"\ud83d\udc8e",rarity:"legendary",category:ol.HarvestingCategory.ALCHEMICAL,baseDropRate:.0025,value:3500},{id:"transmutation_catalyst",name:"Transmutation Catalyst",description:"A rare substance that accelerates alchemical transformations beyond normal limits.",icon:"\u2697\ufe0f",rarity:"epic",category:ol.HarvestingCategory.ALCHEMICAL,baseDropRate:.0045,value:1400},{id:"elixir_base",name:"Primordial Elixir Base",description:"The foundation ingredient for creating the most powerful potions.",icon:"\ud83e\uddea",rarity:"rare",category:ol.HarvestingCategory.ALCHEMICAL,baseDropRate:.006,value:700},{id:"lost_civilization_artifact",name:"Lost Civilization Artifact",description:"A mysterious device from a civilization that vanished without a trace.",icon:"\ud83d\uddff",rarity:"legendary",category:ol.HarvestingCategory.ARCHAEOLOGICAL,baseDropRate:.003,value:2800},{id:"ancient_power_source",name:"Ancient Power Source",description:"A crystalline device that still hums with energy after millennia.",icon:"\ud83d\udd0b",rarity:"epic",category:ol.HarvestingCategory.ARCHAEOLOGICAL,baseDropRate:.005,value:1300},{id:"mystical_relic",name:"Mystical Relic",description:"An artifact imbued with ancient magic, its purpose lost to time.",icon:"\ud83d\udd2e",rarity:"rare",category:ol.HarvestingCategory.ARCHAEOLOGICAL,baseDropRate:.007,value:650},{id:"mythical_seed",name:"Mythical World Tree Seed",description:"A seed from the legendary World Tree, said to grow into a tree that touches the heavens.",icon:"\ud83c\udf30",rarity:"legendary",category:ol.HarvestingCategory.BOTANICAL,baseDropRate:.0035,value:2200},{id:"evolutionary_specimen",name:"Evolutionary Specimen",description:"A plant that seems to be evolving in real-time, adapting to its environment.",icon:"\ud83c\udf31",rarity:"epic",category:ol.HarvestingCategory.BOTANICAL,baseDropRate:.006,value:1100},{id:"symbiotic_organism",name:"Symbiotic Organism",description:"A unique organism that forms beneficial partnerships with other life forms.",icon:"\ud83c\udf44",rarity:"rare",category:ol.HarvestingCategory.BOTANICAL,baseDropRate:.008,value:550},{id:"meteoric_metal",name:"Meteoric Metal",description:"Metal from beyond the stars, harder than any earthly material.",icon:"\u2604\ufe0f",rarity:"legendary",category:ol.HarvestingCategory.METALLURGICAL,baseDropRate:.0025,value:3200},{id:"crystalline_alloy",name:"Crystalline Alloy",description:"A metal that has somehow crystallized while maintaining its metallic properties.",icon:"\ud83d\udca0",rarity:"epic",category:ol.HarvestingCategory.METALLURGICAL,baseDropRate:.004,value:1600},{id:"living_metal",name:"Living Metal",description:"A metal that seems to pulse with life, reshaping itself when needed.",icon:"\ud83e\udd16",rarity:"rare",category:ol.HarvestingCategory.METALLURGICAL,baseDropRate:.006,value:900},{id:"tesla_coil_core",name:"Tesla Coil Core",description:"The original core from Nikola Tesla's most powerful invention.",icon:"\u26a1",rarity:"legendary",category:ol.HarvestingCategory.ELECTRICAL,baseDropRate:.002,value:3800},{id:"lightning_crystal",name:"Lightning Crystal",description:"A crystal that has captured and crystallized pure lightning energy.",icon:"\ud83d\udc8e",rarity:"epic",category:ol.HarvestingCategory.ELECTRICAL,baseDropRate:.0035,value:1800},{id:"perpetual_battery",name:"Perpetual Battery",description:"A battery that never runs out of power, defying all known science.",icon:"\ud83d\udd0b",rarity:"rare",category:ol.HarvestingCategory.ELECTRICAL,baseDropRate:.005,value:1e3},{id:"anti_gravity_crystal",name:"Anti-Gravity Crystal",description:"A crystal that defies gravity, floating perpetually in the air.",icon:"\ud83d\udd2e",rarity:"legendary",category:ol.HarvestingCategory.AERONAUTICAL,baseDropRate:.003,value:2900},{id:"weather_control_device",name:"Weather Control Device",description:"An ancient device capable of controlling wind, rain, and storms.",icon:"\ud83c\udf2a\ufe0f",rarity:"epic",category:ol.HarvestingCategory.AERONAUTICAL,baseDropRate:.0045,value:1700},{id:"sky_ship_core",name:"Sky Ship Core",description:"The heart of a legendary flying vessel, still humming with aerial magic.",icon:"\ud83d\ude81",rarity:"rare",category:ol.HarvestingCategory.AERONAUTICAL,baseDropRate:.007,value:750}];function dl(e){return ul.filter(t=>t.category===e)}const hl=[{activityId:"read_jules_verne",itemId:"book_page",baseQuantity:2},{activityId:"study_technical_manuals",itemId:"technical_diagram",baseQuantity:1},{activityId:"tinker_clockwork",itemId:"brass_gear",baseQuantity:3},{activityId:"salvage_steam_engines",itemId:"iron_pipe",baseQuantity:4},{activityId:"gather_rare_herbs",itemId:"common_herb",baseQuantity:3},{activityId:"distill_essences",itemId:"basic_essence",baseQuantity:2},{activityId:"excavate_ruins",itemId:"pottery_shard",baseQuantity:5},{activityId:"harvest_lightning",itemId:"electrical_charge",baseQuantity:7},{activityId:"balloon_expedition",itemId:"cloud_essence",baseQuantity:3},{activityId:"mine_rare_metals",itemId:"iron_ore",baseQuantity:4}];ol.HarvestingCategory.LITERARY,ol.HarvestingCategory.MECHANICAL,ol.HarvestingCategory.ALCHEMICAL,ol.HarvestingCategory.ARCHAEOLOGICAL,ol.HarvestingCategory.BOTANICAL,ol.HarvestingCategory.METALLURGICAL,ol.HarvestingCategory.ELECTRICAL,ol.HarvestingCategory.AERONAUTICAL;const pl=new class{constructor(){this.sessions=new Map,this.playerStats=new Map}getActivities(){return ll}getAvailableActivities(e,t,n){return ll.filter(r=>{if(r.requiredLevel>t)return!1;if(r.requiredStats)for(const[e,t]of Object.entries(r.requiredStats))if((n[e]||0)<t)return!1;if(r.unlockConditions){const a=this.getPlayerStats(e);for(const e of r.unlockConditions)if(!this.checkUnlockCondition(e,t,n,a))return!1}return!0})}getActivitiesByCategory(e){return ll.filter(t=>t.category===e)}startHarvesting(e,t,n){const r=ll.find(e=>e.id===t);if(!r)throw new Error("Activity not found");const a=this.calculateHarvestingTime(r,n),i={activityId:t,startTime:Date.now(),duration:1e3*a,playerId:e,completed:!1};return this.sessions.set(`${e}-${t}-${Date.now()}`,i),this.updatePlayerStats(e,r),i}completeHarvesting(e){const t=this.sessions.get(e);if(!t)throw new Error("Session not found");if(t.completed)throw new Error("Session already completed");if(Date.now()<t.startTime+t.duration)throw new Error("Session not yet complete");const n=ll.find(e=>e.id===t.activityId);if(!n)throw new Error("Activity not found");const r=this.generateRewards(n.dropTable);return t.completed=!0,t.rewards=r,this.updateHarvestingStats(t.playerId,n,r),r}getActiveSessions(e){return Array.from(this.sessions.values()).filter(t=>t.playerId===e&&!t.completed)}getPlayerStats(e){return this.playerStats.has(e)||this.playerStats.set(e,{playerId:e,totalHarvests:0,totalTimeSpent:0,activitiesUnlocked:[],categoryLevels:{[ol.HarvestingCategory.LITERARY]:1,[ol.HarvestingCategory.MECHANICAL]:1,[ol.HarvestingCategory.ALCHEMICAL]:1,[ol.HarvestingCategory.ARCHAEOLOGICAL]:1,[ol.HarvestingCategory.BOTANICAL]:1,[ol.HarvestingCategory.METALLURGICAL]:1,[ol.HarvestingCategory.ELECTRICAL]:1,[ol.HarvestingCategory.AERONAUTICAL]:1},categoryExperience:{[ol.HarvestingCategory.LITERARY]:0,[ol.HarvestingCategory.MECHANICAL]:0,[ol.HarvestingCategory.ALCHEMICAL]:0,[ol.HarvestingCategory.ARCHAEOLOGICAL]:0,[ol.HarvestingCategory.BOTANICAL]:0,[ol.HarvestingCategory.METALLURGICAL]:0,[ol.HarvestingCategory.ELECTRICAL]:0,[ol.HarvestingCategory.AERONAUTICAL]:0},rareFindCount:0,legendaryFindCount:0}),this.playerStats.get(e)}getResource(e){return cl.find(t=>t.id===e)}getResourcesByCategory(e){return cl.filter(t=>t.category===e)}calculateHarvestingTime(e,t){let n=1;if(e.requiredStats)for(const[r,a]of Object.entries(e.requiredStats)){const e=t[r]||0;if(e>a){const t=.01*(e-a);n-=Math.min(t,.5)}}return n=Math.max(n,.3),Math.floor(e.baseTime*n)}generateRewards(e){const t=[];for(const r of e.guaranteed){const e=this.randomBetween(r.minQuantity,r.maxQuantity);t.push({itemId:r.itemId,quantity:e,rarity:ol.ResourceRarity.COMMON,isRare:!1})}const n=[{drops:e.common,rarity:ol.ResourceRarity.COMMON},{drops:e.uncommon,rarity:ol.ResourceRarity.UNCOMMON},{drops:e.rare,rarity:ol.ResourceRarity.RARE},{drops:e.legendary,rarity:ol.ResourceRarity.LEGENDARY}];for(const r of n)for(const e of r.drops)if(Math.random()<e.dropRate){const n=this.randomBetween(e.minQuantity,e.maxQuantity);t.push({itemId:e.itemId,quantity:n,rarity:r.rarity,isRare:r.rarity===ol.ResourceRarity.RARE||r.rarity===ol.ResourceRarity.LEGENDARY})}return t}updatePlayerStats(e,t){const n=this.getPlayerStats(e);n.activitiesUnlocked.includes(t.id)||n.activitiesUnlocked.push(t.id)}updateHarvestingStats(e,t,n){const r=this.getPlayerStats(e);r.totalHarvests++,r.totalTimeSpent+=t.baseTime;const a=t.statBonuses.experience||10;r.categoryExperience[t.category]+=a;const i=r.categoryExperience[t.category],s=r.categoryLevels[t.category];i>=this.getExpRequiredForLevel(s+1)&&r.categoryLevels[t.category]++;for(const o of n)o.rarity===ol.ResourceRarity.RARE?r.rareFindCount++:o.rarity===ol.ResourceRarity.LEGENDARY&&r.legendaryFindCount++}checkUnlockCondition(e,t,n,r){switch(e.type){case"level":return t>=e.requirement;case"stat":return(n[e.requirement]||0)>=e.value;case"activity":return r.activitiesUnlocked.includes(e.requirement);default:return!0}}getExpRequiredForLevel(e){return Math.floor(100*Math.pow(1.5,e-1))}randomBetween(e,t){return Math.floor(Math.random()*(t-e+1))+e}getSessionProgress(e){const t=this.sessions.get(e);if(!t)return 0;const n=Date.now()-t.startTime;return Math.min(n/t.duration,1)}cancelSession(e){this.sessions.delete(e)}getTimeRemaining(e){const t=this.sessions.get(e);if(!t)return 0;const n=Date.now()-t.startTime;return Math.max(t.duration-n,0)}generateEnhancedRewards(e,t){const n=ll.find(t=>t.id===e);if(!n)throw new Error("Activity not found");const r=function(e){return hl.find(t=>t.activityId===e)}(e);if(!r)throw new Error("Primary material not found for activity");const a=this.getPlayerStats(t).categoryLevels[n.category],i=Math.floor(a/10),s=r.baseQuantity+i,o=this.rollForExoticItem(n.category,a),l=(n.statBonuses.experience||10)+(o?5:0);return{primaryMaterial:{itemId:r.itemId,quantity:s},exoticItem:o?{itemId:o.id,quantity:1,rarity:o.rarity}:void 0,skillGained:l}}rollForExoticItem(e,t){const n=dl(e);if(0===n.length)return null;const r=Math.min(.02*t,1);for(const a of n){const e=a.baseDropRate*(1+r);if(Math.random()<e)return a}return null}calculateSkillLevel(e){return Math.floor(Math.sqrt(e/100))}calculateExoticBonus(e){return Math.min(.02*e,1)}getExperienceForNextLevel(e){return Math.floor(100*Math.pow(e+1,2))}completeHarvestingEnhanced(e){const t=this.sessions.get(e);if(!t)throw new Error("Session not found");if(t.completed)throw new Error("Session already completed");if(Date.now()<t.startTime+t.duration)throw new Error("Session not yet complete");const n=this.generateEnhancedRewards(t.activityId,t.playerId);return t.completed=!0,this.updateHarvestingStatsEnhanced(t.playerId,t.activityId,n),n}updateHarvestingStatsEnhanced(e,t,n){const r=this.getPlayerStats(e),a=ll.find(e=>e.id===t);if(!a)return;r.totalHarvests++,r.totalTimeSpent+=a.baseTime,r.categoryExperience[a.category]+=n.skillGained;const i=r.categoryExperience[a.category],s=r.categoryLevels[a.category],o=this.calculateSkillLevel(i);o>s&&(r.categoryLevels[a.category]=o,console.log(`${a.category} skill leveled up to ${o}!`)),n.exoticItem&&("rare"===n.exoticItem.rarity?r.rareFindCount++:"epic"!==n.exoticItem.rarity&&"legendary"!==n.exoticItem.rarity||r.legendaryFindCount++),r.activitiesUnlocked.includes(t)||r.activitiesUnlocked.push(t)}getExoticItemsForCategory(e){return dl(e)}getPlayerExoticRates(e){const t=this.getPlayerStats(e),n={};for(const r of Object.values(ol.HarvestingCategory)){const e=t.categoryLevels[r],a=this.calculateExoticBonus(e),i=dl(r),s=i.length>0?i.reduce((e,t)=>e+t.baseDropRate,0)/i.length:0;n[r]=s*(1+a)}return n}},ml=e=>{let{rewards:t,onClose:n,visible:a}=e;const[i,s]=(0,r.useState)([]),[o,l]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{a&&t.length>0&&(s([]),l(!1),t.forEach((e,t)=>{setTimeout(()=>{s(t=>[...t,e])},200*t)}),setTimeout(()=>{l(!0)},200*t.length+500))},[a,t]),!a)return null;const c=e=>{switch(e){case ol.ResourceRarity.COMMON:return"common";case ol.ResourceRarity.UNCOMMON:return"uncommon";case ol.ResourceRarity.RARE:return"rare";case ol.ResourceRarity.LEGENDARY:return"legendary";default:return"common"}},u=e=>{switch(e){case ol.ResourceRarity.COMMON:return"#ffffff";case ol.ResourceRarity.UNCOMMON:return"#1eff00";case ol.ResourceRarity.RARE:return"#0070dd";case ol.ResourceRarity.LEGENDARY:return"#a335ee";default:return"#ffffff"}},d=()=>t.filter(e=>e.isRare).length;return(0,$i.jsx)("div",{className:"rewards-overlay",children:(0,$i.jsxs)("div",{className:"rewards-modal",children:[(0,$i.jsxs)("div",{className:"rewards-header",children:[(0,$i.jsx)("h2",{children:"\ud83c\udf89 Harvesting Complete!"}),(0,$i.jsx)("p",{children:"You've gathered valuable resources and treasures!"})]}),(0,$i.jsxs)("div",{className:"rewards-content",children:[(0,$i.jsx)("div",{className:"rewards-grid",children:i.map((e,t)=>{const n=pl.getResource(e.itemId);return n?(0,$i.jsxs)("div",{className:`reward-item ${c(e.rarity)} ${e.isRare?"rare-glow":""}`,style:{animationDelay:.2*t+"s",borderColor:u(e.rarity)},children:[(0,$i.jsx)("div",{className:"reward-icon",children:n.icon}),(0,$i.jsxs)("div",{className:"reward-info",children:[(0,$i.jsx)("h4",{style:{color:u(e.rarity)},children:n.name}),(0,$i.jsxs)("div",{className:"reward-quantity",children:["x",e.quantity]}),(0,$i.jsxs)("div",{className:"reward-value",children:["\ud83d\udcb0 ",(n.value*e.quantity).toLocaleString()]})]}),e.isRare&&(0,$i.jsxs)("div",{className:"rare-indicator",children:["\u2728 ",e.rarity.toUpperCase()]})]},`${e.itemId}-${t}`):null})}),o&&(0,$i.jsxs)("div",{className:"rewards-summary",children:[(0,$i.jsxs)("div",{className:"summary-stats",children:[(0,$i.jsxs)("div",{className:"summary-stat",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Total Items:"}),(0,$i.jsx)("span",{className:"stat-value",children:t.length})]}),(0,$i.jsxs)("div",{className:"summary-stat",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Total Value:"}),(0,$i.jsxs)("span",{className:"stat-value",children:["\ud83d\udcb0 ",t.reduce((e,t)=>{const n=pl.getResource(t.itemId);return e+((null===n||void 0===n?void 0:n.value)||0)*t.quantity},0).toLocaleString()]})]}),(0,$i.jsxs)("div",{className:"summary-stat",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Rare Finds:"}),(0,$i.jsx)("span",{className:"stat-value rare-text",children:d()})]})]}),d()>0&&(0,$i.jsxs)("div",{className:"rare-celebration",children:[(0,$i.jsx)("div",{className:"celebration-text",children:"\ud83c\udf1f Exceptional Discovery! \ud83c\udf1f"}),(0,$i.jsx)("p",{children:"You've found rare treasures that will be invaluable for crafting!"})]})]})]}),(0,$i.jsx)("div",{className:"rewards-actions",children:(0,$i.jsx)("button",{className:"collect-btn",onClick:n,children:"Collect All Rewards"})})]})})};var fl=n(280);const gl=new class{constructor(){this.apiUrl=void 0,this.apiUrl="https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod"}getAvailableActivities(){return[{id:"copper_mining",name:"Copper Mining",type:"harvesting",duration:3e4,description:"Extract copper ore from steampunk mines",icon:"\u26cf\ufe0f"},{id:"gear_crafting",name:"Gear Crafting",type:"crafting",duration:45e3,description:"Craft mechanical gears and components",icon:"\u2699\ufe0f"},{id:"steam_research",name:"Steam Research",type:"harvesting",duration:6e4,description:"Research steam-powered technologies",icon:"\ud83d\udd2c"}]}async startActivity(e,t){try{console.log("=== SIMPLE HARVESTING SERVICE DEBUG ==="),console.log("API URL:",this.apiUrl),console.log("Full endpoint:",`${this.apiUrl}/activity/switch`),console.log("Request payload:",{userId:e,activityType:t.type,activityData:{activityId:t.id,name:t.name,duration:t.duration,description:t.description,icon:t.icon}});const n=await fl._P.postJson(`${this.apiUrl}/activity/switch`,{userId:e,activityType:t.type,activityData:{activityId:t.id,name:t.name,duration:t.duration,description:t.description,icon:t.icon}});console.log("\u2705 Activity started successfully:",n)}catch(n){throw console.error("\u274c Failed to start activity:",n),console.error("Error details:",{message:n instanceof Error?n.message:"Unknown error",stack:n instanceof Error?n.stack:void 0,name:n instanceof Error?n.name:void 0}),n}}async getActivityProgress(e){try{const t=await fl._P.fetchJson(`${this.apiUrl}/activity/progress?userId=${e}`);return{progress:t.progress||0,timeRemaining:t.timeRemaining||0,isComplete:t.isComplete||!1,rewards:t.rewards||[]}}catch(t){return console.error("Failed to get activity progress:",t),{progress:0,timeRemaining:0,isComplete:!1,rewards:[]}}}async getCharacter(e){try{return(await fl._P.fetchJson(`${this.apiUrl}/character?userId=${e}`)).character}catch(t){throw console.error("Failed to get character:",t),t}}},yl=e=>{let{userId:t,onClose:n}=e;const[a,i]=(0,r.useState)([]),[s,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)({}),{character:h}=is(e=>e.game);(0,r.useEffect)(()=>{p(),m();const e=setInterval(()=>{t&&f()},1e3);return()=>clearInterval(e)},[t]),(0,r.useEffect)(()=>{h&&o(h)},[h]);const p=()=>{const e=[{id:"copper_mining",name:"Copper Mining",type:"harvesting",duration:3e4,description:"Extract copper ore from steampunk mines using mechanical drills",icon:"\u26cf\ufe0f",baseRewards:[{type:"resource",itemId:"copper_ore",quantity:2},{type:"experience",quantity:10}],requiredLevel:1},{id:"iron_mining",name:"Iron Mining",type:"harvesting",duration:45e3,description:"Mine iron ore using steam-powered equipment",icon:"\u2692\ufe0f",baseRewards:[{type:"resource",itemId:"iron_ore",quantity:2},{type:"experience",quantity:15}],requiredLevel:5},{id:"steam_research",name:"Steam Research",type:"harvesting",duration:6e4,description:"Research steam-powered technologies in the laboratory",icon:"\ud83d\udd2c",baseRewards:[{type:"resource",itemId:"research_notes",quantity:1},{type:"experience",quantity:25}],requiredLevel:3},{id:"gear_collection",name:"Gear Collection",type:"harvesting",duration:35e3,description:"Collect mechanical gears from abandoned machinery",icon:"\u2699\ufe0f",baseRewards:[{type:"resource",itemId:"mechanical_gear",quantity:1},{type:"experience",quantity:12}],requiredLevel:2}];i(e);const t={};e.forEach(e=>{t[e.id]=1}),d(t)},m=async()=>{try{if(!h){const e=await gl.getCharacter(t);o(e)}}catch(e){console.error("Failed to load character:",e)}},f=async()=>{try{const e=await gl.getActivityProgress(t),n={currentTask:e.progress>0?{name:"Current Activity",icon:"\u2699\ufe0f"}:null,queueLength:0,totalCompleted:0,isRunning:e.progress>0&&!e.isComplete};c(n)}catch(e){console.error("Failed to get activity status:",e)}},g=async function(e){try{const r=u[e.id]||1;console.log("=== HARVESTING DEBUG ==="),console.log("Starting activity:",e.name),console.log("Rounds:",r),console.log("User ID:",t),console.log("API URL:","https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod"),console.log("Activity data:",{...e,duration:e.duration*r}),await gl.startActivity(t,{...e,duration:e.duration*r}),console.log(`\u2705 Successfully started ${e.name} activity (${r} rounds)`),n&&n()}catch(r){console.error("Failed to start activity:",r),console.error("Error details:",{message:r instanceof Error?r.message:"Unknown error",stack:r instanceof Error?r.stack:void 0,userId:t,activity:e.name,rounds:u[e.id]||1});const n=r instanceof Error?r.message:"Unknown error occurred";alert(`Failed to start activity: ${n}\n\nCheck the browser console for more details.`)}},y=(e,t)=>{d(n=>({...n,[e]:Math.max(1,t)}))},v=e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60);return n>0?`${n}m ${t%60}s`:`${t}s`};return(0,$i.jsxs)("div",{className:"harvesting-hub",children:[(0,$i.jsxs)("div",{className:"harvesting-header",children:[(0,$i.jsx)("h2",{children:"\ud83d\udd27 Steampunk Activities"}),(0,$i.jsx)("p",{children:"Engage in various Victorian-era activities to gather resources and experience"})]}),s&&(0,$i.jsxs)("div",{className:"character-info",children:[(0,$i.jsxs)("h3",{children:["\ud83d\udc64 ",s.name]}),(0,$i.jsxs)("div",{className:"character-stats",children:[(0,$i.jsxs)("span",{children:["Level: ",s.level]}),(0,$i.jsxs)("span",{children:["Experience: ",s.experience||0]}),(0,$i.jsxs)("span",{children:["Currency: ",s.currency||0," Steam Coins"]})]})]}),l&&(0,$i.jsxs)("div",{className:"queue-status-info",children:[(0,$i.jsx)("h3",{children:"\u2699\ufe0f Activity Status"}),(0,$i.jsxs)("div",{className:"queue-stats",children:[l.currentTask?(0,$i.jsx)("span",{children:"\ud83d\udd04 Currently: Active"}):(0,$i.jsx)("span",{children:"\ud83d\udca4 No active activity"}),(0,$i.jsx)("span",{children:"\u2705 Ready to start new activities"})]}),(0,$i.jsx)("p",{className:"queue-info-text",children:"Activities will run automatically in the background. Check the progress bar at the top of the screen!"})]}),(0,$i.jsxs)("div",{className:"activities-section",children:[(0,$i.jsx)("h3",{children:"Available Activities"}),(0,$i.jsx)("div",{className:"activities-grid",children:a.map(e=>(0,$i.jsxs)("div",{className:"activity-card",children:[(0,$i.jsxs)("div",{className:"activity-header",children:[(0,$i.jsx)("span",{className:"activity-icon",children:e.icon}),(0,$i.jsx)("h4",{children:e.name})]}),(0,$i.jsx)("p",{className:"activity-description",children:e.description}),(0,$i.jsxs)("div",{className:"activity-stats",children:[(0,$i.jsx)("div",{className:"stat-row",children:(0,$i.jsxs)("span",{children:["\u23f1\ufe0f Duration: ",v(e.duration)]})}),(0,$i.jsx)("div",{className:"stat-row",children:(0,$i.jsxs)("span",{children:["\ud83c\udfaf Type: ",e.type]})}),(0,$i.jsx)("div",{className:"stat-row",children:(0,$i.jsxs)("span",{children:["\ud83d\udcca Level: ",e.requiredLevel||1,"+"]})})]}),(0,$i.jsxs)("div",{className:"activity-rewards",children:[(0,$i.jsx)("h5",{children:"Base Rewards:"}),(0,$i.jsx)("div",{className:"rewards-preview",children:e.baseRewards.map((e,t)=>(0,$i.jsxs)("span",{className:"reward-preview",children:[e.quantity,"x ",e.itemId||e.type]},t))})]}),(0,$i.jsxs)("div",{className:"activity-controls",children:[(0,$i.jsxs)("div",{className:"rounds-control",children:[(0,$i.jsx)("label",{children:"Rounds:"}),(0,$i.jsxs)("div",{className:"rounds-input",children:[(0,$i.jsx)("button",{onClick:()=>y(e.id,(u[e.id]||1)-1),disabled:(u[e.id]||1)<=1,children:"-"}),(0,$i.jsx)("input",{type:"number",min:"1",max:"999",value:u[e.id]||1,onChange:t=>y(e.id,parseInt(t.target.value)||1)}),(0,$i.jsx)("button",{onClick:()=>y(e.id,(u[e.id]||1)+1),children:"+"})]})]}),(0,$i.jsxs)("div",{className:"activity-actions",children:[(0,$i.jsx)("button",{className:"start-activity-btn",onClick:()=>g(e,!1),disabled:s&&s.level<(e.requiredLevel||1),children:"\ud83d\ude80 Start Now"}),(0,$i.jsx)("button",{className:"queue-activity-btn",onClick:()=>g(e,!0),disabled:s&&s.level<(e.requiredLevel||1),title:"Note: Queuing not available in simple mode - will start immediately",children:"\ud83d\ude80 Start Activity"})]})]})]},e.id))})]}),(0,$i.jsxs)("div",{className:"instructions",children:[(0,$i.jsx)("h4",{children:"How to Play:"}),(0,$i.jsxs)("ul",{children:[(0,$i.jsx)("li",{children:"\ud83c\udfaf Select an activity and choose how many rounds to perform"}),(0,$i.jsx)("li",{children:'\ud83d\ude80 Click "Start Now" to begin the activity immediately'}),(0,$i.jsx)("li",{children:"\ud83d\udcca Activities run automatically in the background - check the progress bar at the top!"}),(0,$i.jsx)("li",{children:"\ud83d\udc8e Collect rewards and experience when activities complete"}),(0,$i.jsx)("li",{children:"\ud83d\udd04 Start new activities to keep your character busy while you're away"})]}),(0,$i.jsxs)("div",{className:"idle-game-tip",children:[(0,$i.jsx)("strong",{children:"\ud83d\udca1 Idle Game Tip:"})," This is an idle game! Start your activities and let them run while you do other things. The progress bar at the top shows your current activity status. Multiple rounds will run automatically!"]})]})]})};var vl=n(315),xl=n(523),bl=n(146);const El=new class{constructor(){if(this.apiUrl=void 0,this.progressCallbacks=new Map,this.completionCallbacks=new Map,this.syncIntervals=new Map,this.lastKnownState=new Map,this.apiUrl="https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",!this.apiUrl)throw new Error("AWS API URL must be configured via REACT_APP_API_URL or REACT_APP_AWS_API_URL")}async syncWithServer(e){try{console.log("ServerTaskQueueService: Syncing with AWS server for player:",e);const t=await fl._P.postJson(`${this.apiUrl}/task-queue/sync`,{action:"sync",playerId:e},{timeout:8e3,retries:2,exponentialBackoff:!0});console.log("ServerTaskQueueService: AWS server sync response:",t),this.lastKnownState.set(e,t.queue),this.syncIntervals.has(e)||this.startRealTimeSync(e)}catch(t){throw console.error("ServerTaskQueueService: Failed to sync with AWS server:",t),new Error(`Failed to sync with AWS server: ${t.message}`)}}startRealTimeSync(e){const t=setInterval(async()=>{try{await this.fetchServerStatus(e)}catch(t){console.error("ServerTaskQueueService: Real-time sync error:",t)}},5e3);this.syncIntervals.set(e,t)}async fetchServerStatus(e){try{var t,n;const i=await fl._P.fetchJson(`${this.apiUrl}/task-queue/${e}`,{},{timeout:5e3,retries:1,exponentialBackoff:!1}),s=i.queue,o=i.currentProgress,l=this.lastKnownState.get(e);if(!l||(null===(t=l.currentTask)||void 0===t?void 0:t.id)!==(null===(n=s.currentTask)||void 0===n?void 0:n.id)||l.totalCompleted!==s.totalCompleted){var r,a;if(console.log("ServerTaskQueueService: AWS server state changed:",{previousTask:null===l||void 0===l||null===(r=l.currentTask)||void 0===r?void 0:r.id,currentTask:null===(a=s.currentTask)||void 0===a?void 0:a.id,previousCompleted:null===l||void 0===l?void 0:l.totalCompleted,currentCompleted:s.totalCompleted}),l&&s.totalCompleted>l.totalCompleted){const t=s.totalCompleted-l.totalCompleted;console.log(`ServerTaskQueueService: ${t} task(s) completed on AWS server`);const n=this.completionCallbacks.get(e);if(n&&l.currentTask){n({task:{...l.currentTask,completed:!0,rewards:[]},rewards:this.generateMockRewards(l.currentTask),nextTask:s.currentTask})}}this.lastKnownState.set(e,s)}if(o){const t=this.progressCallbacks.get(e);t&&t({taskId:o.taskId,progress:o.progress,timeRemaining:o.timeRemaining,isComplete:o.isComplete})}}catch(i){throw console.error("ServerTaskQueueService: Failed to fetch AWS server status:",i),i}}generateMockRewards(e){const t=[];switch(e.type){case vl.TaskType.HARVESTING:t.push({type:"resource",itemId:"copper_ore",quantity:Math.floor(3*Math.random())+1,rarity:"common",isRare:!1}),t.push({type:"experience",quantity:25});break;case vl.TaskType.COMBAT:t.push({type:"experience",quantity:35}),t.push({type:"currency",quantity:15});break;case vl.TaskType.CRAFTING:t.push({type:"experience",quantity:30})}return t}async addTask(e,t){throw new Error("Generic addTask method is not supported in AWS-only mode. Use addCraftingTask, addCombatTask, or addHarvestingTask instead.")}async addCraftingTask(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=xl.P.createCraftingTask(e,t,n,r,a,i),o=this.validateTaskBeforeSubmission(s,n,r,a);if(!o.isValid)throw new Error(`Task validation failed: ${o.errors.map(e=>e.message).join(", ")}`);try{await fl._P.postJson(`${this.apiUrl}/task-queue/add-task`,{action:"addTask",playerId:e,task:s},{timeout:8e3,retries:2,exponentialBackoff:!0}),console.log("ServerTaskQueueService: Crafting task added to AWS server queue:",s.id),await this.syncWithServer(e)}catch(l){throw console.error("ServerTaskQueueService: Failed to add crafting task to AWS server:",l),new Error(`Failed to add crafting task to AWS server: ${l.message}`)}return s}async addCombatTask(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=xl.P.createCombatTask(e,t,n,r,a,i),o=this.validateTaskBeforeSubmission(s,n,r,{});if(!o.isValid)throw new Error(`Task validation failed: ${o.errors.map(e=>e.message).join(", ")}`);try{await fl._P.postJson(`${this.apiUrl}/task-queue/add-task`,{action:"addTask",playerId:e,task:s},{timeout:8e3,retries:2,exponentialBackoff:!0}),console.log("ServerTaskQueueService: Combat task added to AWS server queue:",s.id),await this.syncWithServer(e)}catch(l){throw console.error("ServerTaskQueueService: Failed to add combat task to AWS server:",l),new Error(`Failed to add combat task to AWS server: ${l.message}`)}return s}async addHarvestingTask(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=r.playerLevel||15,i=xl.P.createHarvestingTask(e,t,n,a,{location:r.location||void 0,tools:r.tools||void 0,priority:r.priority,playerInventory:r.playerInventory,playerEquipment:r.playerEquipment}),s=bl.TaskValidationService.validateTask(i,n,a,r.playerInventory||{});if(!s.isValid)throw new Error(`Task validation failed: ${s.errors.map(e=>e.message).join(", ")}`);try{await fl._P.postJson(`${this.apiUrl}/task-queue/add-task`,{action:"addTask",playerId:e,task:i},{timeout:8e3,retries:2,exponentialBackoff:!0}),console.log("ServerTaskQueueService: Harvesting task added to AWS server queue:",i.id),await this.syncWithServer(e)}catch(o){throw console.error("ServerTaskQueueService: Failed to add harvesting task to AWS server:",o),new Error(`Failed to add harvesting task to AWS server: ${o.message}`)}return i}getQueueStatus(e){const t=this.lastKnownState.get(e);return t||{currentTask:null,queueLength:0,queuedTasks:[],isRunning:!1,totalCompleted:0}}onProgress(e,t){this.progressCallbacks.set(e,t)}onTaskComplete(e,t){this.completionCallbacks.set(e,t)}removeCallbacks(e){this.progressCallbacks.delete(e),this.completionCallbacks.delete(e);const t=this.syncIntervals.get(e);t&&(clearInterval(t),this.syncIntervals.delete(e)),this.lastKnownState.delete(e)}getQueueStatistics(e){const t=this.getQueueStatus(e),n=t.queuedTasks.reduce((e,t)=>e+t.duration,0);let r=0;return t.currentTask&&t.currentTask.progress<1&&(r=t.currentTask.duration*(1-t.currentTask.progress)),{totalTasksCompleted:t.totalCompleted,averageTaskDuration:t.queuedTasks.length>0?t.queuedTasks.reduce((e,t)=>e+t.duration,0)/t.queuedTasks.length:0,taskCompletionRate:t.totalCompleted>0?1:0,queueEfficiencyScore:this.calculateEfficiencyScore(t),estimatedCompletionTime:n+r}}calculateEfficiencyScore(e){let t=.5;return e.queueLength>0&&(t+=.2),e.isRunning&&(t+=.2),e.totalCompleted>10&&(t+=.1),Math.max(0,Math.min(1,t))}validateTaskBeforeSubmission(e,t,n,r){return bl.TaskValidationService.validateTask(e,t,n,r)}async stopAllTasks(e){try{await fl._P.postJson(`${this.apiUrl}/task-queue/stop-tasks`,{action:"stopTasks",playerId:e},{timeout:6e3,retries:1,exponentialBackoff:!1}),console.log("ServerTaskQueueService: All tasks stopped on AWS server"),await this.syncWithServer(e)}catch(t){throw console.error("ServerTaskQueueService: Failed to stop tasks on AWS server:",t),new Error(`Failed to stop tasks on AWS server: ${t.message}`)}}async removeTask(e,t){try{await fl._P.postJson(`${this.apiUrl}/task-queue/remove-task`,{action:"removeTask",playerId:e,taskId:t},{timeout:6e3,retries:1,exponentialBackoff:!1}),console.log("ServerTaskQueueService: Task removed from AWS server queue:",t),await this.syncWithServer(e)}catch(n){throw console.error("ServerTaskQueueService: Failed to remove task from AWS server:",n),new Error(`Failed to remove task from AWS server: ${n.message}`)}}async reorderTasks(e,t){if(!t||0===t.length)throw new Error("Task IDs array cannot be empty");if(new Set(t).size!==t.length)throw new Error("Duplicate task IDs found in reorder request");try{await fl._P.postJson(`${this.apiUrl}/task-queue/reorder`,{action:"reorderTasks",playerId:e,taskIds:t},{timeout:6e3,retries:1,exponentialBackoff:!1}),console.log("ServerTaskQueueService: Tasks reordered on AWS server"),await this.syncWithServer(e)}catch(n){throw console.error("ServerTaskQueueService: Failed to reorder tasks on AWS server:",n),new Error(`Failed to reorder tasks on AWS server: ${n.message}`)}}async clearQueue(e){try{await fl._P.postJson(`${this.apiUrl}/task-queue/clear`,{action:"clearQueue",playerId:e},{timeout:6e3,retries:1,exponentialBackoff:!1}),console.log("ServerTaskQueueService: Queue cleared on AWS server"),await this.syncWithServer(e)}catch(t){throw console.error("ServerTaskQueueService: Failed to clear queue on AWS server:",t),new Error(`Failed to clear queue on AWS server: ${t.message}`)}}async pauseQueue(e,t){try{await fl._P.postJson(`${this.apiUrl}/task-queue/pause`,{action:"pauseQueue",playerId:e,reason:t},{timeout:6e3,retries:1,exponentialBackoff:!1}),console.log("ServerTaskQueueService: Queue paused on AWS server"),await this.syncWithServer(e)}catch(n){throw console.error("ServerTaskQueueService: Failed to pause queue on AWS server:",n),new Error(`Failed to pause queue on AWS server: ${n.message}`)}}async resumeQueue(e){try{await fl._P.postJson(`${this.apiUrl}/task-queue/resume`,{action:"resumeQueue",playerId:e},{timeout:6e3,retries:1,exponentialBackoff:!1}),console.log("ServerTaskQueueService: Queue resumed on AWS server"),await this.syncWithServer(e)}catch(t){throw console.error("ServerTaskQueueService: Failed to resume queue on AWS server:",t),new Error(`Failed to resume queue on AWS server: ${t.message}`)}}},Sl=e=>{let{playerId:t,className:n=""}=e;const[a,i]=(0,r.useState)(null),[s,o]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(!t)return;const e=()=>{try{const e=El.getQueueStatus(t);i(e),o(!1)}catch(e){console.error("Failed to get queue status:",e),o(!1)}};e();const n=setInterval(e,1e3);return El.onTaskComplete(t,()=>{e()}),()=>{clearInterval(n),El.removeCallbacks(t)}},[t]);const l=e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60);return r>0?`${r}h ${n%60}m`:n>0?`${n}m ${t%60}s`:`${t}s`},c=e=>{if(!e.startTime||e.completed)return"";const t=Date.now()-e.startTime,n=Math.max(0,e.duration-t);return 0===n?"Completing...":l(n)},u=e=>{switch(e.type){case"harvesting":return"\u26cf\ufe0f";case"crafting":return"\ud83d\udd27";case"combat":return"\u2694\ufe0f";default:return"\ud83d\udccb"}};if(s)return(0,$i.jsx)("div",{className:`task-queue-display loading ${n}`,children:(0,$i.jsxs)("div",{className:"loading-spinner",children:[(0,$i.jsx)("span",{className:"spinner-icon",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{children:"Loading queue..."})]})});if(!a)return(0,$i.jsx)("div",{className:`task-queue-display error ${n}`,children:(0,$i.jsxs)("div",{className:"error-message",children:[(0,$i.jsx)("span",{className:"error-icon",children:"\u274c"}),(0,$i.jsx)("span",{children:"Failed to load task queue"})]})});const d=[...a.currentTask?[a.currentTask]:[],...a.queuedTasks].slice(0,5);return(0,$i.jsxs)("div",{className:`task-queue-display ${n}`,children:[(0,$i.jsxs)("div",{className:"queue-header",children:[(0,$i.jsxs)("div",{className:"queue-title",children:[(0,$i.jsx)("span",{className:"queue-icon",children:"\ud83d\udccb"}),(0,$i.jsx)("h3",{children:"Task Queue"})]}),(0,$i.jsxs)("div",{className:"queue-stats",children:[(0,$i.jsxs)("div",{className:"queue-stat",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Active:"}),(0,$i.jsx)("span",{className:"stat-value",children:a.currentTask?1:0})]}),(0,$i.jsxs)("div",{className:"queue-stat",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Queued:"}),(0,$i.jsx)("span",{className:"stat-value",children:a.queuedTasks.length})]}),(0,$i.jsxs)("div",{className:"queue-stat",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Completed:"}),(0,$i.jsx)("span",{className:"stat-value",children:a.totalCompleted})]})]})]}),(0,$i.jsx)("div",{className:"task-list",children:0===d.length?(0,$i.jsxs)("div",{className:"empty-queue",children:[(0,$i.jsx)("div",{className:"empty-icon",children:"\ud83d\udced"}),(0,$i.jsxs)("div",{className:"empty-message",children:[(0,$i.jsx)("h4",{children:"No tasks in queue"}),(0,$i.jsx)("p",{children:"Start an activity to add tasks to your queue"})]})]}):d.map((e,t)=>{const n=0===t&&!!a.currentTask,r=((e,t)=>t?"task-active":e.completed?"task-completed":e.isValid?"task-queued":"task-invalid")(e,n),i=(s=e.priority)>=8?"priority-high":s>=6?"priority-medium":"priority-low";var s;return(0,$i.jsxs)("div",{className:`task-item ${r} ${i}`,children:[(0,$i.jsxs)("div",{className:"task-header",children:[(0,$i.jsxs)("div",{className:"task-icon-name",children:[(0,$i.jsx)("span",{className:"task-type-icon",children:u(e)}),(0,$i.jsx)("span",{className:"task-icon",children:e.icon}),(0,$i.jsxs)("div",{className:"task-name-desc",children:[(0,$i.jsx)("h4",{className:"task-name",children:e.name}),(0,$i.jsx)("p",{className:"task-description",children:e.description})]})]}),(0,$i.jsxs)("div",{className:"task-status-info",children:[n&&(0,$i.jsxs)("div",{className:"task-status active",children:[(0,$i.jsx)("span",{className:"status-icon",children:"\ud83d\udfe2"}),(0,$i.jsx)("span",{className:"status-text",children:"Active"})]}),!n&&(0,$i.jsx)("div",{className:"task-position",children:(0,$i.jsxs)("span",{className:"position-text",children:["#",t]})})]})]}),(0,$i.jsxs)("div",{className:"task-details",children:[(0,$i.jsxs)("div",{className:"task-progress-info",children:[n&&e.startTime&&(0,$i.jsxs)("div",{className:"progress-section",children:[(0,$i.jsx)("div",{className:"progress-bar",children:(0,$i.jsx)("div",{className:"progress-fill",style:{width:`${Math.min(100,100*e.progress)}%`}})}),(0,$i.jsxs)("div",{className:"progress-text",children:[(0,$i.jsxs)("span",{children:[Math.round(100*e.progress),"%"]}),(0,$i.jsx)("span",{className:"time-remaining",children:c(e)})]})]}),!n&&(0,$i.jsxs)("div",{className:"task-duration",children:[(0,$i.jsx)("span",{className:"duration-icon",children:"\u23f1\ufe0f"}),(0,$i.jsx)("span",{className:"duration-text",children:l(e.duration)})]})]}),(0,$i.jsxs)("div",{className:"task-meta",children:[(0,$i.jsxs)("div",{className:"task-priority",children:[(0,$i.jsx)("span",{className:"priority-icon",children:e.priority>=8?"\ud83d\udd34":e.priority>=6?"\ud83d\udfe1":"\ud83d\udfe2"}),(0,$i.jsxs)("span",{className:"priority-text",children:["Priority ",e.priority]})]}),e.retryCount>0&&(0,$i.jsxs)("div",{className:"task-retries",children:[(0,$i.jsx)("span",{className:"retry-icon",children:"\ud83d\udd04"}),(0,$i.jsxs)("span",{className:"retry-text",children:["Retry ",e.retryCount,"/",e.maxRetries]})]}),!e.isValid&&e.validationErrors.length>0&&(0,$i.jsxs)("div",{className:"task-errors",children:[(0,$i.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,$i.jsx)("span",{className:"error-text",children:e.validationErrors[0]})]})]})]}),e.prerequisites.length>0&&(0,$i.jsxs)("div",{className:"task-prerequisites",children:[(0,$i.jsxs)("div",{className:"prerequisites-header",children:[(0,$i.jsx)("span",{className:"prereq-icon",children:"\ud83d\udccb"}),(0,$i.jsx)("span",{className:"prereq-text",children:"Requirements:"})]}),(0,$i.jsxs)("div",{className:"prerequisites-list",children:[e.prerequisites.slice(0,3).map((e,t)=>(0,$i.jsxs)("div",{className:"prerequisite "+(e.isMet?"met":"unmet"),children:[(0,$i.jsx)("span",{className:"prereq-status",children:e.isMet?"\u2705":"\u274c"}),(0,$i.jsx)("span",{className:"prereq-desc",children:e.description})]},t)),e.prerequisites.length>3&&(0,$i.jsxs)("div",{className:"prerequisites-more",children:["+",e.prerequisites.length-3," more"]})]})]})]},e.id)})}),a.queuedTasks.length>4&&(0,$i.jsxs)("div",{className:"queue-overflow",children:[(0,$i.jsx)("span",{className:"overflow-icon",children:"\ud83d\udccb"}),(0,$i.jsxs)("span",{className:"overflow-text",children:["+",a.queuedTasks.length-4," more tasks in queue"]})]})]})};class wl{constructor(){this.offlineStates=new Map,this.syncInterval=null,this.STORAGE_KEY_PREFIX="offline_queue_",this.SYNC_INTERVAL=3e4,this.MAX_PENDING_OPERATIONS=1e3,this.MAX_OFFLINE_DURATION=6048e5,this.initializeFromStorage(),this.startSyncMonitoring(),this.setupNetworkListeners()}static getInstance(){return wl.instance||(wl.instance=new wl),wl.instance}initializeFromStorage(){try{const e=Object.keys(localStorage).filter(e=>e.startsWith(this.STORAGE_KEY_PREFIX));for(const t of e){const e=t.replace(this.STORAGE_KEY_PREFIX,""),n=localStorage.getItem(t);if(n){const t=JSON.parse(n);this.offlineStates.set(e,t)}}}catch(e){console.error("Failed to initialize offline states from storage:",e)}}startSyncMonitoring(){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval(()=>{this.performPeriodicSync()},this.SYNC_INTERVAL)}setupNetworkListeners(){"undefined"!==typeof window&&(window.addEventListener("online",()=>{this.handleNetworkStatusChange(!0)}),window.addEventListener("offline",()=>{this.handleNetworkStatusChange(!1)}))}handleNetworkStatusChange(e){for(const[t,n]of this.offlineStates.entries()){const r=n.isOffline;n.isOffline=!e,n.syncStatus.isOnline=e,r&&e?this.triggerSync(t):r||e||(n.offlineStartTime=Date.now()),this.persistOfflineState(t,n)}}getOfflineState(e){let t=this.offlineStates.get(e);return t||(t={playerId:e,queue:this.createEmptyQueue(e),pendingOperations:[],lastOnlineSync:Date.now(),offlineStartTime:0,isOffline:!navigator.onLine,localVersion:1,syncStatus:{isOnline:navigator.onLine,lastSyncAttempt:0,lastSuccessfulSync:0,syncInProgress:!1,pendingOperationsCount:0,conflictsDetected:0,syncErrors:[],manualSyncRequested:!1},conflictResolutionLog:[]},this.offlineStates.set(e,t),this.persistOfflineState(e,t)),t}createEmptyQueue(e){return{playerId:e,currentTask:null,queuedTasks:[],isRunning:!1,isPaused:!1,canResume:!0,totalTasksCompleted:0,totalTimeSpent:0,totalRewardsEarned:[],averageTaskDuration:0,taskCompletionRate:0,queueEfficiencyScore:0,config:{maxQueueSize:50,maxTaskDuration:864e5,maxTotalQueueDuration:6048e5,autoStart:!0,priorityHandling:!0,retryEnabled:!0,maxRetries:3,validationEnabled:!0,syncInterval:3e4,offlineProcessingEnabled:!0,pauseOnError:!1,resumeOnResourceAvailable:!0,persistenceInterval:5e3,integrityCheckInterval:6e4,maxHistorySize:100},lastUpdated:Date.now(),lastSynced:Date.now(),createdAt:Date.now(),version:1,checksum:"",lastValidated:Date.now(),stateHistory:[],maxHistorySize:100}}async addTask(e,t){const n=this.getOfflineState(e);n.queue.queuedTasks.push(t),n.queue.lastUpdated=Date.now(),n.localVersion++;const r={id:this.generateOperationId(),type:"add_task",timestamp:Date.now(),data:t,taskId:t.id,playerId:e,localVersion:n.localVersion,applied:!1};this.addPendingOperation(n,r),this.updateSyncStatus(n),this.persistOfflineState(e,n),!n.queue.config.autoStart||n.queue.isRunning||n.queue.isPaused||await this.startLocalProcessing(e)}async removeTask(e,t){const n=this.getOfflineState(e),r=n.queue.queuedTasks.findIndex(e=>e.id===t);if(r>=0){const a=n.queue.queuedTasks.splice(r,1)[0];n.queue.lastUpdated=Date.now(),n.localVersion++;const i={id:this.generateOperationId(),type:"remove_task",timestamp:Date.now(),data:a,taskId:t,playerId:e,localVersion:n.localVersion,applied:!1};this.addPendingOperation(n,i),this.updateSyncStatus(n),this.persistOfflineState(e,n)}}async reorderTasks(e,t){const n=this.getOfflineState(e),r=[];for(const i of t){const e=n.queue.queuedTasks.find(e=>e.id===i);e&&r.push(e)}n.queue.queuedTasks=r,n.queue.lastUpdated=Date.now(),n.localVersion++;const a={id:this.generateOperationId(),type:"reorder_tasks",timestamp:Date.now(),data:{taskIds:t},playerId:e,localVersion:n.localVersion,applied:!1};this.addPendingOperation(n,a),this.updateSyncStatus(n),this.persistOfflineState(e,n)}async pauseQueue(e,t){const n=this.getOfflineState(e);n.queue.isPaused=!0,n.queue.pauseReason=t,n.queue.pausedAt=Date.now(),n.queue.lastUpdated=Date.now(),n.localVersion++;const r={id:this.generateOperationId(),type:"pause_queue",timestamp:Date.now(),data:{reason:t},playerId:e,localVersion:n.localVersion,applied:!1};this.addPendingOperation(n,r),this.updateSyncStatus(n),this.persistOfflineState(e,n)}async resumeQueue(e){const t=this.getOfflineState(e);t.queue.isPaused=!1,t.queue.pauseReason=void 0,t.queue.resumedAt=Date.now(),t.queue.lastUpdated=Date.now(),t.localVersion++;const n={id:this.generateOperationId(),type:"resume_queue",timestamp:Date.now(),data:{},playerId:e,localVersion:t.localVersion,applied:!1};this.addPendingOperation(t,n),this.updateSyncStatus(t),this.persistOfflineState(e,t),await this.startLocalProcessing(e)}getQueueState(e){return{...this.getOfflineState(e).queue}}getSyncIndicator(e){const t=this.getOfflineState(e),n=t.syncStatus;return n.syncInProgress?{status:"syncing",message:"Synchronizing with server...",progress:this.calculateSyncProgress(t),lastSync:n.lastSuccessfulSync,pendingCount:n.pendingOperationsCount,canManualSync:!1}:n.isOnline?n.syncErrors.length>0?{status:"error",message:`Sync error - ${n.syncErrors.length} errors`,lastSync:n.lastSuccessfulSync,pendingCount:n.pendingOperationsCount,canManualSync:!0}:n.conflictsDetected>0?{status:"conflict",message:`${n.conflictsDetected} conflicts detected`,lastSync:n.lastSuccessfulSync,pendingCount:n.pendingOperationsCount,canManualSync:!0}:n.pendingOperationsCount>0?{status:"syncing",message:`${n.pendingOperationsCount} changes to sync`,lastSync:n.lastSuccessfulSync,pendingCount:n.pendingOperationsCount,canManualSync:!0}:{status:"online",message:"All changes synchronized",lastSync:n.lastSuccessfulSync,pendingCount:0,canManualSync:!0}:{status:"offline",message:`Offline - ${n.pendingOperationsCount} changes pending`,lastSync:n.lastSuccessfulSync,pendingCount:n.pendingOperationsCount,canManualSync:!1}}async triggerManualSync(e){return this.getOfflineState(e).syncStatus.manualSyncRequested=!0,this.performSync(e)}async performSync(e){const t=this.getOfflineState(e);if(t.syncStatus.syncInProgress)throw new Error("Sync already in progress");t.syncStatus.syncInProgress=!0,t.syncStatus.lastSyncAttempt=Date.now(),this.updateSyncStatus(t);try{const n=await this.fetchServerQueueState(e);if(!n){const n=await this.uploadLocalState(e,t.queue);return this.handleSyncSuccess(t,n),n}const r=this.detectConflicts(t.queue,n);if(0===r.length){const n=await this.applyPendingOperations(e,t);return this.handleSyncSuccess(t,n),n}const a=await this.resolveConflicts(t.queue,n,r);await this.updateServerState(e,a);const i={success:!0,conflicts:r,resolvedQueue:a,syncTimestamp:Date.now()};return this.handleSyncSuccess(t,i),i}catch(n){throw this.handleSyncError(t,n),n}finally{t.syncStatus.syncInProgress=!1,t.syncStatus.manualSyncRequested=!1,this.persistOfflineState(e,t)}}addPendingOperation(e,t){"reorder_tasks"===t.type&&(e.pendingOperations=e.pendingOperations.filter(e=>"reorder_tasks"!==e.type)),e.pendingOperations.push(t),e.pendingOperations.length>this.MAX_PENDING_OPERATIONS&&(e.pendingOperations=e.pendingOperations.slice(-this.MAX_PENDING_OPERATIONS))}updateSyncStatus(e){e.syncStatus.pendingOperationsCount=e.pendingOperations.filter(e=>!e.applied).length,e.syncStatus.isOnline&&e.syncStatus.pendingOperationsCount>0&&!e.syncStatus.nextSyncScheduled&&(e.syncStatus.nextSyncScheduled=Date.now()+this.SYNC_INTERVAL)}persistOfflineState(e,t){try{const n=this.STORAGE_KEY_PREFIX+e;localStorage.setItem(n,JSON.stringify(t))}catch(n){console.error("Failed to persist offline state:",n)}}async startLocalProcessing(e){const t=this.getOfflineState(e);if(!t.queue.isPaused&&!t.queue.isRunning){if(t.queue.isRunning=!0,t.queue.queuedTasks.length>0&&!t.queue.currentTask){const n=t.queue.queuedTasks.shift();t.queue.currentTask=n,n.startTime=Date.now(),setTimeout(()=>{this.completeLocalTask(e,n.id)},n.duration)}this.persistOfflineState(e,t)}}async completeLocalTask(e,t){var n;const r=this.getOfflineState(e);if((null===(n=r.queue.currentTask)||void 0===n?void 0:n.id)===t){const t=r.queue.currentTask;t.completed=!0,t.progress=1,r.queue.currentTask=null,r.queue.totalTasksCompleted++,r.queue.totalTimeSpent+=t.duration,r.queue.queuedTasks.length>0?await this.startLocalProcessing(e):r.queue.isRunning=!1,this.persistOfflineState(e,r)}}async performPeriodicSync(){for(const[t,n]of this.offlineStates.entries())if(n.syncStatus.isOnline&&n.syncStatus.pendingOperationsCount>0&&!n.syncStatus.syncInProgress&&(!n.syncStatus.nextSyncScheduled||Date.now()>=n.syncStatus.nextSyncScheduled))try{await this.performSync(t)}catch(e){console.error(`Periodic sync failed for player ${t}:`,e)}}calculateSyncProgress(e){const t=e.pendingOperations.length,n=e.pendingOperations.filter(e=>e.applied).length;return t>0?n/t*100:0}detectConflicts(e,t){const n=[];if(e.version!==t.version){const r=new Map(e.queuedTasks.map(e=>[e.id,e])),a=new Map(t.queuedTasks.map(e=>[e.id,e]));for(const[e,t]of r){const r=a.get(e);r&&this.tasksConflict(t,r)&&n.push({type:"task_modified",taskId:e,serverValue:r,clientValue:t,resolution:"use_server"})}for(const e of r.keys())a.has(e)||n.push({type:"task_added",taskId:e,serverValue:null,clientValue:r.get(e),resolution:"use_client"});for(const e of a.keys())r.has(e)||n.push({type:"task_removed",taskId:e,serverValue:a.get(e),clientValue:null,resolution:"use_server"})}return n}tasksConflict(e,t){return e.progress!==t.progress||e.completed!==t.completed||e.priority!==t.priority||e.startTime!==t.startTime}async resolveConflicts(e,t,n){let r={...t};for(const a of n)switch(a.resolution){case"use_client":r=this.applyClientValue(r,a);break;case"use_server":break;case"merge":r=this.mergeConflict(r,a)}return r.version=Math.max(e.version,t.version)+1,r.lastSynced=Date.now(),r}applyClientValue(e,t){const n={...e};return"task_added"===t.type&&t.clientValue&&t.taskId&&n.queuedTasks.push(t.clientValue),n}mergeConflict(e,t){return e}handleSyncSuccess(e,t){e.syncStatus.lastSuccessfulSync=Date.now(),e.syncStatus.syncErrors=[],e.syncStatus.conflictsDetected=t.conflicts.length,e.pendingOperations.forEach(e=>e.applied=!0),e.queue=t.resolvedQueue,e.localVersion=t.resolvedQueue.version,this.updateSyncStatus(e)}handleSyncError(e,t){const n={timestamp:Date.now(),error:t.message,retryCount:0,resolved:!1};e.syncStatus.syncErrors.push(n),e.syncStatus.syncErrors.length>10&&(e.syncStatus.syncErrors=e.syncStatus.syncErrors.slice(-10))}async fetchServerQueueState(e){return null}async uploadLocalState(e,t){return{success:!0,conflicts:[],resolvedQueue:t,syncTimestamp:Date.now()}}async applyPendingOperations(e,t){return{success:!0,conflicts:[],resolvedQueue:t.queue,syncTimestamp:Date.now()}}async updateServerState(e,t){}generateOperationId(){return"op-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}async triggerSync(e){try{await this.performSync(e)}catch(t){console.error(`Failed to trigger sync for player ${e}:`,t)}}destroy(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null),this.offlineStates.clear()}}wl.instance=void 0;const Nl=e=>{let{playerId:t,className:n="",showDetails:a=!1,onSyncComplete:i}=e;const[s,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=wl.getInstance(),n=()=>{const n=e.getSyncIndicator(t);o(n)};n();const r=setInterval(n,1e3);return()=>clearInterval(r)},[t]);const h=e=>{if(!e)return"Never";const t=Date.now()-e;return t<6e4?"Just now":t<36e5?`${Math.floor(t/6e4)}m ago`:t<864e5?`${Math.floor(t/36e5)}h ago`:`${Math.floor(t/864e5)}d ago`};return s?(0,$i.jsxs)("div",{className:`sync-status-indicator ${s?`sync-status-${s.status}`:"sync-status-unknown"} ${n}`,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[(0,$i.jsxs)("div",{className:"sync-status-main",children:[(0,$i.jsx)("span",{className:"sync-icon",children:(()=>{if(!s)return"\u26aa";switch(s.status){case"online":return"\ud83d\udfe2";case"offline":case"error":return"\ud83d\udd34";case"syncing":return"\ud83d\udfe1";case"conflict":return"\ud83d\udfe0";default:return"\u26aa"}})()}),(0,$i.jsx)("span",{className:"sync-message",children:s.message}),void 0!==s.progress&&(0,$i.jsx)("div",{className:"sync-progress",children:(0,$i.jsx)("div",{className:"sync-progress-bar",style:{width:`${s.progress}%`}})}),s.canManualSync&&(0,$i.jsx)("button",{className:"sync-button "+(l?"syncing":""),onClick:async()=>{if(null!==s&&void 0!==s&&s.canManualSync&&!l){c(!0);try{const e=wl.getInstance();await e.triggerManualSync(t),null===i||void 0===i||i()}catch(e){console.error("Manual sync failed:",e)}finally{c(!1)}}},disabled:l,title:"Sync now",children:l?"\u27f3":"\u21bb"})]}),a&&(0,$i.jsxs)("div",{className:"sync-details",children:[(0,$i.jsxs)("div",{className:"sync-detail-item",children:[(0,$i.jsx)("span",{className:"sync-detail-label",children:"Last sync:"}),(0,$i.jsx)("span",{className:"sync-detail-value",children:h(s.lastSync)})]}),void 0!==s.pendingCount&&s.pendingCount>0&&(0,$i.jsxs)("div",{className:"sync-detail-item",children:[(0,$i.jsx)("span",{className:"sync-detail-label",children:"Pending:"}),(0,$i.jsxs)("span",{className:"sync-detail-value",children:[s.pendingCount," changes"]})]})]}),u&&(0,$i.jsx)("div",{className:"sync-tooltip",children:(0,$i.jsxs)("div",{className:"sync-tooltip-content",children:[(0,$i.jsxs)("div",{children:[(0,$i.jsx)("strong",{children:"Status:"})," ",s.status]}),(0,$i.jsxs)("div",{children:[(0,$i.jsx)("strong",{children:"Last sync:"})," ",h(s.lastSync)]}),void 0!==s.pendingCount&&(0,$i.jsxs)("div",{children:[(0,$i.jsx)("strong",{children:"Pending:"})," ",s.pendingCount," changes"]}),s.canManualSync&&(0,$i.jsx)("div",{className:"sync-tooltip-action",children:"Click sync button to sync now"})]})})]}):(0,$i.jsxs)("div",{className:`sync-status-indicator sync-status-unknown ${n}`,children:[(0,$i.jsx)("span",{className:"sync-icon",children:"\u26aa"}),(0,$i.jsx)("span",{className:"sync-message",children:"Loading..."})]})},kl=e=>{var t;let{playerId:n,className:a="",onTaskComplete:i}=e;const[s,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(!0),[u,d]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),[m,f]=(0,r.useState)(null),[g,y]=(0,r.useState)(!1),[v,x]=(0,r.useState)(!1),b=(0,r.useCallback)(()=>{if(n)try{const e=El.getQueueStatus(n),t=El.getQueueStatistics(n);o(e);const r=(e.queuedTasks||[]).reduce((e,t)=>e+t.duration,0),a=e.currentTask&&e.currentTask.startTime?Math.max(0,e.currentTask.duration-(Date.now()-e.currentTask.startTime)):0;d({...t,totalQueueTime:r,currentTaskETA:a}),c(!1)}catch(e){console.error("Failed to get queue status:",e),c(!1)}},[n]);(0,r.useEffect)(()=>{if(!n)return;b();const e=setInterval(b,1e3);return El.onTaskComplete(n,e=>{b(),null===i||void 0===i||i(e)}),()=>{clearInterval(e),El.removeCallbacks(n)}},[n,b,i]);const E=()=>{f(null)},S=e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60),a=Math.floor(r/24);return a>0?`${a}d ${r%24}h ${n%60}m`:r>0?`${r}h ${n%60}m`:n>0?`${n}m ${t%60}s`:`${t}s`},w=e=>{if(!e.startTime||e.completed)return"";const t=Date.now()-e.startTime,n=Math.max(0,e.duration-t);return 0===n?"Completing...":S(n)},N=e=>{switch(e.type){case"harvesting":return"\u26cf\ufe0f";case"crafting":return"\ud83d\udd27";case"combat":return"\u2694\ufe0f";default:return"\ud83d\udccb"}};if(l)return(0,$i.jsx)("div",{className:`task-queue-management loading ${a}`,children:(0,$i.jsxs)("div",{className:"loading-spinner",children:[(0,$i.jsx)("span",{className:"spinner-icon",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{children:"Loading queue management..."})]})});if(!s)return(0,$i.jsx)("div",{className:`task-queue-management error ${a}`,children:(0,$i.jsxs)("div",{className:"error-message",children:[(0,$i.jsx)("span",{className:"error-icon",children:"\u274c"}),(0,$i.jsx)("span",{children:"Failed to load task queue"})]})});const k=[...s.currentTask?[s.currentTask]:[],...s.queuedTasks||[]],C=g?k:k.slice(0,10);return(0,$i.jsxs)("div",{className:`task-queue-management ${a}`,children:[(0,$i.jsxs)("div",{className:"queue-header",children:[(0,$i.jsxs)("div",{className:"queue-title",children:[(0,$i.jsx)("span",{className:"queue-icon",children:"\ud83d\udccb"}),(0,$i.jsx)("h3",{children:"Task Queue Management"}),(0,$i.jsx)(Nl,{playerId:n,className:"queue-sync-status",showDetails:!1,onSyncComplete:b})]}),(0,$i.jsxs)("div",{className:"queue-controls",children:[(0,$i.jsxs)("button",{className:"control-btn pause-btn",onClick:s.isRunning?async()=>{try{await El.pauseQueue(n,"Manual pause"),b()}catch(e){console.error("Failed to pause queue:",e)}}:async()=>{try{await El.resumeQueue(n),b()}catch(e){console.error("Failed to resume queue:",e)}},title:s.isRunning?"Pause Queue":"Resume Queue",children:[s.isRunning?"\u23f8\ufe0f":"\u25b6\ufe0f",s.isRunning?"Pause":"Resume"]}),(0,$i.jsx)("button",{className:"control-btn stop-btn",onClick:async()=>{try{await El.stopAllTasks(n),b()}catch(e){console.error("Failed to stop all tasks:",e)}},title:"Stop All Tasks",children:"\u23f9\ufe0f Stop All"}),(0,$i.jsxs)("button",{className:"control-btn clear-btn "+(v?"confirm":""),onClick:async()=>{if(!v)return x(!0),void setTimeout(()=>x(!1),3e3);try{await El.clearQueue(n),b(),x(!1)}catch(e){console.error("Failed to clear queue:",e)}},title:"Clear Queue",children:["\ud83d\uddd1\ufe0f ",v?"Confirm Clear":"Clear Queue"]})]})]}),u&&(0,$i.jsx)("div",{className:"queue-statistics",children:(0,$i.jsxs)("div",{className:"stats-grid",children:[(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Active"}),(0,$i.jsx)("span",{className:"stat-value",children:s.currentTask?1:0})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Queued"}),(0,$i.jsx)("span",{className:"stat-value",children:(null===(t=s.queuedTasks)||void 0===t?void 0:t.length)||0})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Completed"}),(0,$i.jsx)("span",{className:"stat-value",children:u.totalTasksCompleted})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Total Time"}),(0,$i.jsx)("span",{className:"stat-value",children:S(u.totalQueueTime)})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"ETA"}),(0,$i.jsx)("span",{className:"stat-value",children:u.currentTaskETA>0?S(u.currentTaskETA):"N/A"})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Efficiency"}),(0,$i.jsxs)("span",{className:"stat-value",children:[Math.round(100*u.queueEfficiencyScore),"%"]})]})]})}),(0,$i.jsxs)("div",{className:"task-list-container",children:[(0,$i.jsxs)("div",{className:"task-list-header",children:[(0,$i.jsxs)("h4",{children:["Tasks (",k.length,")"]}),k.length>10&&(0,$i.jsx)("button",{className:"toggle-view-btn",onClick:()=>y(!g),children:g?"Show Less":`Show All (${k.length})`})]}),(0,$i.jsx)("div",{className:"task-list",children:0===C.length?(0,$i.jsxs)("div",{className:"empty-queue",children:[(0,$i.jsx)("div",{className:"empty-icon",children:"\ud83d\udced"}),(0,$i.jsxs)("div",{className:"empty-message",children:[(0,$i.jsx)("h4",{children:"No tasks in queue"}),(0,$i.jsx)("p",{children:"Start an activity to add tasks to your queue"})]})]}):C.map((e,t)=>{var r;const a=0===t&&!!s.currentTask,i=((e,t)=>t?"task-active":e.completed?"task-completed":e.isValid?"task-queued":"task-invalid")(e,a),l=(c=e.priority)>=8?"priority-high":c>=6?"priority-medium":"priority-low";var c;const u=m===t,d=!a&&((null===(r=s.queuedTasks)||void 0===r?void 0:r.length)||0)>1;return(0,$i.jsxs)("div",{className:`task-item ${i} ${l} ${u?"drag-over":""}`,draggable:d,onDragStart:t=>d&&((e,t)=>{p(t),e.dataTransfer.effectAllowed="move"})(t,e.id),onDragOver:e=>d&&((e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",f(t)})(e,t),onDragLeave:E,onDrop:e=>d&&(async(e,t)=>{if(e.preventDefault(),!h||!s)return;const r=(s.queuedTasks||[]).findIndex(e=>e.id===h);if(-1===r||r===t)return p(null),void f(null);try{const e=[...s.queuedTasks||[]],[a]=e.splice(r,1);e.splice(t,0,a);const i=e.map(e=>e.id);await El.reorderTasks(n,i),o(t=>t?{...t,queuedTasks:e}:null)}catch(a){console.error("Failed to reorder tasks:",a)}p(null),f(null)})(e,t),children:[(0,$i.jsxs)("div",{className:"task-header",children:[(0,$i.jsxs)("div",{className:"task-icon-name",children:[d&&(0,$i.jsx)("span",{className:"drag-handle",title:"Drag to reorder",children:"\u22ee\u22ee"}),(0,$i.jsx)("span",{className:"task-type-icon",children:N(e)}),(0,$i.jsx)("span",{className:"task-icon",children:e.icon}),(0,$i.jsxs)("div",{className:"task-name-desc",children:[(0,$i.jsx)("h4",{className:"task-name",children:e.name}),(0,$i.jsx)("p",{className:"task-description",children:e.description})]})]}),(0,$i.jsxs)("div",{className:"task-actions",children:[(0,$i.jsxs)("div",{className:"task-status-info",children:[a&&(0,$i.jsxs)("div",{className:"task-status active",children:[(0,$i.jsx)("span",{className:"status-icon",children:"\ud83d\udfe2"}),(0,$i.jsx)("span",{className:"status-text",children:"Active"})]}),!a&&(0,$i.jsx)("div",{className:"task-position",children:(0,$i.jsxs)("span",{className:"position-text",children:["#",t]})})]}),!a&&(0,$i.jsx)("button",{className:"remove-task-btn",onClick:()=>(async e=>{try{await El.removeTask(n,e),b()}catch(t){console.error("Failed to remove task:",t)}})(e.id),title:"Remove Task",children:"\u274c"})]})]}),(0,$i.jsxs)("div",{className:"task-details",children:[(0,$i.jsxs)("div",{className:"task-progress-info",children:[a&&e.startTime&&(0,$i.jsxs)("div",{className:"progress-section",children:[(0,$i.jsx)("div",{className:"progress-bar",children:(0,$i.jsx)("div",{className:"progress-fill",style:{width:`${Math.min(100,100*e.progress)}%`}})}),(0,$i.jsxs)("div",{className:"progress-text",children:[(0,$i.jsxs)("span",{children:[Math.round(100*e.progress),"%"]}),(0,$i.jsx)("span",{className:"time-remaining",children:w(e)})]})]}),!a&&(0,$i.jsxs)("div",{className:"task-duration",children:[(0,$i.jsx)("span",{className:"duration-icon",children:"\u23f1\ufe0f"}),(0,$i.jsx)("span",{className:"duration-text",children:S(e.duration)})]})]}),(0,$i.jsxs)("div",{className:"task-meta",children:[(0,$i.jsxs)("div",{className:"task-priority",children:[(0,$i.jsx)("span",{className:"priority-icon",children:e.priority>=8?"\ud83d\udd34":e.priority>=6?"\ud83d\udfe1":"\ud83d\udfe2"}),(0,$i.jsxs)("span",{className:"priority-text",children:["Priority ",e.priority]})]}),e.retryCount>0&&(0,$i.jsxs)("div",{className:"task-retries",children:[(0,$i.jsx)("span",{className:"retry-icon",children:"\ud83d\udd04"}),(0,$i.jsxs)("span",{className:"retry-text",children:["Retry ",e.retryCount,"/",e.maxRetries]})]}),!e.isValid&&e.validationErrors.length>0&&(0,$i.jsxs)("div",{className:"task-errors",children:[(0,$i.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,$i.jsx)("span",{className:"error-text",children:e.validationErrors[0]})]})]})]}),e.prerequisites.length>0&&(0,$i.jsxs)("div",{className:"task-prerequisites",children:[(0,$i.jsxs)("div",{className:"prerequisites-header",children:[(0,$i.jsx)("span",{className:"prereq-icon",children:"\ud83d\udccb"}),(0,$i.jsx)("span",{className:"prereq-text",children:"Requirements:"})]}),(0,$i.jsxs)("div",{className:"prerequisites-list",children:[e.prerequisites.slice(0,3).map((e,t)=>(0,$i.jsxs)("div",{className:"prerequisite "+(e.isMet?"met":"unmet"),children:[(0,$i.jsx)("span",{className:"prereq-status",children:e.isMet?"\u2705":"\u274c"}),(0,$i.jsx)("span",{className:"prereq-desc",children:e.description})]},t)),e.prerequisites.length>3&&(0,$i.jsxs)("div",{className:"prerequisites-more",children:["+",e.prerequisites.length-3," more"]})]})]})]},e.id)})}),!g&&k.length>10&&(0,$i.jsxs)("div",{className:"queue-overflow",children:[(0,$i.jsx)("span",{className:"overflow-icon",children:"\ud83d\udccb"}),(0,$i.jsxs)("span",{className:"overflow-text",children:["+",k.length-10," more tasks in queue"]})]})]})]})},Cl=e=>{let{playerId:t,className:n="",defaultMode:a="display",onTaskComplete:i}=e;const[s,o]=(0,r.useState)(a);return(0,$i.jsxs)("div",{className:`task-queue-container ${n}`,children:[(0,$i.jsxs)("div",{className:"queue-mode-toggle",children:[(0,$i.jsx)("button",{className:"mode-btn "+("display"===s?"active":""),onClick:()=>o("display"),title:"Basic Queue Display",children:"\ud83d\udccb Display"}),(0,$i.jsx)("button",{className:"mode-btn "+("management"===s?"active":""),onClick:()=>o("management"),title:"Full Queue Management",children:"\u2699\ufe0f Manage"})]}),"display"===s?(0,$i.jsx)(Sl,{playerId:t,className:"queue-component"}):(0,$i.jsx)(kl,{playerId:t,className:"queue-component",onTaskComplete:i})]})};class Il{constructor(){this.apiUrl=void 0,this.progressCallbacks=new Map,this.completionCallbacks=new Map,this.statusCallbacks=new Map,this.syncIntervals=new Map,this.lastKnownState=new Map,this.isHealthy=!0,this.lastHealthCheck=0,this.healthCheckInterval=null,this.apiUrl={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_ENABLE_CONTINUOUS_PROCESSING:"true",REACT_APP_ENABLE_TASK_QUEUE:"true",REACT_APP_ENV:"gameengine",REACT_APP_GAME_ENGINE_MODE:"true"}.REACT_APP_FARGATE_API_URL||"https://ks7h6drcjd.execute-api.us-west-2.amazonaws.com/prod",this.startHealthMonitoring()}static getInstance(){return Il.instance||(Il.instance=new Il),Il.instance}startHealthMonitoring(){this.healthCheckInterval=setInterval(async()=>{try{await this.checkHealth()}catch(e){console.warn("Fargate health check failed:",e),this.isHealthy=!1}},3e4),this.checkHealth().catch(()=>{this.isHealthy=!1})}async checkHealth(){try{const e=await fl._P.fetchJson(`${this.apiUrl}/health`,{},{timeout:5e3,retries:1,exponentialBackoff:!1});return this.isHealthy="healthy"===e.status,this.lastHealthCheck=Date.now(),e}catch(e){throw this.isHealthy=!1,e}}getHealthStatus(){return{isHealthy:this.isHealthy,lastCheck:this.lastHealthCheck}}async syncPlayerQueue(e){try{console.log("FargateGameEngineService: Syncing queue for player:",e);const t=(await fl._P.postJson(`${this.apiUrl}/task-queue/sync`,{playerId:e},{timeout:8e3,retries:2,exponentialBackoff:!0})).queue;return this.lastKnownState.set(e,t),this.syncIntervals.has(e)||this.startRealTimeSync(e),console.log("FargateGameEngineService: Queue synced successfully"),t}catch(t){throw console.error("FargateGameEngineService: Failed to sync queue:",t),t}}async getTaskQueueStatus(e){try{const t=await fl._P.fetchJson(`${this.apiUrl}/task-queue/${e}`,{},{timeout:5e3,retries:1,exponentialBackoff:!1});return this.lastKnownState.set(e,t.queue),t}catch(t){throw console.error("FargateGameEngineService: Failed to get queue status:",t),t}}async addTaskToQueue(e,t){try{await fl._P.postJson(`${this.apiUrl}/task-queue/add-task`,{playerId:e,task:t},{timeout:8e3,retries:2,exponentialBackoff:!0}),console.log("FargateGameEngineService: Task added to queue:",t.id),await this.syncPlayerQueue(e)}catch(n){throw console.error("FargateGameEngineService: Failed to add task to queue:",n),n}}async stopAllTasks(e){try{await fl._P.postJson(`${this.apiUrl}/task-queue/stop-tasks`,{playerId:e},{timeout:6e3,retries:1,exponentialBackoff:!1}),console.log("FargateGameEngineService: All tasks stopped for player:",e),await this.syncPlayerQueue(e)}catch(t){throw console.error("FargateGameEngineService: Failed to stop tasks:",t),t}}startRealTimeSync(e){const t=setInterval(async()=>{try{await this.fetchAndUpdateStatus(e)}catch(t){console.error("FargateGameEngineService: Real-time sync error:",t)}},2e3);this.syncIntervals.set(e,t)}async fetchAndUpdateStatus(e){try{var t,n;const i=await this.getTaskQueueStatus(e),s=i.queue,o=i.currentProgress,l=this.lastKnownState.get(e);if(!l||(null===(t=l.currentTask)||void 0===t?void 0:t.id)!==(null===(n=s.currentTask)||void 0===n?void 0:n.id)||l.totalCompleted!==s.totalCompleted||l.isRunning!==s.isRunning){var r,a;if(console.log("FargateGameEngineService: Queue state changed:",{previousTask:null===l||void 0===l||null===(r=l.currentTask)||void 0===r?void 0:r.id,currentTask:null===(a=s.currentTask)||void 0===a?void 0:a.id,previousCompleted:null===l||void 0===l?void 0:l.totalCompleted,currentCompleted:s.totalCompleted,previousRunning:null===l||void 0===l?void 0:l.isRunning,currentRunning:s.isRunning}),l&&s.totalCompleted>l.totalCompleted){const t=s.totalCompleted-l.totalCompleted;console.log(`FargateGameEngineService: ${t} task(s) completed`);const n=this.completionCallbacks.get(e);if(n&&l.currentTask){n({task:{...l.currentTask,completed:!0,rewards:[]},rewards:this.generateMockRewards(l.currentTask),nextTask:s.currentTask})}}this.lastKnownState.set(e,s);const t=this.statusCallbacks.get(e);t&&t(s)}if(o){const t=this.progressCallbacks.get(e);t&&t({taskId:o.taskId,progress:o.progress,timeRemaining:o.timeRemaining,isComplete:o.isComplete})}}catch(i){console.error("FargateGameEngineService: Failed to fetch status:",i)}}generateMockRewards(e){const t=[];switch(e.type){case vl.TaskType.HARVESTING:t.push({type:"resource",itemId:"copper_ore",quantity:Math.floor(3*Math.random())+1,rarity:"common",isRare:!1}),t.push({type:"experience",quantity:25});break;case vl.TaskType.COMBAT:t.push({type:"experience",quantity:35}),t.push({type:"currency",quantity:15});break;case vl.TaskType.CRAFTING:t.push({type:"experience",quantity:30}),t.push({type:"item",itemId:"clockwork_gear",quantity:1,rarity:"common",isRare:!1})}return t}getLocalQueueStatus(e){return this.lastKnownState.get(e)||null}getQueueStatistics(e){const t=this.getLocalQueueStatus(e);if(!t)return{totalTasksCompleted:0,averageTaskDuration:0,taskCompletionRate:0,queueEfficiencyScore:0,estimatedCompletionTime:0};const n=t.queuedTasks.reduce((e,t)=>e+t.duration,0);let r=0;t.currentTask&&t.currentTask.progress<1&&(r=t.currentTask.duration*(1-t.currentTask.progress));const a=t.queuedTasks.length>0?t.queuedTasks.reduce((e,t)=>e+t.duration,0)/t.queuedTasks.length:0;let i=.5;return t.queuedTasks.length>0&&(i+=.2),t.totalCompleted>10&&(i+=.1),t.isRunning&&(i+=.2),{totalTasksCompleted:t.totalCompleted,averageTaskDuration:a,taskCompletionRate:t.totalCompleted>0?1:0,queueEfficiencyScore:Math.min(1,i),estimatedCompletionTime:n+r}}onProgress(e,t){this.progressCallbacks.set(e,t)}onTaskComplete(e,t){this.completionCallbacks.set(e,t)}onStatusChange(e,t){this.statusCallbacks.set(e,t)}removeCallbacks(e){this.progressCallbacks.delete(e),this.completionCallbacks.delete(e),this.statusCallbacks.delete(e);const t=this.syncIntervals.get(e);t&&(clearInterval(t),this.syncIntervals.delete(e)),this.lastKnownState.delete(e)}destroy(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null);for(const e of this.syncIntervals.values())clearInterval(e);this.syncIntervals.clear(),this.lastKnownState.clear(),this.progressCallbacks.clear(),this.completionCallbacks.clear(),this.statusCallbacks.clear()}}Il.instance=void 0;const Al=Il.getInstance(),Tl=e=>{let{playerId:t,className:n="",onTaskComplete:a,onStatusChange:i}=e;const[s,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(!0),[h,p]=(0,r.useState)(null),[m,f]=(0,r.useState)(!0),[g,y]=(0,r.useState)(null),[v,x]=(0,r.useState)(!1),[b,E]=(0,r.useState)(null),S=[{id:"copper_mining",name:"Copper Mining",type:vl.TaskType.HARVESTING,icon:"\u26cf\ufe0f",description:"Mine copper ore from the steampunk mines",duration:3e4,requirements:["Mining Level 1"]},{id:"gear_crafting",name:"Gear Crafting",type:vl.TaskType.CRAFTING,icon:"\u2699\ufe0f",description:"Craft clockwork gears for machinery",duration:45e3,requirements:["Clockmaking Level 1","3x Copper Ore"]},{id:"steam_golem_combat",name:"Steam Golem Combat",type:vl.TaskType.COMBAT,icon:"\ud83e\udd16",description:"Battle steam-powered golems",duration:6e4,requirements:["Combat Level 1","Steam Weapon"]},{id:"crystal_harvesting",name:"Crystal Harvesting",type:vl.TaskType.HARVESTING,icon:"\ud83d\udc8e",description:"Harvest energy crystals from crystal caves",duration:4e4,requirements:["Crystal Extraction Level 1"]},{id:"automaton_crafting",name:"Automaton Crafting",type:vl.TaskType.CRAFTING,icon:"\ud83d\udd27",description:"Build mechanical automatons",duration:9e4,requirements:["Engineering Level 2","5x Gears","2x Crystals"]}],w=(0,r.useCallback)(async()=>{if(t)try{const e=Al.getLocalQueueStatus(t),n=Al.getQueueStatistics(t),r=Al.getHealthStatus();o(e),c(n),f(r.isHealthy),p(null),e&&(null===i||void 0===i||i(e))}catch(e){console.error("Failed to update queue status:",e),p(e.message||"Failed to update queue status")}},[t,i]);(0,r.useEffect)(()=>{if(!t)return;(async()=>{try{d(!0),await Al.syncPlayerQueue(t),await w()}catch(e){console.error("Failed to initialize queue:",e),p(e.message||"Failed to connect to game engine")}finally{d(!1)}})();Al.onProgress(t,e=>{E(e)}),Al.onTaskComplete(t,e=>{E(null),w(),null===a||void 0===a||a(e)}),Al.onStatusChange(t,e=>{o(e),null===i||void 0===i||i(e)});const e=setInterval(w,5e3);return()=>{clearInterval(e),Al.removeCallbacks(t)}},[t,w,a,i]);const N=e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60);return r>0?`${r}h ${n%60}m`:n>0?`${n}m ${t%60}s`:`${t}s`},k=e=>{switch(e){case vl.TaskType.HARVESTING:return"\u26cf\ufe0f";case vl.TaskType.CRAFTING:return"\ud83d\udd27";case vl.TaskType.COMBAT:return"\u2694\ufe0f";default:return"\ud83d\udccb"}};return u?(0,$i.jsx)("div",{className:`fargate-task-queue-manager loading ${n}`,children:(0,$i.jsxs)("div",{className:"loading-spinner",children:[(0,$i.jsx)("span",{className:"spinner-icon",children:"\u2699\ufe0f"}),(0,$i.jsx)("span",{children:"Connecting to game engine..."})]})}):(0,$i.jsxs)("div",{className:`fargate-task-queue-manager ${n}`,children:[(0,$i.jsxs)("div",{className:"queue-header",children:[(0,$i.jsxs)("div",{className:"queue-title",children:[(0,$i.jsx)("span",{className:"queue-icon",children:"\ud83c\udfae"}),(0,$i.jsx)("h3",{children:"Fargate Game Engine"}),(0,$i.jsxs)("div",{className:"health-indicator "+(m?"healthy":"unhealthy"),children:[(0,$i.jsx)("span",{className:"health-icon",children:m?"\ud83d\udfe2":"\ud83d\udd34"}),(0,$i.jsx)("span",{className:"health-text",children:m?"Online":"Offline"})]})]}),(0,$i.jsxs)("div",{className:"queue-controls",children:[(0,$i.jsx)("button",{className:"control-btn start-btn",onClick:()=>x(!0),disabled:!m,title:"Start New Activity",children:"\u25b6\ufe0f Start Activity"}),(0,$i.jsx)("button",{className:"control-btn stop-btn",onClick:async()=>{if(t)try{p(null),await Al.stopAllTasks(t),E(null)}catch(e){console.error("Failed to stop tasks:",e),p(e.message||"Failed to stop tasks")}},disabled:!m||!(null!==s&&void 0!==s&&s.isRunning),title:"Stop All Tasks",children:"\u23f9\ufe0f Stop All"})]})]}),h&&(0,$i.jsxs)("div",{className:"error-banner",children:[(0,$i.jsx)("span",{className:"error-icon",children:"\u274c"}),(0,$i.jsx)("span",{className:"error-message",children:h}),(0,$i.jsx)("button",{className:"error-dismiss",onClick:()=>p(null),children:"\u2715"})]}),l&&(0,$i.jsx)("div",{className:"queue-statistics",children:(0,$i.jsxs)("div",{className:"stats-grid",children:[(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Active"}),(0,$i.jsx)("span",{className:"stat-value",children:null!==s&&void 0!==s&&s.currentTask?1:0})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Queued"}),(0,$i.jsx)("span",{className:"stat-value",children:(null===s||void 0===s?void 0:s.queuedTasks.length)||0})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Completed"}),(0,$i.jsx)("span",{className:"stat-value",children:l.totalTasksCompleted})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Queue Time"}),(0,$i.jsx)("span",{className:"stat-value",children:N(l.estimatedCompletionTime)})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Efficiency"}),(0,$i.jsxs)("span",{className:"stat-value",children:[Math.round(100*l.queueEfficiencyScore),"%"]})]})]})}),(null===s||void 0===s?void 0:s.currentTask)&&(0,$i.jsxs)("div",{className:"current-task",children:[(0,$i.jsxs)("div",{className:"current-task-header",children:[(0,$i.jsxs)("h4",{children:[(0,$i.jsx)("span",{className:"task-icon",children:s.currentTask.icon}),"Current Task: ",s.currentTask.name]}),(0,$i.jsxs)("div",{className:"task-status",children:[(0,$i.jsx)("span",{className:"status-icon",children:"\ud83d\udfe2"}),(0,$i.jsx)("span",{className:"status-text",children:"Active"})]})]}),(0,$i.jsxs)("div",{className:"current-task-progress",children:[(0,$i.jsx)("div",{className:"progress-bar",children:(0,$i.jsx)("div",{className:"progress-fill",style:{width:`${Math.min(100,100*((null===b||void 0===b?void 0:b.progress)||s.currentTask.progress))}%`}})}),(0,$i.jsxs)("div",{className:"progress-info",children:[(0,$i.jsxs)("span",{className:"progress-percentage",children:[Math.round(100*((null===b||void 0===b?void 0:b.progress)||s.currentTask.progress)),"%"]}),(0,$i.jsx)("span",{className:"time-remaining",children:null!==b&&void 0!==b&&b.timeRemaining?N(b.timeRemaining):(e=>{if(!e.startTime||e.completed)return"";const t=Date.now()-e.startTime,n=Math.max(0,e.duration-t);return 0===n?"Completing...":N(n)})(s.currentTask)})]})]}),(0,$i.jsx)("p",{className:"task-description",children:s.currentTask.description})]}),(null===s||void 0===s?void 0:s.queuedTasks)&&s.queuedTasks.length>0&&(0,$i.jsxs)("div",{className:"queued-tasks",children:[(0,$i.jsxs)("h4",{children:["Queued Tasks (",s.queuedTasks.length,")"]}),(0,$i.jsxs)("div",{className:"task-list",children:[s.queuedTasks.slice(0,5).map((e,t)=>(0,$i.jsxs)("div",{className:"queued-task-item",children:[(0,$i.jsxs)("div",{className:"task-info",children:[(0,$i.jsxs)("span",{className:"task-position",children:["#",t+1]}),(0,$i.jsx)("span",{className:"task-icon",children:e.icon}),(0,$i.jsxs)("div",{className:"task-details",children:[(0,$i.jsx)("span",{className:"task-name",children:e.name}),(0,$i.jsx)("span",{className:"task-duration",children:N(e.duration)})]})]}),(0,$i.jsx)("div",{className:"task-type",children:(0,$i.jsx)("span",{className:"type-icon",children:k(e.type)})})]},e.id)),s.queuedTasks.length>5&&(0,$i.jsxs)("div",{className:"more-tasks",children:["+",s.queuedTasks.length-5," more tasks"]})]})]}),!(null!==s&&void 0!==s&&s.currentTask)&&(!(null!==s&&void 0!==s&&s.queuedTasks)||0===s.queuedTasks.length)&&(0,$i.jsxs)("div",{className:"empty-queue",children:[(0,$i.jsx)("div",{className:"empty-icon",children:"\ud83c\udfae"}),(0,$i.jsxs)("div",{className:"empty-message",children:[(0,$i.jsx)("h4",{children:"No active tasks"}),(0,$i.jsx)("p",{children:"Start an activity to begin processing tasks with the Fargate game engine"}),(0,$i.jsx)("button",{className:"start-activity-btn",onClick:()=>x(!0),disabled:!m,children:"Start Your First Activity"})]})]}),v&&(0,$i.jsxs)("div",{className:"activity-selector-modal",children:[(0,$i.jsx)("div",{className:"modal-backdrop",onClick:()=>x(!1)}),(0,$i.jsxs)("div",{className:"modal-content",children:[(0,$i.jsxs)("div",{className:"modal-header",children:[(0,$i.jsx)("h3",{children:"Select Activity"}),(0,$i.jsx)("button",{className:"modal-close",onClick:()=>x(!1),children:"\u2715"})]}),(0,$i.jsx)("div",{className:"activity-list",children:S.map(e=>(0,$i.jsxs)("div",{className:"activity-option",children:[(0,$i.jsxs)("div",{className:"activity-info",children:[(0,$i.jsxs)("div",{className:"activity-header",children:[(0,$i.jsx)("span",{className:"activity-icon",children:e.icon}),(0,$i.jsx)("h4",{className:"activity-name",children:e.name}),(0,$i.jsx)("span",{className:"activity-type",children:k(e.type)})]}),(0,$i.jsx)("p",{className:"activity-description",children:e.description}),(0,$i.jsxs)("div",{className:"activity-meta",children:[(0,$i.jsxs)("span",{className:"activity-duration",children:["\u23f1\ufe0f ",N(e.duration)]}),e.requirements&&(0,$i.jsxs)("div",{className:"activity-requirements",children:[(0,$i.jsx)("span",{className:"req-label",children:"Requires:"}),(0,$i.jsx)("span",{className:"req-list",children:e.requirements.join(", ")})]})]})]}),(0,$i.jsxs)("div",{className:"activity-actions",children:[(0,$i.jsx)("button",{className:"action-btn start-btn",onClick:()=>(async e=>{if(t)try{p(null);const n=xl.P.createTaskFromActivity(t,e);await Al.stopAllTasks(t),await Al.addTaskToQueue(t,n),x(!1),y(null)}catch(n){console.error("Failed to start activity:",n),p(n.message||"Failed to start activity")}})(e),title:"Start immediately (stops current task)",children:"\u25b6\ufe0f Start Now"}),(0,$i.jsx)("button",{className:"action-btn queue-btn",onClick:()=>(async e=>{if(t)try{p(null);const n=xl.P.createTaskFromActivity(t,e);await Al.addTaskToQueue(t,n),x(!1),y(null)}catch(n){console.error("Failed to queue activity:",n),p(n.message||"Failed to queue activity")}})(e),title:"Add to queue",children:"\ud83d\udccb Queue"})]})]},e.id))})]})]})]})},Rl=e=>{let{character:t,onGuildCreated:n}=e;const[a,i]=(0,r.useState)({name:"",description:"",isPublic:!0,requireApproval:!1,maxMembers:50}),[s,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(null),u=e=>{const{name:t,value:n,type:r}=e.target;i(a=>({...a,[t]:"checkbox"===r?e.target.checked:n}))};return(0,$i.jsxs)("div",{className:"guild-creation",children:[(0,$i.jsxs)("div",{className:"guild-creation-header",children:[(0,$i.jsx)("h2",{children:"Create Your Guild"}),(0,$i.jsx)("p",{children:"Establish a new guild and become its leader. Recruit members and build your steampunk empire!"})]}),(0,$i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),a.name.trim())if(a.name.length<3||a.name.length>30)c("Guild name must be between 3 and 30 characters");else if(a.maxMembers<5||a.maxMembers>100)c("Maximum members must be between 5 and 100");else try{o(!0),c(null);const e={leaderId:t.userId,name:a.name.trim(),description:a.description.trim(),settings:{isPublic:a.isPublic,requireApproval:a.requireApproval,maxMembers:a.maxMembers,description:a.description.trim(),allowedActivities:["crafting","harvesting","combat"]}},r=await fetch("/api/guild",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){const e=await r.json();throw new Error(e.error||"Failed to create guild")}const{guild:i,membership:s}=await r.json();n(i,s)}catch(r){c(r instanceof Error?r.message:"An error occurred")}finally{o(!1)}else c("Guild name is required")},className:"guild-creation-form",children:[(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"name",className:"form-label",children:"Guild Name *"}),(0,$i.jsx)("input",{type:"text",id:"name",name:"name",value:a.name,onChange:u,className:"form-input",placeholder:"Enter guild name (3-30 characters)",maxLength:30,required:!0}),(0,$i.jsxs)("div",{className:"character-count",children:[a.name.length,"/30 characters"]})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"description",className:"form-label",children:"Guild Description"}),(0,$i.jsx)("textarea",{id:"description",name:"description",value:a.description,onChange:u,className:"form-textarea",placeholder:"Describe your guild's purpose and goals...",rows:4,maxLength:500}),(0,$i.jsxs)("div",{className:"character-count",children:[a.description.length,"/500 characters"]})]}),(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"maxMembers",className:"form-label",children:"Maximum Members"}),(0,$i.jsx)("input",{type:"number",id:"maxMembers",name:"maxMembers",value:a.maxMembers,onChange:e=>{const{name:t,value:n}=e.target;i(e=>({...e,[t]:parseInt(n)||0}))},className:"form-input",min:5,max:100}),(0,$i.jsx)("div",{className:"form-help",children:"Set the maximum number of members (5-100)"})]}),(0,$i.jsxs)("div",{className:"form-group checkbox-group",children:[(0,$i.jsxs)("label",{className:"checkbox-label",children:[(0,$i.jsx)("input",{type:"checkbox",name:"isPublic",checked:a.isPublic,onChange:u,className:"form-checkbox"}),(0,$i.jsx)("span",{className:"checkbox-text",children:"Public Guild"})]}),(0,$i.jsx)("div",{className:"form-help",children:"Public guilds appear in search results and can be joined by anyone"})]}),(0,$i.jsxs)("div",{className:"form-group checkbox-group",children:[(0,$i.jsxs)("label",{className:"checkbox-label",children:[(0,$i.jsx)("input",{type:"checkbox",name:"requireApproval",checked:a.requireApproval,onChange:u,className:"form-checkbox"}),(0,$i.jsx)("span",{className:"checkbox-text",children:"Require Approval"})]}),(0,$i.jsx)("div",{className:"form-help",children:"New members must be approved by officers or the leader"})]}),l&&(0,$i.jsx)("div",{className:"error-message",children:l}),(0,$i.jsx)("div",{className:"form-actions",children:(0,$i.jsx)("button",{type:"submit",disabled:s,className:"create-button",children:s?"Creating Guild...":"Create Guild"})})]}),(0,$i.jsxs)("div",{className:"guild-creation-info",children:[(0,$i.jsx)("h3",{children:"Guild Leadership"}),(0,$i.jsx)("p",{children:"As the guild leader, you will have the following responsibilities and powers:"}),(0,$i.jsxs)("ul",{children:[(0,$i.jsx)("li",{children:"Invite and remove members"}),(0,$i.jsx)("li",{children:"Promote members to officers"}),(0,$i.jsx)("li",{children:"Modify guild settings and description"}),(0,$i.jsx)("li",{children:"Manage guild events and activities"}),(0,$i.jsx)("li",{children:"Transfer leadership to another member"})]})]})]})},jl=e=>{let{guild:t,membership:n,character:a,onGuildUpdated:i,onGuildLeft:s}=e;const[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)({name:t.name,description:t.description,isPublic:t.settings.isPublic,requireApproval:t.settings.requireApproval,maxMembers:t.settings.maxMembers}),[d,h]=(0,r.useState)(!1),[p,m]=(0,r.useState)(null),[f,g]=(0,r.useState)(!1),y=n.permissions.includes("edit_settings"),v="leader"===n.role,x=e=>("string"===typeof e?new Date(e):e).toLocaleDateString(),b=()=>{o&&u({name:t.name,description:t.description,isPublic:t.settings.isPublic,requireApproval:t.settings.requireApproval,maxMembers:t.settings.maxMembers}),l(!o),m(null)},E=e=>{const{name:t,value:n,type:r}=e.target;u(a=>({...a,[t]:"checkbox"===r?e.target.checked:n}))};return(0,$i.jsxs)("div",{className:"guild-profile",children:[(0,$i.jsxs)("div",{className:"guild-header",children:[(0,$i.jsxs)("div",{className:"guild-basic-info",children:[(0,$i.jsxs)("div",{className:"guild-name-section",children:[o?(0,$i.jsx)("input",{type:"text",name:"name",value:c.name,onChange:E,className:"guild-name-input",maxLength:30}):(0,$i.jsx)("h1",{className:"guild-name",children:t.name}),(0,$i.jsxs)("div",{className:"guild-level",children:["Level ",t.level]})]}),(0,$i.jsxs)("div",{className:"guild-stats",children:[(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Members"}),(0,$i.jsxs)("span",{className:"stat-value",children:[t.memberCount,"/",t.settings.maxMembers]})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Experience"}),(0,$i.jsx)("span",{className:"stat-value",children:t.experience})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Created"}),(0,$i.jsx)("span",{className:"stat-value",children:x(t.createdAt)})]})]})]}),(0,$i.jsxs)("div",{className:"guild-actions",children:[y&&(0,$i.jsx)("button",{onClick:o?async()=>{if(c.name.trim())if(c.name.length<3||c.name.length>30)m("Guild name must be between 3 and 30 characters");else if(c.maxMembers<5||c.maxMembers>100)m("Maximum members must be between 5 and 100");else try{h(!0),m(null);const e={guildId:t.guildId,name:c.name.trim()!==t.name?c.name.trim():void 0,description:c.description.trim()!==t.description?c.description.trim():void 0,settings:{isPublic:c.isPublic,requireApproval:c.requireApproval,maxMembers:c.maxMembers,description:c.description.trim(),allowedActivities:t.settings.allowedActivities}},n=await fetch(`/api/guild/${t.guildId}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const e=await n.json();throw new Error(e.error||"Failed to update guild")}const{guild:r}=await n.json();i(r),l(!1)}catch(e){m(e instanceof Error?e.message:"An error occurred")}finally{h(!1)}else m("Guild name is required")}:b,disabled:d,className:"edit-button",children:d?"Saving...":o?"Save Changes":"Edit Guild"}),o&&(0,$i.jsx)("button",{onClick:b,className:"cancel-button",children:"Cancel"}),!v&&(0,$i.jsx)("button",{onClick:()=>g(!0),className:"leave-button",children:"Leave Guild"})]})]}),(0,$i.jsxs)("div",{className:"guild-description-section",children:[(0,$i.jsx)("h3",{children:"Description"}),o?(0,$i.jsx)("textarea",{name:"description",value:c.description,onChange:E,className:"guild-description-input",rows:4,maxLength:500,placeholder:"Describe your guild's purpose and goals..."}):(0,$i.jsx)("p",{className:"guild-description",children:t.description||"No description provided."})]}),(0,$i.jsxs)("div",{className:"guild-settings-section",children:[(0,$i.jsx)("h3",{children:"Guild Settings"}),(0,$i.jsxs)("div",{className:"settings-grid",children:[(0,$i.jsxs)("div",{className:"setting-item",children:[(0,$i.jsx)("span",{className:"setting-label",children:"Visibility"}),o?(0,$i.jsxs)("label",{className:"setting-checkbox",children:[(0,$i.jsx)("input",{type:"checkbox",name:"isPublic",checked:c.isPublic,onChange:E}),(0,$i.jsx)("span",{children:"Public Guild"})]}):(0,$i.jsx)("span",{className:"setting-value",children:t.settings.isPublic?"Public":"Private"})]}),(0,$i.jsxs)("div",{className:"setting-item",children:[(0,$i.jsx)("span",{className:"setting-label",children:"Join Requirements"}),o?(0,$i.jsxs)("label",{className:"setting-checkbox",children:[(0,$i.jsx)("input",{type:"checkbox",name:"requireApproval",checked:c.requireApproval,onChange:E}),(0,$i.jsx)("span",{children:"Require Approval"})]}):(0,$i.jsx)("span",{className:"setting-value",children:t.settings.requireApproval?"Approval Required":"Open Join"})]}),(0,$i.jsxs)("div",{className:"setting-item",children:[(0,$i.jsx)("span",{className:"setting-label",children:"Max Members"}),o?(0,$i.jsx)("input",{type:"number",name:"maxMembers",value:c.maxMembers,onChange:e=>{const{name:t,value:n}=e.target;u(e=>({...e,[t]:parseInt(n)||0}))},className:"setting-number-input",min:5,max:100}):(0,$i.jsx)("span",{className:"setting-value",children:t.settings.maxMembers})]})]})]}),(0,$i.jsxs)("div",{className:"member-info-section",children:[(0,$i.jsx)("h3",{children:"Your Membership"}),(0,$i.jsxs)("div",{className:"membership-details",children:[(0,$i.jsxs)("div",{className:"membership-item",children:[(0,$i.jsx)("span",{className:"membership-label",children:"Role"}),(0,$i.jsx)("span",{className:"membership-value role-badge role-{membership.role}",children:(e=>{switch(e){case"leader":return"Guild Master";case"officer":return"Officer";case"member":return"Member";default:return e}})(n.role)})]}),(0,$i.jsxs)("div",{className:"membership-item",children:[(0,$i.jsx)("span",{className:"membership-label",children:"Joined"}),(0,$i.jsx)("span",{className:"membership-value",children:x(n.joinedAt)})]}),(0,$i.jsxs)("div",{className:"membership-item",children:[(0,$i.jsx)("span",{className:"membership-label",children:"Permissions"}),(0,$i.jsx)("div",{className:"permissions-list",children:n.permissions.length>0?n.permissions.map(e=>(0,$i.jsx)("span",{className:"permission-badge",children:e.replace("_"," ")},e)):(0,$i.jsx)("span",{className:"no-permissions",children:"No special permissions"})})]})]})]}),p&&(0,$i.jsx)("div",{className:"error-message",children:p}),f&&(0,$i.jsx)("div",{className:"modal-overlay",children:(0,$i.jsxs)("div",{className:"confirmation-modal",children:[(0,$i.jsx)("h3",{children:"Leave Guild"}),(0,$i.jsxs)("p",{children:["Are you sure you want to leave ",t.name,"? This action cannot be undone."]}),(0,$i.jsxs)("div",{className:"modal-actions",children:[(0,$i.jsx)("button",{onClick:async()=>{try{h(!0),m(null);const e=await fetch(`/api/guild/${t.guildId}/leave`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}});if(!e.ok){const t=await e.json();throw new Error(t.error||"Failed to leave guild")}s()}catch(e){m(e instanceof Error?e.message:"An error occurred")}finally{h(!1),g(!1)}},disabled:d,className:"confirm-button",children:d?"Leaving...":"Yes, Leave Guild"}),(0,$i.jsx)("button",{onClick:()=>g(!1),className:"cancel-button",children:"Cancel"})]})]})})]})},_l=e=>{let{guild:t,membership:n,onMemberUpdated:a}=e;const[i,s]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),c=n.permissions.includes("kick"),u=n.permissions.includes("promote"),d=n.permissions.includes("demote"),h=e=>("string"===typeof e?new Date(e):e).toLocaleDateString(),p=e=>{switch(e){case"leader":return"Guild Master";case"officer":return"Officer";case"member":return"Member";default:return e}},m=async e=>{const n="member"===e.role?"officer":"leader";if("leader"!==n||window.confirm(`Are you sure you want to transfer leadership to ${e.characterName}? You will become an officer.`))try{s(!0),l(null);const r=await fetch(`/api/guild/${t.guildId}/members/${e.userId}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({role:n})});if(!r.ok){const e=await r.json();throw new Error(e.error||"Failed to update member role")}a()}catch(r){l(r instanceof Error?r.message:"An error occurred")}finally{s(!1)}};return(0,$i.jsxs)("div",{className:"guild-member-list",children:[(0,$i.jsxs)("div",{className:"member-list-header",children:[(0,$i.jsxs)("h2",{children:["Guild Members (",t.memberCount,"/",t.settings.maxMembers,")"]}),(0,$i.jsx)("p",{children:"Manage your guild members and their roles"})]}),o&&(0,$i.jsx)("div",{className:"error-message",children:o}),(0,$i.jsx)("div",{className:"members-container",children:t.members.map(e=>(0,$i.jsxs)("div",{className:"member-card",children:[(0,$i.jsxs)("div",{className:"member-info",children:[(0,$i.jsx)("div",{className:"member-avatar",children:e.characterName.charAt(0).toUpperCase()}),(0,$i.jsxs)("div",{className:"member-details",children:[(0,$i.jsx)("h3",{className:"member-name",children:e.characterName}),(0,$i.jsx)("div",{className:"member-role",children:(0,$i.jsx)("span",{className:`role-badge role-${e.role}`,children:p(e.role)})}),(0,$i.jsxs)("div",{className:"member-meta",children:[(0,$i.jsxs)("span",{children:["Joined: ",h(e.joinedAt)]}),(0,$i.jsxs)("span",{children:["Last Active: ",h(e.lastActiveAt)]})]})]})]}),(0,$i.jsxs)("div",{className:"member-actions",children:[e.userId!==n.userId&&(0,$i.jsxs)($i.Fragment,{children:[c&&"leader"!==e.role&&(0,$i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(`Are you sure you want to kick ${e.characterName} from the guild?`))try{s(!0),l(null);const n=await fetch(`/api/guild/${t.guildId}/members/${e.userId}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}});if(!n.ok){const e=await n.json();throw new Error(e.error||"Failed to kick member")}a()}catch(n){l(n instanceof Error?n.message:"An error occurred")}finally{s(!1)}})(e),disabled:i,className:"action-button kick-button",children:"Kick"}),u&&"member"===e.role&&(0,$i.jsx)("button",{onClick:()=>m(e),disabled:i,className:"action-button promote-button",children:"Promote"}),d&&"officer"===e.role&&"leader"===n.role&&(0,$i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(`Are you sure you want to demote ${e.characterName} to member?`))try{s(!0),l(null);const n=await fetch(`/api/guild/${t.guildId}/members/${e.userId}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({role:"member"})});if(!n.ok){const e=await n.json();throw new Error(e.error||"Failed to update member role")}a()}catch(n){l(n instanceof Error?n.message:"An error occurred")}finally{s(!1)}})(e),disabled:i,className:"action-button demote-button",children:"Demote"}),"leader"===n.role&&"officer"===e.role&&(0,$i.jsx)("button",{onClick:()=>m(e),disabled:i,className:"action-button transfer-button",children:"Transfer Leadership"})]}),e.userId===n.userId&&(0,$i.jsx)("span",{className:"you-indicator",children:"You"})]})]},e.userId))})]})},Pl=e=>{let{guild:t,membership:n,character:a}=e;const[i,s]=(0,r.useState)(""),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(null),p=n.permissions.includes("invite");return(0,$i.jsxs)("div",{className:"guild-invitations",children:[(0,$i.jsxs)("div",{className:"invitations-header",children:[(0,$i.jsx)("h2",{children:"Guild Invitations"}),(0,$i.jsx)("p",{children:"Manage guild invitations and recruit new members"})]}),p?(0,$i.jsxs)("div",{className:"invite-section",children:[(0,$i.jsx)("h3",{children:"Send Invitation"}),(0,$i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i.trim())try{l(!0),u(null),h(null);const e=await fetch(`/api/guild/${t.guildId}/invite`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({inviteeId:i.trim()})});if(!e.ok){const t=await e.json();throw new Error(t.error||"Failed to send invitation")}const n=await e.json();h(`Invitation sent to ${n.inviteeCharacterName}!`),s("")}catch(n){u(n instanceof Error?n.message:"An error occurred")}finally{l(!1)}else u("Character name is required")},className:"invite-form",children:[(0,$i.jsxs)("div",{className:"form-group",children:[(0,$i.jsx)("label",{htmlFor:"inviteeName",className:"form-label",children:"Character Name"}),(0,$i.jsx)("input",{type:"text",id:"inviteeName",value:i,onChange:e=>s(e.target.value),className:"form-input",placeholder:"Enter character name to invite",disabled:o})]}),c&&(0,$i.jsx)("div",{className:"error-message",children:c}),d&&(0,$i.jsx)("div",{className:"success-message",children:d}),(0,$i.jsx)("button",{type:"submit",disabled:o||!i.trim(),className:"invite-button",children:o?"Sending...":"Send Invitation"})]})]}):(0,$i.jsxs)("div",{className:"no-permission",children:[(0,$i.jsx)("p",{children:"You don't have permission to send guild invitations."}),(0,$i.jsx)("p",{children:"Contact a guild officer or the guild master for assistance."})]}),(0,$i.jsxs)("div",{className:"invitation-info",children:[(0,$i.jsx)("h3",{children:"Invitation Guidelines"}),(0,$i.jsxs)("ul",{children:[(0,$i.jsx)("li",{children:"Invitations expire after 7 days"}),(0,$i.jsx)("li",{children:"Players can only be in one guild at a time"}),(0,$i.jsxs)("li",{children:["Guild must have available slots (",t.memberCount,"/",t.settings.maxMembers,")"]}),(0,$i.jsx)("li",{children:"Invited players will receive a notification"}),(0,$i.jsx)("li",{children:"Players can accept or decline invitations"})]})]}),(0,$i.jsxs)("div",{className:"guild-settings-info",children:[(0,$i.jsx)("h3",{children:"Current Guild Settings"}),(0,$i.jsxs)("div",{className:"settings-summary",children:[(0,$i.jsxs)("div",{className:"setting-item",children:[(0,$i.jsx)("span",{className:"setting-label",children:"Visibility:"}),(0,$i.jsx)("span",{className:"setting-value",children:t.settings.isPublic?"Public":"Private"})]}),(0,$i.jsxs)("div",{className:"setting-item",children:[(0,$i.jsx)("span",{className:"setting-label",children:"Join Requirements:"}),(0,$i.jsx)("span",{className:"setting-value",children:t.settings.requireApproval?"Approval Required":"Open Join"})]}),(0,$i.jsxs)("div",{className:"setting-item",children:[(0,$i.jsx)("span",{className:"setting-label",children:"Available Slots:"}),(0,$i.jsxs)("span",{className:"setting-value",children:[t.settings.maxMembers-t.memberCount," remaining"]})]})]})]})]})},Ol=e=>{let{character:t,onGuildJoined:n}=e;const[a,i]=(0,r.useState)([]),[s,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)({search:"",minLevel:"",maxLevel:"",hasOpenSlots:!0});(0,r.useEffect)(()=>{h()},[]);const h=async()=>{try{o(!0),c(null);const e=new URLSearchParams;e.append("isPublic","true"),u.search.trim()&&e.append("search",u.search.trim()),u.minLevel&&e.append("minLevel",u.minLevel),u.maxLevel&&e.append("maxLevel",u.maxLevel),u.hasOpenSlots&&e.append("hasOpenSlots","true");const t=await fetch(`/api/guild/search?${e.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to search guilds");const n=await t.json();i(n.guilds||[])}catch(e){c(e instanceof Error?e.message:"An error occurred")}finally{o(!1)}},p=e=>{const{name:t,value:n,type:r,checked:a}=e.target;d(e=>({...e,[t]:"checkbox"===r?a:n}))};return(0,$i.jsxs)("div",{className:"guild-search",children:[(0,$i.jsxs)("div",{className:"search-header",children:[(0,$i.jsx)("h2",{children:"Find a Guild"}),(0,$i.jsx)("p",{children:"Discover and join guilds that match your playstyle"})]}),(0,$i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h()},className:"search-form",children:[(0,$i.jsxs)("div",{className:"search-filters",children:[(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"search",className:"filter-label",children:"Guild Name"}),(0,$i.jsx)("input",{type:"text",id:"search",name:"search",value:u.search,onChange:p,className:"filter-input",placeholder:"Search by guild name..."})]}),(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"minLevel",className:"filter-label",children:"Min Level"}),(0,$i.jsx)("input",{type:"number",id:"minLevel",name:"minLevel",value:u.minLevel,onChange:p,className:"filter-input",min:"1",max:"100"})]}),(0,$i.jsxs)("div",{className:"filter-group",children:[(0,$i.jsx)("label",{htmlFor:"maxLevel",className:"filter-label",children:"Max Level"}),(0,$i.jsx)("input",{type:"number",id:"maxLevel",name:"maxLevel",value:u.maxLevel,onChange:p,className:"filter-input",min:"1",max:"100"})]}),(0,$i.jsx)("div",{className:"filter-group checkbox-group",children:(0,$i.jsxs)("label",{className:"checkbox-label",children:[(0,$i.jsx)("input",{type:"checkbox",name:"hasOpenSlots",checked:u.hasOpenSlots,onChange:p,className:"filter-checkbox"}),(0,$i.jsx)("span",{children:"Has Open Slots"})]})})]}),(0,$i.jsx)("button",{type:"submit",disabled:s,className:"search-button",children:s?"Searching...":"Search Guilds"})]}),l&&(0,$i.jsx)("div",{className:"error-message",children:l}),(0,$i.jsxs)("div",{className:"search-results",children:[0===a.length&&!s&&(0,$i.jsxs)("div",{className:"no-results",children:[(0,$i.jsx)("p",{children:"No guilds found matching your criteria."}),(0,$i.jsx)("p",{children:"Try adjusting your search filters or create your own guild!"})]}),a.map(e=>{return(0,$i.jsxs)("div",{className:"guild-card",children:[(0,$i.jsxs)("div",{className:"guild-info",children:[(0,$i.jsxs)("div",{className:"guild-header",children:[(0,$i.jsx)("h3",{className:"guild-name",children:e.name}),(0,$i.jsxs)("div",{className:"guild-level",children:["Level ",e.level]})]}),(0,$i.jsx)("p",{className:"guild-description",children:e.description||"No description provided."}),(0,$i.jsxs)("div",{className:"guild-stats",children:[(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Members"}),(0,$i.jsxs)("span",{className:"stat-value",children:[e.memberCount,"/",e.settings.maxMembers]})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Experience"}),(0,$i.jsx)("span",{className:"stat-value",children:e.experience})]}),(0,$i.jsxs)("div",{className:"stat-item",children:[(0,$i.jsx)("span",{className:"stat-label",children:"Created"}),(0,$i.jsx)("span",{className:"stat-value",children:(r=e.createdAt,("string"===typeof r?new Date(r):r).toLocaleDateString())})]})]}),(0,$i.jsxs)("div",{className:"guild-settings",children:[(0,$i.jsx)("div",{className:"setting-badge",children:e.settings.isPublic?"Public":"Private"}),(0,$i.jsx)("div",{className:"setting-badge",children:e.settings.requireApproval?"Approval Required":"Open Join"}),e.memberCount<e.settings.maxMembers&&(0,$i.jsx)("div",{className:"setting-badge available",children:"Slots Available"})]})]}),(0,$i.jsx)("div",{className:"guild-actions",children:(0,$i.jsx)("button",{onClick:()=>(async e=>{if(e.settings.requireApproval)alert("This guild requires approval. Contact a guild officer to request an invitation.");else try{o(!0),c(null);const r={guildId:e.guildId,userId:t.userId,characterName:t.name,role:"member",joinedAt:new Date,permissions:[],lastActiveAt:t.lastActiveAt};n(e,r)}catch(r){c(r instanceof Error?r.message:"Failed to join guild")}finally{o(!1)}})(e),disabled:s||e.memberCount>=e.settings.maxMembers,className:"join-button",children:e.settings.requireApproval?"Request Invite":"Join Guild"})})]},e.guildId);var r})]})]})},Ml=e=>{let{character:t,onGuildUpdate:n}=e;const[a,i]=(0,r.useState)({guild:null,membership:null}),[s,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)("overview");(0,r.useEffect)(()=>{h()},[t.userId]);const h=async()=>{try{o(!0),c(null);const e=await fetch("/api/guild/my-guild",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}});if(e.ok){const t=e.headers.get("content-type");if(t&&t.includes("application/json")){const t=await e.json();i(t),null===n||void 0===n||n(t.guild)}else console.log("Guild API not available, using development mode"),i({guild:null,membership:null}),null===n||void 0===n||n(null)}else if(404===e.status)i({guild:null,membership:null}),null===n||void 0===n||n(null);else{const t=await e.text();if(!t.includes("<!DOCTYPE")&&!t.includes("<html"))throw new Error("Failed to fetch guild information");console.log("Guild API not available, using development mode"),i({guild:null,membership:null}),null===n||void 0===n||n(null)}}catch(e){e instanceof Error&&e.message.includes("Unexpected token")?(console.log("Guild API not available, using development mode"),i({guild:null,membership:null}),null===n||void 0===n||n(null)):c(e instanceof Error?e.message:"An error occurred")}finally{o(!1)}},p=(e,t)=>{i({guild:e,membership:t}),null===n||void 0===n||n(e),d("overview")},m=(e,t)=>{i({guild:e,membership:t}),null===n||void 0===n||n(e),d("overview")};return s?(0,$i.jsx)("div",{className:"guild-manager loading",children:(0,$i.jsx)("div",{className:"loading-spinner",children:"Loading guild information..."})}):l?(0,$i.jsx)("div",{className:"guild-manager error",children:(0,$i.jsxs)("div",{className:"error-message",children:[(0,$i.jsx)("h3",{children:"Error Loading Guild"}),(0,$i.jsx)("p",{children:l}),(0,$i.jsx)("button",{onClick:h,className:"retry-button",children:"Retry"})]})}):a.guild?(0,$i.jsxs)("div",{className:"guild-manager has-guild",children:[(0,$i.jsxs)("div",{className:"guild-tabs",children:[(0,$i.jsx)("button",{className:"tab-button "+("overview"===u?"active":""),onClick:()=>d("overview"),children:"Overview"}),(0,$i.jsxs)("button",{className:"tab-button "+("members"===u?"active":""),onClick:()=>d("members"),children:["Members (",a.guild.memberCount,")"]}),(0,$i.jsx)("button",{className:"tab-button "+("invitations"===u?"active":""),onClick:()=>d("invitations"),children:"Invitations"})]}),(0,$i.jsxs)("div",{className:"guild-content",children:["overview"===u&&(0,$i.jsx)(jl,{guild:a.guild,membership:a.membership,character:t,onGuildUpdated:e=>{i(t=>({...t,guild:e})),null===n||void 0===n||n(e)},onGuildLeft:()=>{i({guild:null,membership:null}),null===n||void 0===n||n(null)}}),"members"===u&&(0,$i.jsx)(_l,{guild:a.guild,membership:a.membership,onMemberUpdated:h}),"invitations"===u&&(0,$i.jsx)(Pl,{guild:a.guild,membership:a.membership,character:t})]})]}):(0,$i.jsxs)("div",{className:"guild-manager no-guild",children:[(0,$i.jsxs)("div",{className:"guild-tabs",children:[(0,$i.jsx)("button",{className:"tab-button "+("search"===u?"active":""),onClick:()=>d("search"),children:"Find Guild"}),(0,$i.jsx)("button",{className:"tab-button "+("overview"===u?"active":""),onClick:()=>d("overview"),children:"Create Guild"})]}),(0,$i.jsxs)("div",{className:"guild-content",children:["search"===u&&(0,$i.jsx)(Ol,{character:t,onGuildJoined:m}),"overview"===u&&(0,$i.jsx)(Rl,{character:t,onGuildCreated:p})]})]})},Ll=()=>{const e=ms(),[t,n]=(0,r.useState)("dashboard"),[a,i]=(0,r.useState)(null),[s,o]=(0,r.useState)([]),[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(0),{isAuthenticated:f}=is(e=>e.auth),{character:g,hasCharacter:y,characterLoading:v,isOnline:x}=is(e=>e.game),b=e=>{"Auction Marketplace"===e?n("marketplace"):i(e)},E=()=>{i(null)},S=async()=>{try{const e=await fetch("/api/players/online");if(e.ok){const t=await e.json();console.log("Online players response:",t);const n=Math.max(t.length,f&&g?1:0);m(n)}else console.warn("Failed to fetch online players, status:",e.status),m(f&&g?1:0)}catch(e){console.error("Failed to fetch online player count:",e),m(f&&g?1:0)}};if((0,r.useEffect)(()=>{e((0,l.q3)(!0)),g&&console.log("GameDashboard: Character loaded, using simple activity system"),S();const t=setInterval(S,3e4);return()=>{e((0,l.q3)(!1)),clearInterval(t)}},[e,g]),(0,r.useEffect)(()=>{S()},[f,g]),(0,r.useEffect)(()=>{},[g]),!f)return(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Login component failed to load"}),children:(0,$i.jsx)(Vo,{})});if(v)return(0,$i.jsx)("div",{className:"game-dashboard",children:(0,$i.jsxs)("div",{className:"loading-screen",children:[(0,$i.jsx)("h2",{children:"Loading your character..."}),(0,$i.jsx)("div",{className:"loading-spinner",children:"\u2699\ufe0f"})]})});if(!1===y)return(0,$i.jsx)("div",{className:"game-dashboard",children:(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Character creation failed to load"}),children:(0,$i.jsx)(Ko,{onCharacterCreated:()=>{}})})});const w=[{id:"character",label:"Character",icon:"\ud83d\udc64",onClick:()=>b("Character Panel")},{id:"resources",label:"Resources",icon:"\u26cf\ufe0f",onClick:()=>b("Resource Harvesting")},{id:"crafting",label:"Crafting",icon:"\ud83d\udd27",onClick:()=>b("Crafting System")},{id:"combat",label:"Combat",icon:"\u2694\ufe0f",onClick:()=>b("Combat System")},{id:"guild",label:"Guild",icon:"\ud83c\udff0",onClick:()=>b("Guild Management")},{id:"auction",label:"Auction",icon:"\ud83d\udcb0",onClick:()=>b("Auction Marketplace")},{id:"leaderboard",label:"Leaderboard",icon:"\ud83c\udfc6",onClick:()=>b("Leaderboards")},{id:"fargate",label:"Game Engine",icon:"\ud83c\udfae",onClick:()=>b("Fargate Game Engine")},{id:"profile",label:"Profile",icon:"\u2699\ufe0f",onClick:()=>b("User Profile")}];return(0,$i.jsx)($i.Fragment,{children:(0,$i.jsxs)(Bo,{sidebar:(0,$i.jsxs)("div",{className:"game-features-sidebar-content",children:[g&&(0,$i.jsxs)("div",{className:"player-info-section",children:[(0,$i.jsxs)("div",{className:"player-name-display",children:[(0,$i.jsx)("span",{className:"player-icon",children:"\ud83d\udc64"}),(0,$i.jsx)("span",{className:"player-name",children:g.name})]}),(0,$i.jsxs)("div",{className:"player-level-display",children:[(0,$i.jsx)("span",{className:"level-icon",children:"\u2b50"}),(0,$i.jsxs)("span",{className:"level-text",children:["Level ",g.level]})]}),(0,$i.jsxs)("div",{className:"online-players-display",children:[(0,$i.jsx)("span",{className:"online-icon",children:"\ud83c\udf0d"}),(0,$i.jsxs)("span",{className:"online-text",children:[p," Players Online"]})]})]}),(0,$i.jsx)("div",{className:"sidebar-navigation",children:w.slice(0,8).map(e=>(0,$i.jsxs)("button",{className:"sidebar-nav-button",onClick:e.onClick,title:e.label,children:[(0,$i.jsx)("span",{className:"nav-icon",children:e.icon}),(0,$i.jsx)("span",{className:"nav-label",children:e.label})]},e.id))})]}),className:"game-dashboard",children:["dashboard"===t&&g&&(0,$i.jsx)("div",{className:"main-content-area",children:(0,$i.jsx)(Cl,{playerId:g.characterId,className:"main-task-queue",defaultMode:"management"})}),"marketplace"===t&&(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Marketplace failed to load"}),children:(0,$i.jsx)(al,{})}),(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Chat failed to load"}),children:(0,$i.jsx)(zo,{})}),(0,$i.jsx)(Fo,{isOpen:null!==a,onClose:E,title:a||"",size:"large",children:(()=>{switch(a){case"Character Panel":return(0,$i.jsx)(sl,{});case"Crafting System":return(0,$i.jsxs)("div",{className:"feature-content",children:[(0,$i.jsxs)("p",{children:["\ud83d\udd27 ",(0,$i.jsx)("strong",{children:"Clockwork Crafting Workshop"})]}),(0,$i.jsx)("p",{children:"Create intricate mechanical devices and steam-powered contraptions!"}),(0,$i.jsxs)("div",{className:"feature-placeholder",children:[(0,$i.jsx)("h4",{children:"Available Recipes:"}),(0,$i.jsxs)("ul",{children:[(0,$i.jsxs)("li",{children:["\u2699\ufe0f Basic Clockwork Gear - ",(0,$i.jsx)("em",{children:"Materials: 2 Copper, 1 Steam Crystal"})]}),(0,$i.jsxs)("li",{children:["\ud83d\udd29 Steam Valve - ",(0,$i.jsx)("em",{children:"Materials: 3 Iron, 2 Rubber"})]}),(0,$i.jsxs)("li",{children:["\u23f0 Pocket Watch - ",(0,$i.jsx)("em",{children:"Materials: 5 Gears, 1 Crystal, 3 Gold"})]})]}),(0,$i.jsx)("p",{children:(0,$i.jsx)("em",{children:"Full crafting system coming soon!"})})]})]});case"Resource Harvesting":return g?(0,$i.jsx)(yl,{userId:g.userId,onClose:E}):(0,$i.jsx)("div",{children:"Loading character data..."});case"Combat System":return(0,$i.jsxs)("div",{className:"feature-content",children:[(0,$i.jsxs)("p",{children:["\u2694\ufe0f ",(0,$i.jsx)("strong",{children:"Automaton Battle Arena"})]}),(0,$i.jsx)("p",{children:"Face off against rogue mechanical creatures and steam-powered beasts!"}),(0,$i.jsxs)("div",{className:"feature-placeholder",children:[(0,$i.jsx)("h4",{children:"Enemy Types:"}),(0,$i.jsxs)("ul",{children:[(0,$i.jsxs)("li",{children:["\ud83e\udd16 Clockwork Sentinel - ",(0,$i.jsx)("em",{children:"Level 1-5 mechanical guardian"})]}),(0,$i.jsxs)("li",{children:["\ud83d\udc09 Steam Dragon - ",(0,$i.jsx)("em",{children:"Level 10+ fire-breathing automaton"})]}),(0,$i.jsxs)("li",{children:["\u26a1 Lightning Golem - ",(0,$i.jsx)("em",{children:"Level 15+ electrical construct"})]})]}),(0,$i.jsx)("p",{children:(0,$i.jsx)("em",{children:"Combat mechanics coming soon!"})})]})]});case"Guild Management":return g?(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Guild Management failed to load"}),children:(0,$i.jsx)(Ml,{character:g,onGuildUpdate:e=>{console.log("Guild updated:",e)}})}):(0,$i.jsx)("div",{children:"Loading character data..."});case"Chat System":return(0,$i.jsxs)("div",{className:"feature-content",children:[(0,$i.jsxs)("p",{children:["\ud83d\udcac ",(0,$i.jsx)("strong",{children:"Steam Telegraph Network"})]}),(0,$i.jsx)("p",{children:"Communicate with fellow inventors across the realm!"}),(0,$i.jsxs)("div",{className:"feature-placeholder",children:[(0,$i.jsx)("h4",{children:"Chat Channels:"}),(0,$i.jsxs)("ul",{children:[(0,$i.jsxs)("li",{children:["\ud83c\udf0d Global - ",(0,$i.jsx)("em",{children:"Talk with all players"})]}),(0,$i.jsxs)("li",{children:["\ud83c\udff0 Guild - ",(0,$i.jsx)("em",{children:"Private guild communications"})]}),(0,$i.jsxs)("li",{children:["\ud83d\udcbc Trade - ",(0,$i.jsx)("em",{children:"Buy and sell items"})]}),(0,$i.jsxs)("li",{children:["\u2753 Help - ",(0,$i.jsx)("em",{children:"Get assistance from other players"})]})]}),(0,$i.jsx)("p",{children:(0,$i.jsx)("em",{children:"Real-time chat coming soon!"})})]})]});case"Leaderboards":return(0,$i.jsx)(il,{});case"User Profile":return(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"User profile failed to load"}),children:(0,$i.jsx)(Ho,{})});case"Fargate Game Engine":return g?(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Fargate Game Engine failed to load"}),children:(0,$i.jsx)(Tl,{playerId:g.characterId,onTaskComplete:e=>{console.log("Fargate task completed:",e)},onStatusChange:e=>{console.log("Fargate queue status changed:",e)}})}):(0,$i.jsx)("div",{children:"Loading character data..."});default:return(0,$i.jsx)("div",{children:"Feature not found"})}})()}),(0,$i.jsx)(ml,{rewards:s,visible:c,onClose:()=>{u(!1),o([])}})]})})},Ul=()=>{const e=ms(),t=ho();return(0,r.useEffect)(()=>{(async()=>{try{const n=await qi.handleOAuthCallback();e((0,o.loginSuccess)(n)),t("/")}catch(n){const r=n instanceof Error?n.message:"Authentication failed";e((0,o.ie)(r)),t("/")}})()},[e,t]),(0,$i.jsx)("div",{className:"auth-callback",children:(0,$i.jsxs)("div",{className:"callback-container",children:[(0,$i.jsx)("div",{className:"loading-spinner",children:(0,$i.jsx)("div",{className:"gear-spinner"})}),(0,$i.jsx)("h2",{children:"Authenticating..."}),(0,$i.jsx)("p",{children:"Please wait while we complete your login"})]})})},Dl=e=>{let{children:t}=e;const n=(0,$i.jsxs)("div",{style:{padding:"40px",margin:"20px",border:"2px solid #dc2626",borderRadius:"12px",backgroundColor:"#fef2f2",fontFamily:"system-ui, -apple-system, sans-serif",maxWidth:"800px",marginLeft:"auto",marginRight:"auto",marginTop:"10vh"},children:[(0,$i.jsxs)("div",{style:{textAlign:"center",marginBottom:"30px"},children:[(0,$i.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\ud83d\udea8"}),(0,$i.jsx)("h1",{style:{color:"#dc2626",marginTop:0,fontSize:"24px",fontWeight:"600"},children:"Application Error"}),(0,$i.jsx)("p",{style:{color:"#6b7280",fontSize:"16px",lineHeight:"1.5",margin:"0 0 20px 0"},children:"The application encountered an unexpected error and cannot continue."})]}),(0,$i.jsxs)("div",{style:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"20px",marginBottom:"24px"},children:[(0,$i.jsx)("h3",{style:{color:"#374151",marginTop:0,marginBottom:"12px",fontSize:"16px",fontWeight:"600"},children:"What happened?"}),(0,$i.jsx)("p",{style:{color:"#6b7280",fontSize:"14px",lineHeight:"1.5",margin:0},children:"A critical error occurred that prevented the application from functioning properly. This error has been logged and will be investigated."})]}),(0,$i.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap",marginBottom:"24px"},children:[(0,$i.jsx)("button",{onClick:()=>window.location.reload(),style:{backgroundColor:"#dc2626",color:"white",border:"none",padding:"12px 24px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#b91c1c",onMouseOut:e=>e.currentTarget.style.backgroundColor="#dc2626",children:"\ud83d\udd04 Reload Application"}),(0,$i.jsx)("button",{onClick:()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},style:{backgroundColor:"#6b7280",color:"white",border:"none",padding:"12px 24px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#4b5563",onMouseOut:e=>e.currentTarget.style.backgroundColor="#6b7280",children:"\ud83d\uddd1\ufe0f Clear Data & Reload"}),(0,$i.jsx)("button",{onClick:()=>window.location.href="/",style:{backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",padding:"12px 24px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#e5e7eb",onMouseOut:e=>e.currentTarget.style.backgroundColor="#f3f4f6",children:"\ud83c\udfe0 Go Home"})]}),(0,$i.jsx)("div",{style:{backgroundColor:"#fffbeb",border:"1px solid #fbbf24",borderRadius:"8px",padding:"16px"},children:(0,$i.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[(0,$i.jsx)("div",{style:{fontSize:"20px",flexShrink:0},children:"\ud83d\udca1"}),(0,$i.jsxs)("div",{children:[(0,$i.jsx)("h4",{style:{color:"#92400e",margin:"0 0 8px 0",fontSize:"14px",fontWeight:"600"},children:"Troubleshooting Tips:"}),(0,$i.jsxs)("ul",{style:{margin:0,paddingLeft:"16px",color:"#92400e",fontSize:"13px",lineHeight:"1.5"},children:[(0,$i.jsx)("li",{children:"Try refreshing the page first"}),(0,$i.jsx)("li",{children:"Clear browser data if the problem persists"}),(0,$i.jsx)("li",{children:"Check your internet connection"}),(0,$i.jsx)("li",{children:"Ensure all required services are running"}),(0,$i.jsx)("li",{children:"Contact support if the issue continues"})]})]})]})})]});return(0,$i.jsx)(Do,{fallback:n,onError:(e,t)=>{console.error("Global Error Boundary caught an error:",e),console.error("Error Info:",t),Uo.addBreadcrumb("error","global-error","Global error boundary activated",{errorMessage:e.message,errorName:e.name}),console.group("\ud83d\udea8 Global Runtime Error Details"),console.error("Error:",e.message),console.error("Stack:",e.stack),console.error("Component Stack:",t.componentStack),console.groupEnd()},enableRecovery:!1,enableReporting:!0,componentName:"GlobalErrorBoundary",level:"page",showErrorDetails:!0,children:t})},ql=e=>{const t=e.reduce((e,t)=>{const n=`${t.type}-${t.itemId||"generic"}`;var r,a;return e[n]||(e[n]={key:n,type:t.type,itemId:t.itemId,totalQuantity:0,isRare:t.isRare,name:t.itemId?(a=t.itemId,a.replace(/_/g," ").replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()).replace(/\s+/g," ").trim()):(r=t.type,"experience"===r?"XP":"currency"===r?"Gold":r.charAt(0).toUpperCase()+r.slice(1)),icon:zl(t)}),e[n].totalQuantity+=t.quantity,e},{});return Object.values(t)},Fl=e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60),a=Math.floor(r/24);return a>0?`${a}d ${r%24}h`:r>0?`${r}h ${n%60}m`:n>0?`${n}m ${t%60}s`:`${t}s`},$l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.forEach(e=>{t+=e.duration}),t},Bl=e=>{switch(e.type){case"harvesting":return"\u26cf\ufe0f";case"crafting":return"\ud83d\udd27";case"combat":return"\u2694\ufe0f";default:return"\ud83d\udccb"}},zl=e=>{if("experience"===e.type)return"\ud83d\udcda";if("currency"===e.type)return"\ud83d\udcb0";if(e.itemId){const t=e.itemId.toLowerCase();if(t.includes("copper"))return"\ud83d\udfe4";if(t.includes("iron"))return"\u26ab";if(t.includes("gold"))return"\ud83d\udfe1";if(t.includes("silver"))return"\u26aa";if(t.includes("crystal"))return"\ud83d\udc8e";if(t.includes("gem"))return"\ud83d\udc8d";if(t.includes("manuscript"))return"\ud83d\udcdc";if(t.includes("book"))return"\ud83d\udcd6";if(t.includes("scroll"))return"\ud83d\udcc3";if(t.includes("gear"))return"\u2699\ufe0f";if(t.includes("spring"))return"\ud83c\udf00";if(t.includes("valve"))return"\ud83d\udd27";if(t.includes("herb"))return"\ud83c\udf3f";if(t.includes("flower"))return"\ud83c\udf38";if(t.includes("seed"))return"\ud83c\udf31";if(t.includes("fossil"))return"\ud83e\uddb4";if(t.includes("artifact"))return"\ud83c\udffa";if(t.includes("relic"))return"\u26b1\ufe0f"}return e.isRare?"\u2728":"\ud83d\udce6"},Vl=e=>{let{playerId:t,showQueuePreview:n=!0,maxPreviewTasks:a=3,showEstimatedTimes:i=!0,enableCelebrations:s=!0}=e;const[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(0),[d,h]=(0,r.useState)(0),[p,m]=(0,r.useState)(null),[f,g]=(0,r.useState)([]),[y,v]=(0,r.useState)(!1),[x,b]=(0,r.useState)(!1),[E,S]=(0,r.useState)(!1),[w,N]=(0,r.useState)(!1),[k,C]=(0,r.useState)([]),[I,A]=(0,r.useState)(0),[T,R]=(0,r.useState)(!1),[j,_]=(0,r.useState)("");return(0,r.useEffect)(()=>{El.onProgress(t,e=>{w||x||E||(u(e.progress),h(e.timeRemaining))}),El.onTaskComplete(t,e=>{if(N(!0),b(!0),u(1),h(0),s){const t=e.task.name||"Task";_(`${t} completed!`),R(!0),setTimeout(()=>{R(!1),_("")},2e3)}if(e.rewards&&e.rewards.length>0){const t=e.rewards.map(e=>({id:`${e.type}-${e.itemId||"generic"}-${Date.now()}`,type:e.type,itemId:e.itemId,quantity:e.quantity,rarity:e.rarity,isRare:e.isRare,timestamp:Date.now()}));g(e=>[...e,...t].slice(-10)),t.forEach(e=>{setTimeout(()=>{g(t=>t.filter(t=>t.id!==e.id))},8e3)})}setTimeout(()=>{S(!0),l(null),u(0),h(0),setTimeout(()=>{const e=El.getQueueStatus(t);m(e),l(e.currentTask),u(0),h(0),S(!1),b(!1),N(!1)},1e3)},800)});const e=setInterval(()=>{if(!w&&!x&&!E){const e=El.getQueueStatus(t);if(m(e),l(e.currentTask),n&&e.queuedTasks){const t=e.queuedTasks.slice(0,a);if(C(t),i){const e=$l(t,d);A(e)}}}},1e3),r=El.getQueueStatus(t);if(m(r),l(r.currentTask),n&&r.queuedTasks){const e=r.queuedTasks.slice(0,a);if(C(e),i){const t=$l(e,0);A(t)}}return()=>{El.removeCallbacks(t),clearInterval(e)}},[t]),E?(0,$i.jsxs)("div",{className:"unified-progress-bar active",children:[(0,$i.jsxs)("div",{className:"progress-main",children:[(0,$i.jsxs)("div",{className:"task-info",children:[(0,$i.jsx)("span",{className:"task-icon",children:"\u23f3"}),(0,$i.jsx)("span",{className:"task-name",children:"Loading next task..."}),(0,$i.jsx)("span",{className:"task-time",children:"-"})]}),(0,$i.jsxs)("div",{className:"progress-container",children:[(0,$i.jsx)("div",{className:"progress-bar",children:(0,$i.jsx)("div",{className:"progress-fill",style:{width:"0%"}})}),(0,$i.jsx)("span",{className:"progress-text",children:"0%"})]}),(0,$i.jsx)("div",{className:"progress-controls",children:(0,$i.jsx)("button",{className:"stop-button",onClick:()=>El.stopAllTasks(t),title:"Stop all tasks",children:"\u23f9\ufe0f"})})]}),(0,$i.jsx)("div",{className:"recent-items",children:(0,$i.jsx)("div",{className:"items-list",children:ql(f).map(e=>(0,$i.jsxs)("div",{className:"item-display "+(e.isRare?"rare-item":"common-item"),title:e.name,children:[(0,$i.jsx)("span",{className:"item-quantity",children:e.totalQuantity}),(0,$i.jsx)("span",{className:"item-icon",children:e.icon}),e.isRare&&(0,$i.jsx)("span",{className:"rare-indicator",children:"\u2728"})]},e.key))})})]}):o||x?(0,$i.jsxs)("div",{className:"unified-progress-bar active",children:[T&&(0,$i.jsx)("div",{className:"celebration-overlay",children:(0,$i.jsxs)("div",{className:"celebration-content",children:[(0,$i.jsx)("div",{className:"celebration-icon",children:"\ud83c\udf89"}),(0,$i.jsx)("div",{className:"celebration-message",children:j}),(0,$i.jsx)("div",{className:"celebration-sparkles",children:"\u2728 \u2b50 \u2728"})]})}),(0,$i.jsxs)("div",{className:"progress-main",children:[(0,$i.jsxs)("div",{className:"task-info",children:[(0,$i.jsx)("span",{className:"task-icon",children:o.icon}),(0,$i.jsxs)("span",{className:"task-name",children:[o.name,y&&(0,$i.jsx)("span",{className:"mock-indicator",children:" (Demo)"})]}),(0,$i.jsxs)("span",{className:"task-time",children:[Math.ceil(d/1e3),"s"]})]}),(0,$i.jsxs)("div",{className:"progress-container",children:[(0,$i.jsx)("div",{className:"progress-bar",children:(0,$i.jsx)("div",{className:"progress-fill "+(T?"celebrating":""),style:{width:100*c+"%"}})}),(0,$i.jsxs)("span",{className:"progress-text",children:[Math.round(100*c),"%"]})]}),(0,$i.jsxs)("div",{className:"progress-controls",children:[p&&p.queueLength>0&&(0,$i.jsxs)("div",{className:"queue-info",children:[(0,$i.jsxs)("span",{children:["+",p.queueLength," queued"]}),i&&I>0&&(0,$i.jsxs)("span",{className:"estimated-time",children:["(~",Fl(I),")"]})]}),(0,$i.jsx)("button",{className:"stop-button",onClick:()=>El.stopAllTasks(t),title:"Stop all tasks",children:"\u23f9\ufe0f"})]})]}),n&&k.length>0&&(0,$i.jsxs)("div",{className:"queue-preview",children:[(0,$i.jsxs)("div",{className:"queue-preview-header",children:[(0,$i.jsx)("span",{className:"preview-icon",children:"\ud83d\udccb"}),(0,$i.jsx)("span",{className:"preview-title",children:"Next Tasks"}),i&&I>0&&(0,$i.jsxs)("span",{className:"preview-total-time",children:["Total: ",Fl(I)]})]}),(0,$i.jsx)("div",{className:"queue-preview-list",children:k.map((e,t)=>(0,$i.jsxs)("div",{className:"preview-task",children:[(0,$i.jsxs)("div",{className:"preview-task-info",children:[(0,$i.jsx)("span",{className:"preview-task-icon",children:Bl(e)}),(0,$i.jsx)("span",{className:"preview-task-emoji",children:e.icon}),(0,$i.jsx)("span",{className:"preview-task-name",children:e.name})]}),(0,$i.jsxs)("div",{className:"preview-task-meta",children:[(0,$i.jsxs)("span",{className:"preview-task-position",children:["#",t+1]}),i&&(0,$i.jsx)("span",{className:"preview-task-duration",children:Fl(e.duration)})]})]},e.id))})]}),(0,$i.jsx)("div",{className:"recent-items",children:(0,$i.jsx)("div",{className:"items-list",children:ql(f).map(e=>(0,$i.jsxs)("div",{className:"item-display "+(e.isRare?"rare-item":"common-item"),title:e.name,children:[(0,$i.jsx)("span",{className:"item-quantity",children:e.totalQuantity}),(0,$i.jsx)("span",{className:"item-icon",children:e.icon}),e.isRare&&(0,$i.jsx)("span",{className:"rare-indicator",children:"\u2728"})]},e.key))})})]}):(0,$i.jsx)("div",{className:"unified-progress-bar idle",children:(0,$i.jsx)("div",{className:"no-activity",children:(0,$i.jsx)("span",{children:"No active tasks"})})})},Hl=()=>{const{isAuthenticated:e}=is(e=>e.auth),{character:t,hasCharacter:n}=is(e=>e.game),r=e&&n&&t;return(0,$i.jsxs)("header",{className:"app-header",children:[(0,$i.jsx)("div",{className:"header-title",children:(0,$i.jsx)("h1",{children:"Steampunk Idle Game"})}),r&&(0,$i.jsx)("div",{className:"header-progress",children:(0,$i.jsx)(Vl,{playerId:(null===t||void 0===t?void 0:t.characterId)||"mock-player"})})]})};const Gl=function(){return console.log("App component rendering..."),(0,r.useEffect)(()=>{console.log("[App] Initializing ErrorLoggingService..."),Uo.initialize({enabled:!0,logToConsole:!0,logToLocalStorage:!0,logToRemote:!1,maxLocalStorageEntries:100,maxBreadcrumbs:50})},[]),(0,$i.jsx)(Dl,{children:(0,$i.jsx)(us,{store:j,children:(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Authentication system failed to load"}),children:(0,$i.jsx)(Mo,{children:(0,$i.jsx)(jo,{children:(0,$i.jsxs)("div",{className:"App",children:[(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Header failed to load"}),children:(0,$i.jsx)(Hl,{})}),(0,$i.jsx)("main",{children:(0,$i.jsxs)(Ao,{children:[(0,$i.jsx)(Co,{path:"/",element:(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Game dashboard failed to load"}),children:(0,$i.jsx)(Ll,{})})}),(0,$i.jsx)(Co,{path:"/auth/callback",element:(0,$i.jsx)(qo,{fallback:(0,$i.jsx)("div",{children:"Authentication callback failed"}),children:(0,$i.jsx)(Ul,{})})})]})})]})})})})})})},Wl=()=>{const[,e]=(0,r.useState)(!1),[t,n]=(0,r.useState)(!0);(0,r.useEffect)(()=>{Fi.isInitialized()&&(e(!0),n(!1))},[]);const a=t=>{e(t),setTimeout(()=>{n(!1)},500)};return t?(0,$i.jsx)(zi,{onInitializationComplete:a}):(0,$i.jsx)(Gl,{})};i.createRoot(document.getElementById("root")).render((0,$i.jsx)(r.StrictMode,{children:(0,$i.jsx)(Wl,{})}))})();